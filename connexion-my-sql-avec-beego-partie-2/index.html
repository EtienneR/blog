<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="lang">
  <head>
    <title>Connexion MySQL avec Beego (Partie 2) - https://etienner.github.io</title><meta name="gridsome:hash" content="a6a83eeab333c7bbcf47fff9751f8c5dda4260fc"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.2"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="description" content="Nous allons dans cet article, connecter le framework à une BDD (Base De Données) de type MySQL via l&#x27;ORM (Object-Relational Mapping) fournis par Beego. Il est tout à fait possible de se servir d&#x27;un autre"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffa.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffa.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffa.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffa.png"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript><link rel="preload" href="/assets/css/0.styles.2ee79837.css" as="style"><link rel="preload" href="/assets/js/app.b659722c.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--post-vue.6a9fe53b.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules--gridsome--app--pages--404-vue.14b4f713.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.2907f5d3.js"><link rel="stylesheet" href="/assets/css/0.styles.2ee79837.css">
  </head>
  <body >
    <div data-server-rendered="true" id="app"><header><div class="container text-center"><strong><a href="/" title="Accueil" class="active">Etienne ROUZEAUD - Développeur Web</a></strong></div></header><div class="text-center title"><h1 class="display-5">Connexion MySQL avec Beego (Partie 2)</h1><p><em>Posté le <span>17 janvier 2015</span></em></p></div><div class="container"><article class="mt-4"><p>Nous allons dans cet article, connecter le framework à une BDD (Base De Données) de type MySQL via l'ORM (Object-Relational Mapping) fournis par Beego. Il est tout à fait possible de se servir d'un autre type de BDD comme PostgreSQL et SQlite3 (officiellement supportées, mais vous pouvez tester avec d'autres drivers de BDD).</p>
<h2 id="création-du-premier-modèle"><a href="#cr%C3%A9ation-du-premier-mod%C3%A8le" aria-hidden="true"><span class="icon icon-link"></span></a>Création du premier modèle</h2>
<p>Dans le répertoire "models", on crée un fichier que l'on nomme "models.go" :</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">package</span> models</code></pre>
<p>Puis, on importe la bibliothèque "Time" :</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">import</span><span class="token punctuation">(</span>
	<span class="token string">"time"</span>
<span class="token punctuation">)</span></code></pre>
<p>Ensuite, on déclare la structure basique de notre future table "articles" :</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">type</span> Articles <span class="token keyword">struct</span> <span class="token punctuation">{</span>
	Id      <span class="token builtin">int</span>       <span class="token string">`form:"-"`</span>
	Title   <span class="token builtin">string</span>    <span class="token string">`form:"title" required`</span>
	Content <span class="token builtin">string</span>    <span class="token string">`orm:";type(text)" form:"content,textarea"`</span>
	Created time<span class="token punctuation">.</span>Time <span class="token string">`orm:"auto_now_add;type(datetime)"`</span>
	Updated time<span class="token punctuation">.</span>Time <span class="token string">`orm:"auto_now;type(datetime)"`</span>
<span class="token punctuation">}</span></code></pre>
<p>On précise à l'ORM que l'on veut un champ de type texte et non un champ de type "varchar" pour le champ "content".<br>
Avec l'aide de la librairie "Time" native de Go, on implémente 2 champs de type "datetime". </p>
<p>Puis on renvoie notre structure à travers une fonction :</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token punctuation">(</span>a <span class="token operator">*</span>Articles<span class="token punctuation">)</span> <span class="token function">TableName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">string</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token string">"articles"</span>
<span class="token punctuation">}</span></code></pre>
<p>Et c'est tout pour notre unique modèle !</p>
<h2 id="connexion-à-la-base-de-données"><a href="#connexion-%C3%A0-la-base-de-donn%C3%A9es" aria-hidden="true"><span class="icon icon-link"></span></a>Connexion à la base de données</h2>
<p>Dans cette partie, on va utiliser le fichier de configuration de Beego. Pour cela, ouvrez le fichier "app.conf" présent dans le dossier "conf".<br>
On va ajouter 5 variables dont les valeurs seront :</p>
<ul>
<li>Le type de base de données ("mysql", "sqlite3", etc…).</li>
<li>Le nom d'utilisateur de la BDD</li>
<li>Le mot de passe de l'utilisateur</li>
<li>L'URL du serveur de la BDD</li>
<li>Le nom de la base utilisée pour ce projet</li>
</ul>
<pre class="language-text"><code class="language-text">data_type = &quot;mysql&quot;
data_user = &quot;root&quot;
data_pass = &quot;&quot;
data_urls = &quot;127.0.0.1&quot;
data_db   = &quot;beego_test&quot;</code></pre>
<p>Sur votre BDD MySQL, créez une nouvelle base que vous nommez "beego_test".</p>
<p>Les cinq variables ci-dessus vont être utilisées dans le fichier "main.go" (présent à la racine de votre projet). Ouvrez ce fichier.</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">import</span> <span class="token punctuation">(</span>
	<span class="token string">"github.com/astaxie/beego"</span>
	<span class="token boolean">_</span> <span class="token string">"myapp/routers"</span>
	models <span class="token string">"myapp/models"</span>
	<span class="token string">"github.com/astaxie/beego/orm"</span>
	<span class="token boolean">_</span> <span class="token string">"github.com/go-sql-driver/mysql"</span>
<span class="token punctuation">)</span></code></pre>
<p>Comme vous pouvez le constater, on importe le modèle, les bibliothèques pour l'ORM de Beego et le driver de MySQL.</p>
<p>Attention : le driver de MySQL en Go doit être présent dans le dossier "%gopath%/src/github.com/go-sql-driver/mysql".<br>
Si ce n'est pas le cas (par défaut), lancez la commande pour l'installer :<br>
<code class="language-text">go get github.com/go-sql-driver/mysql</code></p>
<p>Puis, on passe à la fonction "init" :</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	orm<span class="token punctuation">.</span><span class="token function">RegisterDriver</span><span class="token punctuation">(</span>beego<span class="token punctuation">.</span>AppConfig<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"data_type"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> orm<span class="token punctuation">.</span>DR_MySQL<span class="token punctuation">)</span>
	orm<span class="token punctuation">.</span><span class="token function">RegisterDataBase</span><span class="token punctuation">(</span><span class="token string">"default"</span><span class="token punctuation">,</span> beego<span class="token punctuation">.</span>AppConfig<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"data_type"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> beego<span class="token punctuation">.</span>AppConfig<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"mysqluser"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">":"</span><span class="token operator">+</span>beego<span class="token punctuation">.</span>AppConfig<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"@/"</span><span class="token operator">+</span>beego<span class="token punctuation">.</span>AppConfig<span class="token punctuation">.</span><span class="token function">String</span><span class="token punctuation">(</span><span class="token string">"mysqldb"</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"?charset=utf8&amp;loc=Europe%2FParis"</span><span class="token punctuation">)</span>
	orm<span class="token punctuation">.</span><span class="token function">RegisterModel</span><span class="token punctuation">(</span><span class="token function">new</span><span class="token punctuation">(</span>models<span class="token punctuation">.</span>Articles<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p>Sur la première ligne, on précise l'utilisation du driver de MySQL à l'ORM puis sur la seconde, on lui indique le DSN (Data Source Name) pour pouvoir se connecter sur notre serveur de BDD et sur la troisième et dernière ligne, on charge notre modèle.</p>
<p>A noter : il est notamment possible de créer plusieurs connexions sur différentes BDD avec Beego.</p>
<h2 id="gestion-des-erreurs-de-connexion"><a href="#gestion-des-erreurs-de-connexion" aria-hidden="true"><span class="icon icon-link"></span></a>Gestion des erreurs de connexion</h2>
<p>Lors du démarrage de votre serveur, on exécute une fonction qui permet d'afficher une erreur, si le serveur de BDD n'est pas lancé mais aussi de générer la table présente dans le modèle si cette dernière n'existe pas. Dans notre cas, la table "articles".
Pour ce faire, dans la fonction suivante ("main"), du fichier "main.go" ajoutez avant "beego.Run()" :</p>
<pre class="language-go"><code class="language-go"><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	name    <span class="token operator">:=</span> <span class="token string">"default"</span>
	force   <span class="token operator">:=</span> <span class="token boolean">false</span>
	verbose <span class="token operator">:=</span> <span class="token boolean">true</span>

	err <span class="token operator">:=</span> orm<span class="token punctuation">.</span><span class="token function">RunSyncdb</span><span class="token punctuation">(</span>name<span class="token punctuation">,</span> force<span class="token punctuation">,</span> verbose<span class="token punctuation">)</span>

	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
	    beego<span class="token punctuation">.</span><span class="token function">Debug</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	beego<span class="token punctuation">.</span><span class="token function">Run</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<ul>
<li>"name" : on utilise la connexion "default" définit dans la fonction "init"</li>
<li>"force" : si vaut "true", alors l'ORM écrase (sans sommation) la table.</li>
<li>"verbose" : affiche la connexion dans la console du serveur.</li>
</ul>
<p>Ci-dessous, les 3 types de messages possibles renvoyés dans la console du serveur (si "verbose" vaut "true").<br>
Le serveur de BDD n'est pas démarré / non accessible : </p>
<pre class="language-text"><code class="language-text">[ORM]register db Ping `default`, dial tcp 127.0.0.1:3306: ConnectEx tcp: Aucune connexion n&#39;a pu être établie car l&#39;ordinateur cible l&#39;a expressément refusée.
must have one register DataBase alias named `default`</code></pre>
<p>La table "articles" n'existe pas :</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">create</span> <span class="token keyword">table</span> <span class="token punctuation">`</span>articles<span class="token punctuation">`</span>
	<span class="token comment">-- --------------------------------------------------</span>
    <span class="token comment">--  Table Structure for `myapp/models.Articles`</span>
    <span class="token comment">-- --------------------------------------------------</span>
    <span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token operator">NOT</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>articles<span class="token punctuation">`</span> <span class="token punctuation">(</span>
        <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">integer</span> <span class="token keyword">AUTO_INCREMENT</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span><span class="token punctuation">,</span>
        <span class="token punctuation">`</span>title<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
        <span class="token punctuation">`</span>content<span class="token punctuation">`</span> <span class="token keyword">longtext</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
        <span class="token punctuation">`</span>created<span class="token punctuation">`</span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
        <span class="token punctuation">`</span>updated<span class="token punctuation">`</span> <span class="token keyword">datetime</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span>
    <span class="token punctuation">)</span> <span class="token keyword">ENGINE</span><span class="token operator">=</span><span class="token keyword">InnoDB</span><span class="token punctuation">;</span></code></pre>
<p>La table "articles" existe : </p>
<pre class="language-text"><code class="language-text">table `articles` already exists, skip</code></pre>
<p>Remarque : si vous ajoutez un nouveau champ après avoir déjà généré la table, Beego se charge de mettre à jour la structure de votre table.</p>
<h2 id="sources"><a href="#sources" aria-hidden="true"><span class="icon icon-link"></span></a>Sources</h2>
<ul>
<li>Driver MySQL : <a href="https://github.com/go-sql-driver/mysql" target="_blank" rel="nofollow noopener noreferrer">https://github.com/go-sql-driver/mysql</a></li>
<li>Driver Postgres : <a href="https://github.com/lib/pq" target="_blank" rel="nofollow noopener noreferrer">https://github.com/lib/pq</a></li>
<li>Driver Sqlite3 : <a href="https://github.com/mattn/go-sqlite3" target="_blank" rel="nofollow noopener noreferrer">https://github.com/mattn/go-sqlite3</a></li>
<li>Liste des types de champs: <a href="http://beego.me/docs/mvc/model/models.md#model-fields-mapping-with-database-type" target="_blank" rel="nofollow noopener noreferrer">http://beego.me/docs/mvc/model/models.md#model-fields-mapping-with-database-type</a></li>
<li>Le site officiel de Beego : <a href="http://beego.me" target="_blank" rel="nofollow noopener noreferrer">http://beego.me</a></li>
</ul>
</article></div><footer class="text-white mt-4"><ul class="nav nav-pills justify-content-center"><li><a href="https://github.com/etienner" target="_blank" class="nav-link">Github</a></li><li><a href="https://medium.com/@etiennerouzeaud" target="_blank" class="nav-link">Medium</a></li><li><a href="https://twitter.com/etiennerouzeaud" target="_blank" class="nav-link">Twitter</a></li></ul></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"Connexion MySQL avec Beego (Partie 2)","date":"17 January 2015","content":"\u003Cp\u003ENous allons dans cet article, connecter le framework à une BDD (Base De Données) de type MySQL via l'ORM (Object-Relational Mapping) fournis par Beego. Il est tout à fait possible de se servir d'un autre type de BDD comme PostgreSQL et SQlite3 (officiellement supportées, mais vous pouvez tester avec d'autres drivers de BDD).\u003C\u002Fp\u003E\n\u003Ch2 id=\"création-du-premier-modèle\"\u003E\u003Ca href=\"#cr%C3%A9ation-du-premier-mod%C3%A8le\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ECréation du premier modèle\u003C\u002Fh2\u003E\n\u003Cp\u003EDans le répertoire \"models\", on crée un fichier que l'on nomme \"models.go\" :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Epackage\u003C\u002Fspan\u003E models\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EPuis, on importe la bibliothèque \"Time\" :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"time\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EEnsuite, on déclare la structure basique de notre future table \"articles\" :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Etype\u003C\u002Fspan\u003E Articles \u003Cspan class=\"token keyword\"\u003Estruct\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n\tId      \u003Cspan class=\"token builtin\"\u003Eint\u003C\u002Fspan\u003E       \u003Cspan class=\"token string\"\u003E`form:\"-\"`\u003C\u002Fspan\u003E\n\tTitle   \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E    \u003Cspan class=\"token string\"\u003E`form:\"title\" required`\u003C\u002Fspan\u003E\n\tContent \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E    \u003Cspan class=\"token string\"\u003E`orm:\";type(text)\" form:\"content,textarea\"`\u003C\u002Fspan\u003E\n\tCreated time\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ETime \u003Cspan class=\"token string\"\u003E`orm:\"auto_now_add;type(datetime)\"`\u003C\u002Fspan\u003E\n\tUpdated time\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003ETime \u003Cspan class=\"token string\"\u003E`orm:\"auto_now;type(datetime)\"`\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EOn précise à l'ORM que l'on veut un champ de type texte et non un champ de type \"varchar\" pour le champ \"content\".\u003Cbr\u003E\nAvec l'aide de la librairie \"Time\" native de Go, on implémente 2 champs de type \"datetime\". \u003C\u002Fp\u003E\n\u003Cp\u003EPuis on renvoie notre structure à travers une fonction :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ea \u003Cspan class=\"token operator\"\u003E*\u003C\u002Fspan\u003EArticles\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003ETableName\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin\"\u003Estring\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token keyword\"\u003Ereturn\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"articles\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EEt c'est tout pour notre unique modèle !\u003C\u002Fp\u003E\n\u003Ch2 id=\"connexion-à-la-base-de-données\"\u003E\u003Ca href=\"#connexion-%C3%A0-la-base-de-donn%C3%A9es\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EConnexion à la base de données\u003C\u002Fh2\u003E\n\u003Cp\u003EDans cette partie, on va utiliser le fichier de configuration de Beego. Pour cela, ouvrez le fichier \"app.conf\" présent dans le dossier \"conf\".\u003Cbr\u003E\nOn va ajouter 5 variables dont les valeurs seront :\u003C\u002Fp\u003E\n\u003Cul\u003E\n\u003Cli\u003ELe type de base de données (\"mysql\", \"sqlite3\", etc…).\u003C\u002Fli\u003E\n\u003Cli\u003ELe nom d'utilisateur de la BDD\u003C\u002Fli\u003E\n\u003Cli\u003ELe mot de passe de l'utilisateur\u003C\u002Fli\u003E\n\u003Cli\u003EL'URL du serveur de la BDD\u003C\u002Fli\u003E\n\u003Cli\u003ELe nom de la base utilisée pour ce projet\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Edata_type = &quot;mysql&quot;\ndata_user = &quot;root&quot;\ndata_pass = &quot;&quot;\ndata_urls = &quot;127.0.0.1&quot;\ndata_db   = &quot;beego_test&quot;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ESur votre BDD MySQL, créez une nouvelle base que vous nommez \"beego_test\".\u003C\u002Fp\u003E\n\u003Cp\u003ELes cinq variables ci-dessus vont être utilisées dans le fichier \"main.go\" (présent à la racine de votre projet). Ouvrez ce fichier.\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Eimport\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"github.com\u002Fastaxie\u002Fbeego\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token boolean\"\u003E_\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"myapp\u002Frouters\"\u003C\u002Fspan\u003E\n\tmodels \u003Cspan class=\"token string\"\u003E\"myapp\u002Fmodels\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token string\"\u003E\"github.com\u002Fastaxie\u002Fbeego\u002Form\"\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token boolean\"\u003E_\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"github.com\u002Fgo-sql-driver\u002Fmysql\"\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003EComme vous pouvez le constater, on importe le modèle, les bibliothèques pour l'ORM de Beego et le driver de MySQL.\u003C\u002Fp\u003E\n\u003Cp\u003EAttention : le driver de MySQL en Go doit être présent dans le dossier \"%gopath%\u002Fsrc\u002Fgithub.com\u002Fgo-sql-driver\u002Fmysql\".\u003Cbr\u003E\nSi ce n'est pas le cas (par défaut), lancez la commande pour l'installer :\u003Cbr\u003E\n\u003Ccode class=\"language-text\"\u003Ego get github.com\u002Fgo-sql-driver\u002Fmysql\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EPuis, on passe à la fonction \"init\" :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Einit\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n\torm\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ERegisterDriver\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ebeego\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EAppConfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"data_type\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E orm\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EDR_MySQL\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\torm\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ERegisterDataBase\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"default\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E beego\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EAppConfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"data_type\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E beego\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EAppConfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"mysqluser\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\":\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003Ebeego\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EAppConfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"password\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"@\u002F\"\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003Ebeego\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EAppConfig\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EString\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"mysqldb\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E+\u003C\u002Fspan\u003E\u003Cspan class=\"token string\"\u003E\"?charset=utf8&amp;loc=Europe%2FParis\"\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\torm\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ERegisterModel\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003Enew\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Emodels\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003EArticles\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ESur la première ligne, on précise l'utilisation du driver de MySQL à l'ORM puis sur la seconde, on lui indique le DSN (Data Source Name) pour pouvoir se connecter sur notre serveur de BDD et sur la troisième et dernière ligne, on charge notre modèle.\u003C\u002Fp\u003E\n\u003Cp\u003EA noter : il est notamment possible de créer plusieurs connexions sur différentes BDD avec Beego.\u003C\u002Fp\u003E\n\u003Ch2 id=\"gestion-des-erreurs-de-connexion\"\u003E\u003Ca href=\"#gestion-des-erreurs-de-connexion\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003EGestion des erreurs de connexion\u003C\u002Fh2\u003E\n\u003Cp\u003ELors du démarrage de votre serveur, on exécute une fonction qui permet d'afficher une erreur, si le serveur de BDD n'est pas lancé mais aussi de générer la table présente dans le modèle si cette dernière n'existe pas. Dans notre cas, la table \"articles\".\nPour ce faire, dans la fonction suivante (\"main\"), du fichier \"main.go\" ajoutez avant \"beego.Run()\" :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-go\"\u003E\u003Ccode class=\"language-go\"\u003E\u003Cspan class=\"token keyword\"\u003Efunc\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Emain\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n\tname    \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E\"default\"\u003C\u002Fspan\u003E\n\tforce   \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Efalse\u003C\u002Fspan\u003E\n\tverbose \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Etrue\u003C\u002Fspan\u003E\n\n\terr \u003Cspan class=\"token operator\"\u003E:=\u003C\u002Fspan\u003E orm\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ERunSyncdb\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ename\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E force\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E verbose\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\n\t\u003Cspan class=\"token keyword\"\u003Eif\u003C\u002Fspan\u003E err \u003Cspan class=\"token operator\"\u003E!=\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003Enil\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003E\n\t    beego\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003EDebug\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eerr\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\n\n\tbeego\u003Cspan class=\"token punctuation\"\u003E.\u003C\u002Fspan\u003E\u003Cspan class=\"token function\"\u003ERun\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cul\u003E\n\u003Cli\u003E\"name\" : on utilise la connexion \"default\" définit dans la fonction \"init\"\u003C\u002Fli\u003E\n\u003Cli\u003E\"force\" : si vaut \"true\", alors l'ORM écrase (sans sommation) la table.\u003C\u002Fli\u003E\n\u003Cli\u003E\"verbose\" : affiche la connexion dans la console du serveur.\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n\u003Cp\u003ECi-dessous, les 3 types de messages possibles renvoyés dans la console du serveur (si \"verbose\" vaut \"true\").\u003Cbr\u003E\nLe serveur de BDD n'est pas démarré \u002F non accessible : \u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003E[ORM]register db Ping `default`, dial tcp 127.0.0.1:3306: ConnectEx tcp: Aucune connexion n&#39;a pu être établie car l&#39;ordinateur cible l&#39;a expressément refusée.\nmust have one register DataBase alias named `default`\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ELa table \"articles\" n'existe pas :\u003C\u002Fp\u003E\n\u003Cpre class=\"language-sql\"\u003E\u003Ccode class=\"language-sql\"\u003E\u003Cspan class=\"token keyword\"\u003Ecreate\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Etable\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003Earticles\u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003E\n\t\u003Cspan class=\"token comment\"\u003E-- --------------------------------------------------\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E--  Table Structure for `myapp\u002Fmodels.Articles`\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token comment\"\u003E-- --------------------------------------------------\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token keyword\"\u003ECREATE\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003ETABLE\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003EIF\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003ENOT\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003EEXISTS\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003Earticles\u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003Eid\u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Einteger\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003EAUTO_INCREMENT\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003ENOT\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENULL\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003EPRIMARY\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003EKEY\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003Etitle\u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Evarchar\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E255\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003ENOT\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENULL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003Econtent\u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Elongtext\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003ENOT\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENULL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003Ecreated\u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edatetime\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003ENOT\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENULL\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E,\u003C\u002Fspan\u003E\n        \u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003Eupdated\u003Cspan class=\"token punctuation\"\u003E`\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Edatetime\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003ENOT\u003C\u002Fspan\u003E \u003Cspan class=\"token boolean\"\u003ENULL\u003C\u002Fspan\u003E\n    \u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003EENGINE\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token keyword\"\u003EInnoDB\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ELa table \"articles\" existe : \u003C\u002Fp\u003E\n\u003Cpre class=\"language-text\"\u003E\u003Ccode class=\"language-text\"\u003Etable `articles` already exists, skip\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\n\u003Cp\u003ERemarque : si vous ajoutez un nouveau champ après avoir déjà généré la table, Beego se charge de mettre à jour la structure de votre table.\u003C\u002Fp\u003E\n\u003Ch2 id=\"sources\"\u003E\u003Ca href=\"#sources\" aria-hidden=\"true\"\u003E\u003Cspan class=\"icon icon-link\"\u003E\u003C\u002Fspan\u003E\u003C\u002Fa\u003ESources\u003C\u002Fh2\u003E\n\u003Cul\u003E\n\u003Cli\u003EDriver MySQL : \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgo-sql-driver\u002Fmysql\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fgo-sql-driver\u002Fmysql\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EDriver Postgres : \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Flib\u002Fpq\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fgithub.com\u002Flib\u002Fpq\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EDriver Sqlite3 : \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fmattn\u002Fgo-sqlite3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fgithub.com\u002Fmattn\u002Fgo-sqlite3\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003EListe des types de champs: \u003Ca href=\"http:\u002F\u002Fbeego.me\u002Fdocs\u002Fmvc\u002Fmodel\u002Fmodels.md#model-fields-mapping-with-database-type\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002Fbeego.me\u002Fdocs\u002Fmvc\u002Fmodel\u002Fmodels.md#model-fields-mapping-with-database-type\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003Cli\u003ELe site officiel de Beego : \u003Ca href=\"http:\u002F\u002Fbeego.me\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002Fbeego.me\u003C\u002Fa\u003E\u003C\u002Fli\u003E\n\u003C\u002Ful\u003E\n"}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.b659722c.js" defer></script><script src="/assets/js/page--src--templates--post-vue.6a9fe53b.js" defer></script>
  </body>
</html>
