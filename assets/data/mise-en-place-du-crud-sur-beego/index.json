{"hash":"250f333e9ef0347f8247956a19dfdff7c411a751","data":{"post":{"title":"Mise en place du CRUD sur Beego","date":"20 January 2015","content":"<p>Maintenant que l'on sait se connecter à une BDD, on va pouvoir s'attaquer au CRUD (Create Read Update Delete). Concrètement, on va pouvoir lire, créer, éditer et supprimer des données à travers un mini blog très basique. Ce tutoriel va vous montrer comment mettre en place un système de contenus d'articles afin de vous servir de base pour vos futurs projets sur Beego.</p>\n<h2>Templating</h2>\n<p>Avant d'attaquer le côté purement Golang, on va se contenter de préparer le terrain coté front.<br>\nLe framework CSS utilisé est Materialize (<a href=\"http://materializecss.com\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://materializecss.com</a>).<br>\nDans le dossier \"views\", créez un dossier \"blog\".<br>\nCréez un nouveau fichier que vous nommez \"layout_blog.tpl\" :</p>\n<div class=\"gridsome-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token doctype\"><span class=\"token punctuation\">&lt;!</span><span class=\"token doctype-tag\">DOCTYPE</span> <span class=\"token name\">html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>html</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>title</span><span class=\"token punctuation\">></span></span>{{.title}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>title</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/static/css/materialize.min.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>body</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>nav</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>nav-wrapper light-blue darken-4<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/blog<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>brand-logo<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>My blog<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>ul</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>nav-mobile<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>right side-nav<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>li</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/blog/add<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Add an article<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>li</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>ul</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>button-collapse<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>#<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">data-activates</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>nav-mobile<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>i</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>mdi-navigation-menu<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>i</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>nav</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>br</span> <span class=\"token punctuation\">/></span></span><span class=\"token comment\">&lt;!-- Not pretty :( --></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>row<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            {{if .flash.notice}}\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toast-container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>toast<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{.flash.notice}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n            {{end}}\n            {{.LayoutContent}}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>valign-demo valign-wrapper<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            Powered by Beego (a Go framework)\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>http://code.jquery.com/jquery-2.1.3.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/static/js/materialize.min.js<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span><span class=\"token punctuation\">></span></span><span class=\"token script\"><span class=\"token language-javascript\">\n        <span class=\"token function\">$</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">ready</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"input[type='text']\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"validate\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">wrapAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"input-field\">&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"textarea\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">addClass</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"materialize-textarea validate\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">.</span><span class=\"token function\">wrapAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'&lt;div class=\"input-field\">&lt;/div>'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            <span class=\"token function\">$</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".button-collapse\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">sideNav</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>edge<span class=\"token operator\">:</span> <span class=\"token string\">\"left\"</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    </span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>body</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>html</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Mais à quoi sert <code class=\"language-text\">{{.LayoutContent}}</code> ?<br>\nÀ appeler le layout des pages concernées depuis le contrôleur. Dans notre cas, cela va correspondre aux futures pages ci-dessus.  </p>\n<p>Un second fichier template \"listing.tpl\" :</p>\n<div class=\"gridsome-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\">{{range $article := .articles}}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>article</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>row<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>col s12 m12<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card brown blue lighten-5<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card-content<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>Created {{date $article.Created \"Y-m-d H:i:s\"}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>span</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card-title black-text<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>{{$article.Title}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>span</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>{{substr $article.Content 0 400 | str2html}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>card-action<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue-text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/blog/article/{{$article.Id}}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Read the next<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue-text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/blog/edit/{{$article.Id}}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Edit<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n                <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>blue-text<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/blog/delete/{{$article.Id}}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Delete<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span>\n            <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>article</span><span class=\"token punctuation\">></span></span>\n{{end}}</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On utilise dans ce layout, 4 fonctions de templating :</p>\n<ul>\n<li><code class=\"language-text\">range</code> : boucle des données à partir d'un tableau (à l'image de <code class=\"language-text\">foreach</code> en PHP).</li>\n<li><code class=\"language-text\">date</code> : permet de modifier l'écriture de la date.</li>\n<li><code class=\"language-text\">substr 0 400</code> : limite le nombre de caractères à 400.</li>\n<li><code class=\"language-text\">str2html</code> : interpréte les balises HTML comme du HTML.</li>\n</ul>\n<p>Un troisième pour afficher le contenu d'un article \"content.tpl\" :</p>\n<div class=\"gridsome-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>{{.title}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>{{.content | str2html}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>/blog/<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>waves-effect waves-light btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Back to articles<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>Un quatrième pour afficher le formulaire \"form.tpl\" :</p>\n<div class=\"gridsome-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\">{{range $error := .errors}}\n    {{$error.Key}}\n    {{$error.Message}}\n{{end}}\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>row<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>articles<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">method</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>POST<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n        {{.Form | renderform}}\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">class</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>waves-effect waves-light btn<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Send<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Un cinquième et dernier pour afficher d'éventuelles erreurs \"error.tpl\" :</p>\n<div class=\"gridsome-highlight\" data-language=\"html\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-html line-numbers\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h1</span><span class=\"token punctuation\">></span></span>{{.error}}<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h1</span><span class=\"token punctuation\">></span></span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<h2>Préparation du nouveau contrôleur</h2>\n<p>Dans le dossier \"controllers\", créez un nouveau contrôleur que vous nommez \"blog.go\" ayant pour entête :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">package</span> controllers\n\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token string\">\"github.com/astaxie/beego\"</span>\n    <span class=\"token string\">\"github.com/astaxie/beego/orm\"</span>\n    models <span class=\"token string\">\"myapp/models\"</span>\n    <span class=\"token string\">\"github.com/astaxie/beego/validation\"</span>\n    <span class=\"token string\">\"strconv\"</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">type</span> BlogController <span class=\"token keyword\">struct</span> <span class=\"token punctuation\">{</span>\n    beego<span class=\"token punctuation\">.</span>Controller\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On appelle bien le modèle ainsi que l'ORM et la validation pour le formulaire d'ajout ou de modification d'article.</p>\n<h3>Afficher tous les articles</h3>\n<p>Dans un premier temps, on va se contenter de lister toutes les données présentent dans la table \"articles\" :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>this <span class=\"token operator\">*</span>MainController<span class=\"token punctuation\">)</span> <span class=\"token function\">Get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    flash <span class=\"token operator\">:=</span> beego<span class=\"token punctuation\">.</span><span class=\"token function\">ReadFromRequest</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>this<span class=\"token punctuation\">.</span>Controller<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span>ok<span class=\"token operator\">:=</span>flash<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"notice\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>ok<span class=\"token punctuation\">{</span>\n    <span class=\"token punctuation\">}</span>\n\n    o <span class=\"token operator\">:=</span> orm<span class=\"token punctuation\">.</span><span class=\"token function\">NewOrm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    o<span class=\"token punctuation\">.</span><span class=\"token function\">Using</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">var</span> articles <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span>models<span class=\"token punctuation\">.</span>Articles\n\n    num<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">QueryTable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Articles\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">OrderBy</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"-id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">All</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>articles<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> orm<span class=\"token punctuation\">.</span>ErrNoRows <span class=\"token operator\">&amp;&amp;</span> num <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token punctuation\">{</span>\n        this<span class=\"token punctuation\">.</span>TplNames         <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/listing.tpl\"</span>\n        this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"articles\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> articles\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// No result</span>\n        this<span class=\"token punctuation\">.</span>TplNames      <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/error.tpl\"</span>\n        this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"No article in the database\"</span>\n    <span class=\"token punctuation\">}</span>\n\n    this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"My blog\"</span>\n    this<span class=\"token punctuation\">.</span>Layout        <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/layout_blog.tpl\"</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Avant de charger l'ORM, on initialise la variable <code class=\"language-text\">flash</code> où seront stockés les messages de succès dans les futures fonctions concernées.<br>\nPuis, on charge la structure de la table \"articles\". On fait notre requête SQL via l'ORM en prenant soin d'afficher les articles par ordre décroissant.<br>\nEt pour finir, on charge le layout (rappelez-vous de <code class=\"language-text\">{{.LayoutContent}}</code> dans le fichier \"layout_blog.tpl\") et son template associé.  </p>\n<p>On appel cette fonction dans le fichier de routage (\"router/router.go\") :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\">beego<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>controllers<span class=\"token punctuation\">.</span>BlogController<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"get:Get\"</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"http://localhost:8080/blog\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:8080/blog</a><br>\nPar défaut, votre table est vide, ce qui affichera donc le message d'erreur.</p>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 960 731' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-8cbcb7ff6b73402ea9dfeb4889df08af'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-8cbcb7ff6b73402ea9dfeb4889df08af)' width='960' height='731' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAxAEADASIAAhEBAxEB/8QAGwAAAgIDAQAAAAAAAAAAAAAAAAUDBwECBAb/xAA5EAABAwMCAgYGCAcAAAAAAAABAAIDBAURBgcSIRQiMTJBdDZRgaGysxMXNWFkcZHBFSRCV3Jzlf/EABcBAQEBAQAAAAAAAAAAAAAAAAABAgT/xAAfEQACAgEEAwAAAAAAAAAAAAAAAQKhBBEUMVEhJEH/2gAMAwEAAhEDEQA/APZQ3XbSa00dPdZoZQ2JhdFK2YAO4eZGB%2ba8zqyx7RXq2Gnt9XBaKoyNd0qnZK94AHMYdyxk%2b5WFHtNo99mpK65y13CYIsyPrHcIyBgD1DJ96y7aPQLYRM6aoERzhxrcDkMld62iXlyo4W8tvXSNlGjbbbotAO4dY3H4DKz9WO3b88O4dccduLcT%2byvCPaTQMr2MjmqHOf3QK05Kkh2v0NSlhgrauLpGWAsryA/HaPetN4ncqMrd9Rsok7YbdDk7cWtB%2b%2b3Efsj6stuf7i1n/PKves2w0PK5vTK2rkLWB7TJXk9Vx5EH78KIbS6AJeBUT5YeF3892HGVFs/rlRfb6jZR7Ntdu2O4mbkVoI9VvKbS6e0ZSUD/AKHX9VWSsY7hY%2bjLc4acDs8SAFccOy2i52ccIrJGZIy2rJGR2rmvWzGkaSz11Qxla18UEkgc6qOAQ0nJUaw2uZUVPMT4jZYthgiqNLW2GoY2SN1JCHNcMg9RqlbZLY1sQFFBiJxdGOHukgDl7AP0WNM%2bjlr8rF8ATJcB2oXx2W3RyxyMo4Q%2bN3Ew8PNp8SFC63W8wtidbAYm5AZ9GMcwAeWfUB%2bibIQonfaba90Rfa2kxhrWdQdUAYHj4ArYactGAP4fT8iSOr2E9qbIQEFFSU9FAIaSFkMQJIYwYAJ7Uv1j6JXvyM/y3JulGsPRO9eSn%2bW5ATacJOn7YTjPRYs4/wAAmKW6aOdO2s%2buli%2bAJkgBCEIAQhCAEo1h6J3ryU/y3JulOreelrwPwU3y3ICmrN9l0f8Aoj%2bEJizvexCFhkOiHvexRTeCELJUbs7h/JQuQhCkP9a5L19kVvl5fgKEKg//2Q==' /%3e%3c/svg%3e\" width=\"960\" data-srcset=\"/assets/static/beego_no_article.82a2fbd.c88e8968fa412f37f169deac91c8a66f.jpg 480w, /assets/static/beego_no_article.6acf7b4.c88e8968fa412f37f169deac91c8a66f.jpg 960w\" data-sizes=\"(max-width: 960px) 100vw, 960px\" data-src=\"/assets/static/beego_no_article.6acf7b4.c88e8968fa412f37f169deac91c8a66f.jpg\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/beego_no_article.6acf7b4.c88e8968fa412f37f169deac91c8a66f.jpg\" width=\"960\"></noscript></p>\n<h3>Afficher un article en particulier</h3>\n<p>Dans notre contrôleur \"blog.go\", à la suite :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>this <span class=\"token operator\">*</span>MainController<span class=\"token punctuation\">)</span> <span class=\"token function\">GetOne</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    o <span class=\"token operator\">:=</span> orm<span class=\"token punctuation\">.</span><span class=\"token function\">NewOrm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    o<span class=\"token punctuation\">.</span><span class=\"token function\">Using</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token comment\">// Get the ID page</span>\n    articlesId <span class=\"token operator\">:=</span> this<span class=\"token punctuation\">.</span>Ctx<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">.</span><span class=\"token function\">Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\":id\"</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">var</span> articles <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token operator\">*</span>models<span class=\"token punctuation\">.</span>Articles\n\n    err <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">QueryTable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"articles\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Filter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> articlesId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">One</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>articles<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">==</span> orm<span class=\"token punctuation\">.</span>ErrNoRows <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// No result</span>\n        this<span class=\"token punctuation\">.</span>TplNames      <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/error.tpl\"</span>\n        this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Error :(\"</span>\n        this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"error\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"No available article\"</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        this<span class=\"token punctuation\">.</span>TplNames <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/content.tpl\"</span>\n        <span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> data <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> articles <span class=\"token punctuation\">{</span>\n            this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span>   <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>Title\n            this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"content\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> data<span class=\"token punctuation\">.</span>Content\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    this<span class=\"token punctuation\">.</span>Layout <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/layout_blog.tpl\"</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Même principe que pour lister tous les articles, excepté que l'on récupère l'ID de l'article pour l'insérer dans la requête SQL.</p>\n<p>Puis dans le fichier de routage (\"router/router.go\"), on ajoute la route suivante :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\">beego<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog/article/:id([0-9]+)\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>controllers<span class=\"token punctuation\">.</span>BlogController<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get:GetOne\"</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"http://localhost:8080/blog/article/1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:8080/blog/article/1</a></p>\n<p>A noter : dans la fonction, on a mis en place un message personnalisé dans le cas où un article n'existe pas ou n'a jamais existé. Si vous souhaitez afficher la page 404 par défaut, à la place du code existant dans la condition placez ceci : <code class=\"language-text\">this.Abort(&quot;404&quot;)</code>.</p>\n<h3>Insérer un article</h3>\n<p>On reste dans le même contrôleur :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\">    o <span class=\"token operator\">:=</span> orm<span class=\"token punctuation\">.</span><span class=\"token function\">NewOrm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    o<span class=\"token punctuation\">.</span><span class=\"token function\">Using</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span>\n\n    articles <span class=\"token operator\">:=</span> models<span class=\"token punctuation\">.</span>Articles<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"Form\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>articles\n\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">:=</span> this<span class=\"token punctuation\">.</span><span class=\"token function\">ParseForm</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>articles<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n        beego<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Couldn't parse the form. Reason: \"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        valid <span class=\"token operator\">:=</span> validation<span class=\"token punctuation\">.</span>Validation<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n        valid<span class=\"token punctuation\">.</span><span class=\"token function\">Required</span><span class=\"token punctuation\">(</span>articles<span class=\"token punctuation\">.</span>Title<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Title\"</span><span class=\"token punctuation\">)</span>\n        valid<span class=\"token punctuation\">.</span><span class=\"token function\">Required</span><span class=\"token punctuation\">(</span>articles<span class=\"token punctuation\">.</span>Content<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Content\"</span><span class=\"token punctuation\">)</span>\n        isValid<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> valid<span class=\"token punctuation\">.</span><span class=\"token function\">Valid</span><span class=\"token punctuation\">(</span>articles<span class=\"token punctuation\">)</span>\n\n        <span class=\"token keyword\">if</span> this<span class=\"token punctuation\">.</span>Ctx<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">.</span><span class=\"token function\">Method</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"POST\"</span> <span class=\"token punctuation\">{</span>\n\n            <span class=\"token keyword\">if</span> <span class=\"token operator\">!</span>isValid <span class=\"token punctuation\">{</span>\n                this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"errors\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> valid<span class=\"token punctuation\">.</span>ErrorsMap\n                <span class=\"token keyword\">for</span> <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> <span class=\"token keyword\">range</span> valid<span class=\"token punctuation\">.</span>Errors <span class=\"token punctuation\">{</span>\n                    beego<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">.</span>Key<span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">.</span>Message<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">Insert</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>articles<span class=\"token punctuation\">)</span>\n                flash <span class=\"token operator\">:=</span> beego<span class=\"token punctuation\">.</span><span class=\"token function\">NewFlash</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n                <span class=\"token keyword\">if</span> err <span class=\"token operator\">==</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n                    flash<span class=\"token punctuation\">.</span><span class=\"token function\">Notice</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Article \"</span><span class=\"token operator\">+</span> articles<span class=\"token punctuation\">.</span>Title <span class=\"token operator\">+</span><span class=\"token string\">\" added\"</span><span class=\"token punctuation\">)</span>\n                    flash<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>this<span class=\"token punctuation\">.</span>Controller<span class=\"token punctuation\">)</span>\n                    this<span class=\"token punctuation\">.</span><span class=\"token function\">Redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">302</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                    beego<span class=\"token punctuation\">.</span><span class=\"token function\">Debug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Couldn't insert new article. Reason: \"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span>\n\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span>\n\n    this<span class=\"token punctuation\">.</span>Layout        <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/layout_blog.tpl\"</span>\n    this<span class=\"token punctuation\">.</span>TplNames      <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/form.tpl\"</span>\n    this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Add an article\"</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On fait appel à la bibliothèque (\"validation\"), celle appelée dans les imports de notre contrôleur (\"blog.go\"). On met donc en place une validation sur nos 2 champs : \"Title\" et \"Content\".\nSi ces 2 derniers sont bien renseignés par l'utilisateur, on insère les données dans la BDD et on redirige l'utilisateur vers la page des articles sinon on affiche un message d'erreur.<br>\nOn n'oublie pas de stocker notre message de \"succès\" en mémoire (malgré la redirection 302) dans <code class=\"language-text\">Flash.Notice</code>, cela afin d'avertir l'utilisateur que l'insertion a bien été effectué.</p>\n<p>Info : les fonctions (facultatives) <code class=\"language-text\">beego.Error</code> et <code class=\"language-text\">beego.Debug</code> permettent d'afficher une erreur dans la console du serveur.</p>\n<p>Dans le fichier de routage (\"router/router.go\"), on ajoute la route suivante :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\">beego<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog/add\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>controllers<span class=\"token punctuation\">.</span>BlogController<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get,post:Add\"</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"http://localhost:8080/blog/add\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:8080/blog/add</a></p>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 960 731' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-714ad6aae8f83e72c03adadc82d3d2f9'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-714ad6aae8f83e72c03adadc82d3d2f9)' width='960' height='731' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAxAEADASIAAhEBAxEB/8QAHAAAAgMAAwEAAAAAAAAAAAAAAAMEBQcBAgYI/8QARRAAAQIDBAIJDw0BAAAAAAAAAQACAwQRBQYHEiHRExQXMUFRU3GSFSIyMzVCUmFjcnOBlLKzFiMkNkNXZHSRk5WhwbH/xAAYAQEBAQEBAAAAAAAAAAAAAAAAAQQCA//EACIRAAIBAwMFAQAAAAAAAAAAAAABAgQxoRMUUQMREiFBJP/aAAwDAQACEQMRAD8A9jDtTDWPZElL2pMQomWHDLoURsYAOy6SNHOvNXssPCO27MMvZ81L2RNGI122pdkV7wANIo7RSp/paJLYQ3Wm7LkJmY6oRnvgw%2buM28gAtB0UB0cQUiHgtc2JXLDtDRxzLh/0Letol7csGBurbtHJggw2w7IDTiFOAce0artuY4dvrlxDnjTfpZxP%2bLfNxG5/Jz/tR1JsDBq6suXGAbShZhR2SccKjiKrdJzLBFu%2bI5Pnw4YYdN0OxFnQfHZxH%2bLgYZYc/eNOfx5X0JMYN3WmS0zDrSilugF844kJW4jc/k5/2o6kW0%2buWC/s4jkwJmGmHjHZmYkTrT4rPKtot3rmSkg/Yb/zU5FYx2Vj5MtrRpoN7hIAWz7iNz%2bTn/ajqUO2cGboyljz0wxk610KBEiBzpo0BDSalRqjavLBU6xO0cmg2K4MuvZVSB9GgipZm7wcClialOtBALt7taqIVp9SbnWTMbWjzNYEBmSC3M4VYNPNoUm79rG2WR3NlJiV2Fwb8/CpmqK1Cx6UnHz7ejTqwUl0/pYiLANaS8TR5E6l2zweQf8AtHUnZYnhjooyxPDHRXmegjZINQNrxNPkTqTmMhPaHCEBXgLaFc5YnhjooyxOUHRQBsUPk2foFVXvaG3RtoNAA2lH0D0bla5YnKDoqqvcD8kbaDjU7Sj8FPs3Kgfdypu9ZlaV2rC3vMCsVW3aNbu2WeOVhe4FZIUEktmOCJC9bDrTkIBOWYr2yFTzDrTkIQAqi%2bH1Ttr8lH%2bG5W6qb26brWwPwUb4bkBjVjdy5P0EP3QrFnZepCFwCRB7P1JUbfCELlXCO7O1nmSXbx50IQCu/UO2e5E76CJ7hQhdFR//2Q==' /%3e%3c/svg%3e\" width=\"960\" data-srcset=\"/assets/static/beego_insert.82a2fbd.7199bbd70ba4bae046e92f0af78508ac.jpg 480w, /assets/static/beego_insert.6acf7b4.7199bbd70ba4bae046e92f0af78508ac.jpg 960w\" data-sizes=\"(max-width: 960px) 100vw, 960px\" data-src=\"/assets/static/beego_insert.6acf7b4.7199bbd70ba4bae046e92f0af78508ac.jpg\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/beego_insert.6acf7b4.7199bbd70ba4bae046e92f0af78508ac.jpg\" width=\"960\"></noscript></p>\n<p>Lorsque le formulaire est bien rempli, Beego nous redirige vers la page des articles :</p>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 960 731' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-4434b1eb26bf4f381273e9d143769515'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-4434b1eb26bf4f381273e9d143769515)' width='960' height='731' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAxAEADASIAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAAAAUDBAcGAgH/xABEEAABAgMGAQMNDwUAAAAAAAABAAIDBBEFBgcSFCExE6HRFhcyNVJTYXGRlLKzwSIlJzM2QVFUZHJzdIGCkkJEV4OV/8QAFwEBAQEBAAAAAAAAAAAAAAAAAQAEAv/EAB4RAAICAgIDAAAAAAAAAAAAAAABAhEEoRRRITFB/9oADAMBAAIRAxEAPwDsoNq4aRrJk5e1Y8GLlhMLoMVsYAOy7kUHjXM3ssPCO27MMvZ81L2RNGI12ql2RXvAA3FHbcTzLRIGEV1ZmyJObmhaMd5l4Zrq3HbKNh4N%2bChGEtzTwk7V84PQt64iXly0YXy27qOzEm4bYdloBxDnG0%2bwVXrrY4dvrlxDnjTjSzifYtuZhDc54rpbSb96aI9ingYT3Vly4wGWnCzCjsk64VH0HZLlidy0CWZ1HZhBwww6bs7EWdB8NnEexfBhlhz/AJGnP%2beVvMxhRdaZLTMNtSKW7AvnXEjmUPWfud9XtDzs9CE8P65aGszqOzDmYaYeMdmZiROtPgs8ptFu9cyUkH8jf%2banIrGOysfJltaNNBw%2bcgBa31n7nfV7Q87PQo7UwdujBsOdm4cOdY6FAiPBdNEgENJqdvAp8N/ZaJPMT9R2aFZja3Ps9ppvKQR7rh2A4qg2VacrTpco%2bho2HHbZN7usbEu1ZbXio0sKo/YFd0cDvY8pWA3J%2bBJDh5A1kOOGtps0NapOTid/d/AJvpIHcc5UBEEf20fyHpRQ2LuTi9/d/BqkYHCuZxd%2bgFFeywagaeN5D0qfSwe45yqhsWKK8nyKtn8lMeg5ONLB7jnKWXtYGXQtprBQaKP6tykgbssXcqbvWZWldLC4fcCYrMbxm/hsm7ZuKJTTGRbquWyVz5WZaZvmpmSD4bKntdT/AEJA21C4nDbq298errTUrD0nI5K03z1y/tXbKIEIQogSi%2bHyTtr8lH9W5N0pvbvda2B9ijercojGrG7Vyf4EP0QmDOyQhcMCxA7L9FHG4hCFyvYntnxZ8ShdwPjQhREX9ap2z2onfwInoFCF0KP/2Q==' /%3e%3c/svg%3e\" width=\"960\" data-srcset=\"/assets/static/beego_after_insert.82a2fbd.ab48629c3970e770220e94b25bf151bd.jpg 480w, /assets/static/beego_after_insert.6acf7b4.ab48629c3970e770220e94b25bf151bd.jpg 960w\" data-sizes=\"(max-width: 960px) 100vw, 960px\" data-src=\"/assets/static/beego_after_insert.6acf7b4.ab48629c3970e770220e94b25bf151bd.jpg\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/beego_after_insert.6acf7b4.ab48629c3970e770220e94b25bf151bd.jpg\" width=\"960\"></noscript></p>\n<h3>Editer un article</h3>\n<p>Comme pour l'insertion des données, on a besoin d'un formulaire mais avec les champs pré-remplis :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>this <span class=\"token operator\">*</span>MainController<span class=\"token punctuation\">)</span> <span class=\"token function\">Edit</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    o <span class=\"token operator\">:=</span> orm<span class=\"token punctuation\">.</span><span class=\"token function\">NewOrm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    o<span class=\"token punctuation\">.</span><span class=\"token function\">Using</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span>\n\n    articlesId<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> strconv<span class=\"token punctuation\">.</span><span class=\"token function\">Atoi</span><span class=\"token punctuation\">(</span>this<span class=\"token punctuation\">.</span>Ctx<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">.</span><span class=\"token function\">Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\":id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    articles <span class=\"token operator\">:=</span> models<span class=\"token punctuation\">.</span>Articles<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    flash <span class=\"token operator\">:=</span> beego<span class=\"token punctuation\">.</span><span class=\"token function\">NewFlash</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    err <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">QueryTable</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"articles\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Filter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"id\"</span><span class=\"token punctuation\">,</span> articlesId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">One</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>articles<span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> err <span class=\"token operator\">!=</span> orm<span class=\"token punctuation\">.</span>ErrNoRows <span class=\"token punctuation\">{</span>\n\n        this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"Form\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token operator\">&amp;</span>articles\n\n        <span class=\"token keyword\">if</span> err <span class=\"token operator\">:=</span> this<span class=\"token punctuation\">.</span><span class=\"token function\">ParseForm</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>articles<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> err <span class=\"token operator\">!=</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n            beego<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Couldn't parse the form. Reason: \"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            valid <span class=\"token operator\">:=</span> validation<span class=\"token punctuation\">.</span>Validation<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n            valid<span class=\"token punctuation\">.</span><span class=\"token function\">Required</span><span class=\"token punctuation\">(</span>articles<span class=\"token punctuation\">.</span>Title<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Title\"</span><span class=\"token punctuation\">)</span>\n            valid<span class=\"token punctuation\">.</span><span class=\"token function\">Required</span><span class=\"token punctuation\">(</span>articles<span class=\"token punctuation\">.</span>Content<span class=\"token punctuation\">,</span> <span class=\"token string\">\"Content\"</span><span class=\"token punctuation\">)</span>\n            isValid<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> valid<span class=\"token punctuation\">.</span><span class=\"token function\">Valid</span><span class=\"token punctuation\">(</span>articles<span class=\"token punctuation\">)</span>\n\n            <span class=\"token keyword\">if</span> this<span class=\"token punctuation\">.</span>Ctx<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">.</span><span class=\"token function\">Method</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token string\">\"POST\"</span> <span class=\"token punctuation\">{</span>\n\n                <span class=\"token keyword\">if</span> <span class=\"token operator\">!</span>isValid <span class=\"token punctuation\">{</span>\n                    this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"errors\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> valid<span class=\"token punctuation\">.</span>ErrorsMap\n                    beego<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Form didn't validate.\"</span><span class=\"token punctuation\">)</span>\n                <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                    <span class=\"token boolean\">_</span><span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">Update</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>articles<span class=\"token punctuation\">)</span>\n\n                    <span class=\"token keyword\">if</span> err <span class=\"token operator\">==</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n                        flash<span class=\"token punctuation\">.</span><span class=\"token function\">Notice</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Article \"</span><span class=\"token operator\">+</span> articles<span class=\"token punctuation\">.</span>Title <span class=\"token operator\">+</span><span class=\"token string\">\" updated\"</span><span class=\"token punctuation\">)</span>\n                            flash<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>this<span class=\"token punctuation\">.</span>Controller<span class=\"token punctuation\">)</span>\n\n                        this<span class=\"token punctuation\">.</span><span class=\"token function\">Redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">302</span><span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                        beego<span class=\"token punctuation\">.</span><span class=\"token function\">Debug</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Couldn't update new article. Reason: \"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n                    <span class=\"token punctuation\">}</span>\n                <span class=\"token punctuation\">}</span>\n\n            <span class=\"token punctuation\">}</span>\n\n        <span class=\"token punctuation\">}</span>\n\n        this<span class=\"token punctuation\">.</span>Data<span class=\"token punctuation\">[</span><span class=\"token string\">\"title\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"Edit this article\"</span>\n        this<span class=\"token punctuation\">.</span>Layout        <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/layout_blog.tpl\"</span>\n        this<span class=\"token punctuation\">.</span>TplNames      <span class=\"token operator\">=</span> <span class=\"token string\">\"blog/form.tpl\"</span>\n\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        flash<span class=\"token punctuation\">.</span><span class=\"token function\">Notice</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Article #%d doesn't exists\"</span><span class=\"token punctuation\">,</span> articlesId<span class=\"token punctuation\">)</span>\n        flash<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>this<span class=\"token punctuation\">.</span>Controller<span class=\"token punctuation\">)</span>\n        this<span class=\"token punctuation\">.</span><span class=\"token function\">Redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">302</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On récupère l'id de l'article que l'on convertit en string via <code class=\"language-text\">strconv.Atoi</code>. Ensuite, on éxécute avec la mème logique que dans l'insertion des données, excepté la requête SQL qui diffère.</p>\n<p>Dans le fichier de routage (\"router/router.go\"), on ajoute la route suivante :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\">beego<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog/edit/:id([0-9]+)\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>controllers<span class=\"token punctuation\">.</span>BlogController<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get,post:Edit\"</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"http://localhost:8080/blog/edit/1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:8080/blog/edit/1</a></p>\n<h3>Supprimer un article</h3>\n<p>Dernière fonction de notre contrôleur \"blog.go\" :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\"><span class=\"token keyword\">func</span> <span class=\"token punctuation\">(</span>this <span class=\"token operator\">*</span>MainController<span class=\"token punctuation\">)</span> <span class=\"token function\">Delete</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    o <span class=\"token operator\">:=</span> orm<span class=\"token punctuation\">.</span><span class=\"token function\">NewOrm</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    o<span class=\"token punctuation\">.</span><span class=\"token function\">Using</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"default\"</span><span class=\"token punctuation\">)</span>\n\n    articlesId<span class=\"token punctuation\">,</span> <span class=\"token boolean\">_</span> <span class=\"token operator\">:=</span> strconv<span class=\"token punctuation\">.</span><span class=\"token function\">Atoi</span><span class=\"token punctuation\">(</span>this<span class=\"token punctuation\">.</span>Ctx<span class=\"token punctuation\">.</span>Input<span class=\"token punctuation\">.</span><span class=\"token function\">Param</span><span class=\"token punctuation\">(</span><span class=\"token string\">\":id\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n\n    articles <span class=\"token operator\">:=</span> models<span class=\"token punctuation\">.</span>Articles<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n\n    flash <span class=\"token operator\">:=</span> beego<span class=\"token punctuation\">.</span><span class=\"token function\">NewFlash</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n    <span class=\"token keyword\">if</span> exist <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">QueryTable</span><span class=\"token punctuation\">(</span>articles<span class=\"token punctuation\">.</span><span class=\"token function\">TableName</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Filter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Id\"</span><span class=\"token punctuation\">,</span> articlesId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">Exist</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> exist <span class=\"token punctuation\">{</span>\n\n        <span class=\"token keyword\">if</span> num<span class=\"token punctuation\">,</span> err <span class=\"token operator\">:=</span> o<span class=\"token punctuation\">.</span><span class=\"token function\">Delete</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>models<span class=\"token punctuation\">.</span>Articles<span class=\"token punctuation\">{</span>Id<span class=\"token punctuation\">:</span> articlesId<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> err <span class=\"token operator\">==</span> <span class=\"token boolean\">nil</span> <span class=\"token punctuation\">{</span>\n            beego<span class=\"token punctuation\">.</span><span class=\"token function\">Info</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Record Deleted. \"</span><span class=\"token punctuation\">,</span> num<span class=\"token punctuation\">)</span>\n            flash<span class=\"token punctuation\">.</span><span class=\"token function\">Notice</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Article #%d deleted\"</span><span class=\"token punctuation\">,</span> articlesId<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n            beego<span class=\"token punctuation\">.</span><span class=\"token function\">Error</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Record couldn't be deleted. Reason: \"</span><span class=\"token punctuation\">,</span> err<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">}</span>\n\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n        flash<span class=\"token punctuation\">.</span><span class=\"token function\">Notice</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Article #%d doesn't exists\"</span><span class=\"token punctuation\">,</span> articlesId<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n\n    flash<span class=\"token punctuation\">.</span><span class=\"token function\">Store</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span>this<span class=\"token punctuation\">.</span>Controller<span class=\"token punctuation\">)</span>\n\n    this<span class=\"token punctuation\">.</span><span class=\"token function\">Redirect</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog\"</span><span class=\"token punctuation\">,</span> <span class=\"token number\">302</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On récupère l'id de l'article concerné. On vérifie que ce dernier existe bien dans la BDD. Si c'est le cas on le supprime et on redirige l'utilisateur sur la page des articles sinon on fait pareil mais avec un message d'avertissement différent.</p>\n<p>Et on n'oublie pas notre dernière route <del>pour la route</del> (\"router/router.go\") :</p>\n<div class=\"gridsome-highlight\" data-language=\"go\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-go line-numbers\"><code class=\"language-go\">beego<span class=\"token punctuation\">.</span><span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/blog/delete/:id([0-9]+)\"</span><span class=\"token punctuation\">,</span> <span class=\"token operator\">&amp;</span>controllers<span class=\"token punctuation\">.</span>MainController<span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"get:Delete\"</span><span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p><a href=\"http://localhost:8080/blog/delete/1\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://localhost:8080/blog/delete/1</a></p>\n<p><img class=\"g-image g-image--lazy g-image--loading\" src=\"data:image/svg+xml,%3csvg fill='none' viewBox='0 0 960 731' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cdefs%3e%3cfilter id='__svg-blur-0d8c43fec33db4413b5a1a00628cf269'%3e%3cfeGaussianBlur in='SourceGraphic' stdDeviation='40'/%3e%3c/filter%3e%3c/defs%3e%3cimage x='0' y='0' filter='url(%23__svg-blur-0d8c43fec33db4413b5a1a00628cf269)' width='960' height='731' xlink:href='data:image/jpeg%3bbase64%2c/9j/2wBDAAYEBQYFBAYGBQYHBwYIChAKCgkJChQODwwQFxQYGBcUFhYaHSUfGhsjHBYWICwgIyYnKSopGR8tMC0oMCUoKSj/2wBDAQcHBwoIChMKChMoGhYaKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCj/wAARCAAxAEADASIAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAAAAUDBAcCAQb/xABEEAABAgQDAwUJDQkAAAAAAAABAAIDBAURBgcSFCExExUXQaEiMlFScXSUstEjJCY1NlRhcnOBs8HwM0JEV2R1gpGV/8QAGAEBAQEBAQAAAAAAAAAAAAAAAAECBAX/xAAfEQACAgEFAQEAAAAAAAAAAAAAAQKhEQQUIUFRJDH/2gAMAwEAAhEDEQA/APsoNVy0jUmTl6rHgxdMJhdBitjAB2kXIsPKvmcW0PKKt0wy9PmpekTRiNdtUuyK94AG8Wdutc9i0SBlFhWZpEnNzQqMd5l4Zvtbju0jcPo38FAMpcGn%2bDqvpB9i71s0uXKjhe7bziNmJty2y7LQDmHONt/QXXvRjl2%2b5bmHPG3G1OJt2LbmZQYOeL7LUh9aaI/JWJfKbCsuXGXZU4WoaXaJ1wuPAdyrlo/ZURLV%2bRswc5YZdA2OYs6D9NOI/JHRllz/ADGnP%2beVvExlPhaZLTMtqcUtFgXzriR2KHoewd83qHpZ9iiej7cqL9nkbMOZlpl2x12ZjzoP9vKbxcPYMlJB/I4/mpyKxjtLHyZbchpsOHWQAta6HsHfN6h6WfYuKnk5hGDQ52bhw51joUCI8F00SAQ0m53cNyPZvuVBPWJ/kbNBpo%2bBsgCAfecLiL37gJQALD3GEAOHuY9ie0OE6LhamMabOMrB3/4BSiQjA7419366l57R3J8CGFHiw2hkMta0dQYAB2LtszMvIDXXJ4DSE8EjGBB5UEeD9Be7FF8Zn%2bymC5E%2bqdv3ptbwBGqd3dz5dwTjYonjM7UbFE8Znapgophmc1t1Dub77gcFYxJ8iqz5lMeo5XtiieMztVTFEMw8G1lhsTsUfh9m5VEZaw5c4ephNr7LC4fUCYrMcRnHhpOGzgUSmzGRbtXLaNWvSzTbV1W1JdQ%2bl/nunc7c383bQzarcjfkdXdWtvvZUhr6gMpAPGE1ToQEOywLg8m26mQhACUYw%2bSda8yj/huTdKcW78K1kWv7yjfhuQGM0X4qk/sIfqhMWd99yELDBZg9/wDcoo3EIQs9kR2z9mfIoXdaEIaIv31TrPxRO%2bbxfUKELYP/2Q==' /%3e%3c/svg%3e\" width=\"960\" data-srcset=\"/assets/static/beego_delete.82a2fbd.3909e25e7beeb663100551f8b6360067.jpg 480w, /assets/static/beego_delete.6acf7b4.3909e25e7beeb663100551f8b6360067.jpg 960w\" data-sizes=\"(max-width: 960px) 100vw, 960px\" data-src=\"/assets/static/beego_delete.6acf7b4.3909e25e7beeb663100551f8b6360067.jpg\"><noscript><img class=\"g-image g-image--lazy g-image--loaded\" src=\"/assets/static/beego_delete.6acf7b4.3909e25e7beeb663100551f8b6360067.jpg\" width=\"960\"></noscript></p>\n<h2>Conclusion</h2>\n<p>Désormais, vous avez dès à présent, un système de CRUD et de templating opérationnel. Il ne manque plus qu'un espace d'authentification pour effectuer les opérations d'ajout, de modification et de suppression d'articles.</p>\n<h2>Sources</h2>\n<ul>\n<li>Documentation officiel de Beego : <a href=\"http://beego.me/docs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">http://beego.me/docs</a> ;</li>\n<li>Documentation complète de la bibliothèque \"validation\" : [https://gowalker.org/github.com/astaxie/beego/validation].</li>\n</ul>\n","download":"","tags":[{"title":"Golang","path":"/tag/Golang/"},{"title":"Beego","path":"/tag/Beego/"}],"timeToRead":9,"parts":[{"title":"Installation et premiers pas sur Beego","href":"installation-et-premiers-pas-sur-beego"},{"title":"Connexion MySQL avec Beego","href":"connexion-my-sql-avec-beego"},{"title":"Mise en place du CRUD sur Beego","href":""}]}},"context":{}}